LARAVEL VIEWS CONVERSION
Generated: 2026-01-09 10:26:11
Project: C:\material-connect
================================================================================


------------------------------------------------------------
FILE: app/Http/Controllers/Admin/DashboardController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use Illuminate\Support\Str;
use App\Models\Orders;
use App\Models\OrderItem;
use App\Models\User;
use App\Models\MasterProducts;
use DateTimeZone;
use DateTime;
use Carbon\Carbon;

class DashboardController extends Controller
{
    public function summary(Request $r)
    {
        $from = $r->date('from') ?? now()->startOfMonth();
        $to   = $r->date('to')   ?? now();
        $gran = $r->get('granularity', 'day');
        $tz   = $r->get('tz', 'Australia/Sydney');

        // Calculate previous period for comparison
        $periodDays = $from->diffInDays($to);
        $prevFrom = (clone $from)->subDays($periodDays + 1);
        $prevTo = (clone $from)->subDay();

        // Base scope for current period - FIXED: Use created_at
        $orders = Orders::query()
            ->when($r->client_id, fn($q, $v) => $q->where('client_id', $v))
            ->when($r->project_id, fn($q, $v) => $q->where('project_id', $v))
            ->when($r->workflow, fn($q, $v) => $q->where('workflow', $v))
            ->when($r->payment_status, fn($q, $v) => $q->where('payment_status', $v))
            ->when($r->delivery_method, fn($q, $v) => $q->where('delivery_method', $v));
            // ->whereBetween('created_at', [$from, $to]); // FIXED

        // Base scope for previous period (for comparison) - FIXED: Use created_at
        $prevOrders = Orders::query()
            ->when($r->client_id, fn($q, $v) => $q->where('client_id', $v))
            ->when($r->project_id, fn($q, $v) => $q->where('project_id', $v))
            ->when($r->workflow, fn($q, $v) => $q->where('workflow', $v))
            ->when($r->payment_status, fn($q, $v) => $q->where('payment_status', $v))
            ->when($r->delivery_method, fn($q, $v) => $q->where('delivery_method', $v))
            ->whereBetween('created_at', [$prevFrom, $prevTo]); // FIXED

        // KPIs - Current Period
        $ordersTotal = (int) (clone $orders)->count();
        $revenue = (float) (clone $orders)->whereIn('workflow',['Payment Requested','Delivered'])->sum('total_price');
        $awaitingPayment = (int) (clone $orders)->whereIn('payment_status', ['Pending', 'Requested'])->count();
        $supplierMissing = (int) (clone $orders)->where('workflow', 'Supplier Missing')->count();
        $completedOrders = (int) (clone $orders)->where('workflow', 'Delivered')->count();
        $avgOrderValue = $ordersTotal > 0 ? round($revenue / $ordersTotal, 2) : 0;
        $activeClients = (int) (clone $orders)->distinct('client_id')->count('client_id');
        
        // Get active suppliers from order items
        $orderIds = (clone $orders)->pluck('id');
        $activeSuppliers = OrderItem::whereIn('order_id', $orderIds)
            ->whereNotNull('supplier_id')
            ->distinct('supplier_id')
            ->count('supplier_id');

        // KPIs - Previous Period
        $ordersTotalPrev = (int) (clone $prevOrders)->count();
        $revenuePrev = (float) (clone $prevOrders)->sum('total_price');
        $completedOrdersPrev = (int) (clone $prevOrders)->where('workflow', 'Delivered')->count();
        $activeClientsPrev = (int) (clone $prevOrders)->distinct('client_id')->count('client_id');

        // Calculate percentage changes
        $ordersChange = $this->calculatePercentageChange($ordersTotal, $ordersTotalPrev);
        $revenueChange = $this->calculatePercentageChange($revenue, $revenuePrev);
        $completedChange = $this->calculatePercentageChange($completedOrders, $completedOrdersPrev);
        $clientsChange = $this->calculatePercentageChange($activeClients, $activeClientsPrev);

        // Total counts (not period-specific)
        $totalClients = User::where('role', 'client')->count();
        $totalSuppliers = User::where('role', 'supplier')->whereIn('status', ['approved', 'active'])->count();
        $pendingSuppliers = User::where('role', 'supplier')->where('status', 'pending')->count();

        // Performance metrics
        $cancelledOrders = (int) (clone $orders)->where('order_status', 'Cancelled')->count();
        $cancellationRate = $ordersTotal > 0 ? round(($cancelledOrders / $ordersTotal) * 100, 2) : 0;

        // Repeat client rate - FIXED: Use created_at
        $clientsWithMultipleOrders = Orders::query()
            ->whereBetween('created_at', [$from, $to]) // FIXED
            ->selectRaw('client_id, COUNT(*) as order_count')
            ->groupBy('client_id')
            ->having('order_count', '>', 1)
            ->count();
        $repeatClientRate = $activeClients > 0 ? round(($clientsWithMultipleOrders / $activeClients) * 100, 2) : 0;

        $kpis = [
            // Primary metrics
            'orders_total' => $ordersTotal,
            'orders_total_prev' => $ordersTotalPrev,
            'orders_change' => $ordersChange,
            
            'revenue' => $revenue,
            'revenue_prev' => $revenuePrev,
            'revenue_change' => $revenueChange,
            
            'avg_order_value' => $avgOrderValue,
            
            'completed_orders' => $completedOrders,
            'completed_orders_prev' => $completedOrdersPrev,
            'completed_change' => $completedChange,
            
            // Activity metrics
            'active_clients' => $activeClients,
            'active_clients_prev' => $activeClientsPrev,
            'active_clients_change' => $clientsChange,
            
            'active_suppliers' => $activeSuppliers,
            
            // Alerts & Actions
            'awaiting_payment' => $awaitingPayment,
            'supplier_missing' => $supplierMissing,
            'pending_supplier_approvals' => $pendingSuppliers,
            
            // Performance
            'cancellation_rate' => $cancellationRate,
            'repeat_client_rate' => $repeatClientRate,
            
            // System totals
            'total_clients' => $totalClients,
            'total_suppliers' => $totalSuppliers,
        ];

        // Which charts to build
        $want = collect(explode(',', $r->get('charts', 'date,supplier,product,price_bucket,status')))
            ->map(fn($x) => trim($x))->filter()->values();

        $charts = [];

        // 1) Date revenue & order count - FIXED: Use created_at in date formatting
        if ($want->contains('date')) {
            $bucket = match ($gran) {
                'week'  => "DATE_FORMAT(CONVERT_TZ(created_at, '+00:00', '{$this->offset($tz)}'), '%x-%v')", // FIXED
                'month' => "DATE_FORMAT(CONVERT_TZ(created_at, '+00:00', '{$this->offset($tz)}'), '%Y-%m')", // FIXED
                default => "DATE(CONVERT_TZ(created_at, '+00:00', '{$this->offset($tz)}'))", // FIXED
            };

            $rows = (clone $orders)
                ->selectRaw("$bucket AS bucket, COUNT(*) AS orders, SUM(total_price) AS revenue")
                ->groupBy('bucket')->orderBy('bucket')->get();

            $charts[] = [
                'id'       => 'time_revenue',
                'title'    => 'Revenue & Orders Over Time',
                'group_by' => 'date',
                'labels'   => $rows->pluck('bucket')->values(),
                'series'   => [
                    ['name' => 'Revenue', 'data' => $rows->pluck('revenue')->map(fn($v) => (float)$v)->values()],
                    ['name' => 'Orders', 'data' => $rows->pluck('orders')->map(fn($v) => (int)$v)->values()],
                ],
            ];
        }

        // 2) Order status distribution
        if ($want->contains('status')) {
            $statusDist = (clone $orders)
                ->selectRaw('workflow, COUNT(*) AS count')
                ->groupBy('workflow')
                ->orderByDesc('count')
                ->get();

            $charts[] = [
                'id'       => 'order_status',
                'title'    => 'Order Status Distribution',
                'group_by' => 'status',
                'type'     => 'donut',
                'labels'   => $statusDist->pluck('workflow')->values(),
                'series'   => $statusDist->pluck('count')->map(fn($v) => (int)$v)->values(),
            ];
        }

        // 3) Supplier revenue - FIXED: Use created_at
        if ($want->contains('supplier')) {
            // Get orders that have at least one supplier assigned
            $supplierRevenue = OrderItem::query()
            ->join('orders', 'orders.id', '=', 'order_items.order_id')
            ->whereBetween('orders.created_at', [$from, $to])
            ->whereIn('orders.workflow', ['Payment Requested', 'Delivered'])
            ->whereNotNull('order_items.supplier_id')
            ->when($r->supplier_id, fn($q, $v) => $q->where('order_items.supplier_id', $v))
            ->selectRaw('
                order_items.supplier_id AS supplier_id,
                SUM(
                    (COALESCE(order_items.supplier_unit_cost,0) * COALESCE(order_items.quantity,0))
                    + COALESCE(order_items.supplier_delivery_cost,0)
                    - COALESCE(order_items.supplier_discount,0)
                ) AS revenue
            ')
            ->groupBy('order_items.supplier_id')
            ->orderByDesc('revenue')
            ->limit(10)
            ->get()
            ->map(fn($r) => [
                'supplier_id' => (int) $r->supplier_id,
                'revenue'     => (float) $r->revenue,
            ])
            ->values();

            $supplierIds = $supplierRevenue->pluck('supplier_id');
            $supplierNames = User::whereIn('id', $supplierIds)->pluck('name', 'id');

            $charts[] = [
                'id'       => 'supplier_revenue',
                'title'    => 'Top Suppliers by Revenue',
                'group_by' => 'supplier',
                'labels'   => $supplierRevenue->map(fn($r) => $supplierNames[$r['supplier_id']] ?? '#'.$r['supplier_id'])->values(),
                'series'   => [[
                    'name' => 'Revenue',
                    'data' => $supplierRevenue->pluck('revenue')->map(fn($v) => round((float)$v, 2))->values(),
                ]],
            ];
        }

        // 4) Product mix - FIXED: Use created_at
        if ($want->contains('product')) {
            $productRevenue = OrderItem::query()
                ->join('orders', 'orders.id', '=', 'order_items.order_id')
                ->join('master_products', 'master_products.id', '=', 'order_items.product_id')
                ->whereBetween('orders.created_at', [$from, $to]) // FIXED
                ->when($r->product_id, fn($q, $v) => $q->where('order_items.product_id', $v))
                ->selectRaw('
                    order_items.product_id,
                    master_products.product_name,
                    COUNT(DISTINCT orders.id) AS order_count,
                    SUM(orders.total_price) / COUNT(DISTINCT orders.id) AS avg_revenue
                ')
                ->groupBy('order_items.product_id', 'master_products.product_name')
                ->orderByDesc('order_count')
                ->limit(10)
                ->get();

            $charts[] = [
                'id'       => 'product_revenue',
                'title'    => 'Top Products by Order Count',
                'group_by' => 'product',
                'labels'   => $productRevenue->pluck('product_name')->values(),
                'series'   => [[
                    'name' => 'Orders',
                    'data' => $productRevenue->pluck('order_count')->map(fn($v) => (int)$v)->values(),
                ]],
            ];
        }

        // 5) Price buckets
        if ($want->contains('price_bucket')) {
            $b = $this->parseBuckets($r->get('buckets', '0-500,500-1000,1000-2000,2000-5000,5000+'));
            $dist = $this->bucketizePrices($orders, $b);
            $charts[] = [
                'id'       => 'price_dist',
                'title'    => 'Order Value Distribution',
                'group_by' => 'price_bucket',
                'type'     => 'bar',
                'labels'   => array_keys($dist),
                'series'   => [['name' => 'Orders', 'data' => array_values($dist)]],
            ];
        }

        // TABLES

        // Top clients by spend
        $topClients = Orders::query()
            ->join('users as u', 'orders.client_id', '=', 'u.id')
            ->whereBetween('orders.created_at', [$from, $to]) // FIX: Specify orders.created_at
            ->selectRaw('
                orders.client_id,
                u.name AS client_name,
                u.email AS client_email,
                COUNT(orders.id) AS order_count,
                SUM(orders.total_price) AS total_spend
            ')
            ->groupBy('orders.client_id', 'u.name', 'u.email')
            ->orderByDesc('total_spend')
            ->limit(10)
            ->get()
            ->map(fn($r) => [
                'client_id' => $r->client_id,
                'client_name' => $r->client_name,
                'client_email' => $r->client_email,
                'order_count' => (int) $r->order_count,
                'total_spend' => (float) $r->total_spend,
            ])
            ->values();

        // Top suppliers by order count and revenue share - FIXED: Use created_at
        $topSuppliers = OrderItem::query()
        ->join('orders', 'orders.id', '=', 'order_items.order_id')
        ->join('users', 'users.id', '=', 'order_items.supplier_id')
        ->whereBetween('orders.created_at', [$from, $to])
        ->whereIn('orders.workflow', ['Payment Requested', 'Delivered']) // confirm exact values
        ->whereNotNull('order_items.supplier_id')
        ->selectRaw('
            order_items.supplier_id,
            users.name AS supplier_name,
            users.email AS supplier_email,
            COUNT(DISTINCT orders.id) AS order_count,
            SUM(
                (COALESCE(order_items.supplier_unit_cost,0) * COALESCE(order_items.quantity,0))
                + COALESCE(order_items.supplier_delivery_cost,0)
                - COALESCE(order_items.supplier_discount,0)
            ) AS total_revenue
        ')
        ->groupBy('order_items.supplier_id', 'users.name', 'users.email')
        ->orderByDesc('order_count')
        ->limit(10)
        ->get()
        ->map(fn($r) => [
            'supplier_id'    => $r->supplier_id,
            'supplier_name'  => $r->supplier_name,
            'supplier_email' => $r->supplier_email,
            'order_count'    => (int) $r->order_count,
            'revenue'        => (float) $r->total_revenue,
        ])
        ->values();

        // Recent activity feed (last 7 days, up to 15 items)
        $recentActivity = Orders::query()
            ->with(['client:id,name', 'project:id,name'])
            ->whereBetween('created_at', [now()->subDays(7), now()])
            ->orderBy('created_at', 'desc')
            ->limit(15)
            ->get()
            ->map(fn($order) => [
                'id' => $order->id,
                'type' => 'order_created',
                'order_id' => $order->id,
                'po_number' => $order->po_number,
                'client_name' => $order->client->name ?? 'Unknown Client',
                'project_name' => $order->project->name ?? 'N/A',
                'amount' => (float) $order->total_price,
                'workflow' => $order->workflow,
                'timestamp' => $order->created_at->toIso8601String(),
                'time_ago' => $order->created_at->diffForHumans(),
            ])
            ->values();

        // Prepare response filters
        $respFilters = [
            'from'            => $from instanceof Carbon ? $from->toDateString() : (string) $from,
            'to'              => $to instanceof Carbon ? $to->toDateString() : (string) $to,
            'granularity'     => $gran,
            'group_by'        => null,
            'metric'          => 'revenue',
            'client_id'       => $r->client_id,
            'project_id'      => $r->project_id,
            'supplier_id'     => $r->supplier_id,
            'product_id'      => $r->product_id,
            'workflow'        => $r->workflow,
            'payment_status'  => $r->payment_status,
            'delivery_method' => $r->delivery_method,
            'tz'              => $tz,
            'currency'        => 'AUD',
            'charts'          => $want->all(),
        ];

        // System alerts
        $alerts = [];
        if ($awaitingPayment > 0) {
            $alerts[] = [
                'type' => 'warning',
                'priority' => 'high',
                'message' => "{$awaitingPayment} order(s) awaiting payment",
                'action_url' => '/admin/orders?payment_status=Pending',
            ];
        }
        if ($supplierMissing > 0) {
            $alerts[] = [
                'type' => 'error',
                'priority' => 'high',
                'message' => "{$supplierMissing} order(s) missing supplier assignment",
                'action_url' => '/admin/orders?workflow=Supplier+Missing',
            ];
        }
        if ($pendingSuppliers > 0) {
            $alerts[] = [
                'type' => 'info',
                'priority' => 'medium',
                'message' => "{$pendingSuppliers} supplier(s) pending approval",
                'action_url' => '/admin/suppliers?status=pending',
            ];
        }

        return response()->json([
            'filters' => $respFilters,
            'kpis'    => $kpis,
            'charts'  => $charts,
            'tables'  => [
                'top_clients_by_spend' => $topClients,
                'top_suppliers_by_revenue' => $topSuppliers,
                'recent_activity' => $recentActivity,
            ],
            'alerts' => $alerts,
            'metadata' => [
                'generated_at' => now()->toIso8601String(),
                'data_freshness' => 'real-time',
                'total_records_analyzed' => $ordersTotal,
                'period_days' => $periodDays,
            ],
        ]);
    }

    /**
     * Calculate percentage change between current and previous values
     */
    protected function calculatePercentageChange($current, $previous): float
    {
        if ($previous == 0) {
            return $current > 0 ? 100.0 : 0.0;
        }
        return round((($current - $previous) / $previous) * 100, 2);
    }

    protected function parseBuckets(string $spec): array
    {
        $out = [];
        foreach (explode(',', $spec) as $raw) {
            $t = trim($raw);
            if ($t === '') continue;

            if (Str::endsWith($t, '+')) {
                $min = (float) rtrim($t, '+');
                $out[] = ['label' => "{$min}+", 'min' => $min, 'max' => null];
                continue;
            }

            if (preg_match('/^\s*([0-9]*\.?[0-9]+)\s*-\s*([0-9]*\.?[0-9]+)\s*$/', $t, $m)) {
                $min = (float) $m[1];
                $max = (float) $m[2];
                if ($max < $min) [$min, $max] = [$max, $min];
                $label = $min == (int)$min && $max == (int)$max ? "{$min}-{$max}" : "{$min}-{$max}";
                $out[] = ['label' => $label, 'min' => $min, 'max' => $max];
            }
        }
        usort($out, fn($a, $b) => ($a['min'] <=> $b['min']) ?: (($a['max'] ?? INF) <=> ($b['max'] ?? INF)));
        return $out;
    }

    protected function buildPriceBucketCase(array $buckets, string $column = 'total_price'): string
    {
        $cases = [];
        foreach ($buckets as $b) {
            $min = $b['min'];
            $max = $b['max'];
            $label = addslashes($b['label']);
            if (is_null($max)) {
                $cases[] = "WHEN {$column} >= {$min} THEN '{$label}'";
            } else {
                $cases[] = "WHEN {$column} >= {$min} AND {$column} < {$max} THEN '{$label}'";
            }
        }
        $cases[] = "ELSE 'Other'";
        return 'CASE ' . implode(' ', $cases) . ' END';
    }

    protected function bucketizePrices(\Illuminate\Database\Eloquent\Builder $orders, array $buckets): array
    {
        if (empty($buckets)) return [];

        $caseSql = $this->buildPriceBucketCase($buckets, 'total_price');

        $rows = (clone $orders)
            ->selectRaw("{$caseSql} AS bucket, COUNT(*) AS cnt")
            ->groupBy('bucket')
            ->pluck('cnt', 'bucket');

        $ordered = [];
        foreach ($buckets as $b) {
            $label = $b['label'];
            $ordered[$label] = (int) ($rows[$label] ?? 0);
        }
        if (isset($rows['Other'])) $ordered['Other'] = (int)$rows['Other'];

        return $ordered;
    }

    protected function offset(string $tz): string
    {
        try {
            $zone = new DateTimeZone($tz);
        } catch (\Exception $e) {
            $zone = new DateTimeZone('UTC');
        }
        $now = new DateTime('now', $zone);
        $offset = $zone->getOffset($now) / 3600;
        $sign = $offset >= 0 ? '+' : '-';
        $hours = str_pad(abs((int)$offset), 2, '0', STR_PAD_LEFT);
        $minutes = str_pad(abs(($offset * 60) % 60), 2, '0', STR_PAD_LEFT);
        return "{$sign}{$hours}:{$minutes}";
    }
}


------------------------------------------------------------
FILE: app/Http/Controllers/Admin/MasterProductsController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Validator;
use Illuminate\Support\Facades\Storage;
use App\Models\MasterProducts;
use App\Models\SupplierOffers;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Str;
use App\Models\User;
use App\Models\Company;
use Illuminate\Support\Facades\Http;

class MasterProductsController extends Controller
{
    /**
     * List all master products.
     */
    public function index(Request $request)
    {
        $perPage = (int) $request->get('per_page', 10);
        $page = (int) $request->get('page', 1);

        $query = MasterProducts::with(['added_by', 'approved_by', 'category']);

        // Apply filters
        if ($request->filled('search')) {
            $search = $request->get('search');
            $query->where('product_name', 'like', "%{$search}%");
        }

        if ($request->filled('category')) {
            $query->where('category', $request->get('category'));
        }

        if ($request->filled('is_approved')) {
            $query->where('is_approved', $request->get('is_approved'));
        }

        // Paginate after filters
        $products = $query->paginate($perPage, ['*'], 'page', $page);

        // Append supplier offers count
        $products->getCollection()->transform(function ($product) {
            $product->supplierOffersCount = SupplierOffers::where('master_product_id', $product->id)->count();
            return $product;
        });

        return response()->json($products, 200);
    }


    /**
     * Show a specific master product.
     */
    public function show($id)
    {
        // Find the product with eager-loaded relationships
        $product = MasterProducts::with(['added_by', 'approved_by', 'category'])->find($id);

        // Check if the product exists
        if (!$product) {
            return response()->json(['error' => 'Product not found'], 404);
        }

        // Load supplier offers and eager load the supplier relationship
        $product->supplierOffers = SupplierOffers::with('supplier')->where('master_product_id', $product->id)->get();

        // Decode delivery_zones manually in case the accessor isn't being triggered
        $product->supplierOffers->each(function ($offer) {
            if ($offer->supplier && isset($offer->supplier->delivery_zones)) {
                // Manually decode the delivery_zones if it's still a string
                $offer->supplier->delivery_zones = json_decode($offer->supplier->delivery_zones, true);
            }
        });

        // Return the response with the product and decoded supplier offer details
        return response()->json($product, 200);
    }


    /**
     * Create a new master product.
     */
    public function store(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'product_name' => 'required|string|max:255|unique:master_products,product_name',
            'product_type' => 'required|string|max:255',
            'specifications' => 'nullable|string',
            'unit_of_measure' => 'nullable|string|max:100',
            'tech_doc' => 'nullable|file|mimes:pdf,docx,xlsx',
            'photo' => 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
            'is_approved' => 'boolean',
            'category' => 'nullable|string|max:255|exists:category,id'
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $techDocPath = null;
        if ($request->hasFile('tech_doc') && $request->file('tech_doc')->isValid()) {
            $techDocPath = $request->file('tech_doc')->store('tech_docs', 'public');
        }

        $photoPath = null;
        if ($request->hasFile('photo') && $request->file('photo')->isValid()) {
            $photoPath = $request->file('photo')->store('product_photos', 'public');
        }

        $approverId = null;
        if ($request->is_approved) {
            $approverId = Auth::id();
        }

        $product = MasterProducts::create([
            'product_name' => $request->product_name,
            'product_type' => $request->product_type,
            'specifications' => $request->specifications,
            'unit_of_measure' => $request->unit_of_measure,
            'tech_doc' => $techDocPath,
            'photo' => $photoPath,
            'added_by' => Auth::id(),
            'is_approved' => $request->is_approved ?? false,
            'approved_by' => $approverId,
            'slug' => Str::slug($request->product_name) . '-' . Str::random(6),
            'category' => $request->category,
        ]);

        return response()->json(['message' => 'Product created successfully', 'product' => $product], 201);
    }

    /**
     * Update a master product.
     */
    public function update(Request $request, $id)
    {
        $product = MasterProducts::find($id);

        if (!$product) {
            return response()->json(['error' => 'Product not found'], 404);
        }

        $validator = Validator::make($request->all(), [
            'product_name' => 'sometimes|required|string|max:255',
            'product_type' => 'sometimes|required|string|max:255',
            'specifications' => 'nullable|string',
            'unit_of_measure' => 'nullable|string|max:100',
            'tech_doc' => 'nullable|file|mimes:pdf,docx,xlsx',
            'photo' => 'nullable|image|mimes:jpeg,png,jpg,gif|max:2048',
            'is_approved' => 'boolean',
            'category' => 'nullable|string|max:255|exists:category,id'
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        if ($request->hasFile('tech_doc') && $request->file('tech_doc')->isValid()) {
            if ($product->tech_doc) {
                Storage::delete('public/' . $product->tech_doc);
            }
            $product->tech_doc = $request->file('tech_doc')->store('tech_docs', 'public');
        }

        if ($request->hasFile('photo') && $request->file('photo')->isValid()) {
            if ($product->photo) {
                Storage::delete('public/' . $product->photo);
            }
            $product->photo = $request->file('photo')->store('product_photos', 'public');
        }

        if ($request->has('is_approved')) {
            if ($request->is_approved && !$product->is_approved) {
                $product->approved_by = Auth::id();
            } elseif (!$request->is_approved) {
                $product->approved_by = null;
            }
            $product->is_approved = $request->is_approved;
        }

        $product->update([
            'product_name' => $request->product_name ?? $product->product_name,
            'product_type' => $request->product_type ?? $product->product_type,
            'specifications' => $request->specifications ?? $product->specifications,
            'unit_of_measure' => $request->unit_of_measure ?? $product->unit_of_measure,
            'slug' => $request->product_name ? Str::slug($request->product_name) . '-' . Str::random(6) : $product->slug,
            'is_approved' => $product->is_approved,
            'approved_by' => $product->approved_by,
            'category' => $request->category ?? $product->category,
            'tech_doc' => $product->tech_doc,
            'photo' => $product->photo,
        ]);

        return response()->json(['message' => 'Product updated successfully', 'product' => $product], 200);
    }

    /**
     * Delete a master product.
     */
    public function destroy($id)
    {
        $product = MasterProducts::find($id);

        if (!$product) {
            return response()->json(['error' => 'Product not found'], 404);
        }

        if ($product->tech_doc) {
            Storage::delete('public/' . $product->tech_doc);
        }

        if ($product->photo) {
            Storage::delete('public/' . $product->photo);
        }

        $product->delete();

        return response()->json(['message' => 'Product deleted successfully'], 200);
    }

    public function approveRejectMasterProduct($id)
    {
        $product = MasterProducts::find($id);

        if (!$product) {
            return response()->json(['error' => 'Product not found'], 404);
        }

        if($product->is_approved) {
            // If already approved, reject it
            $product->is_approved = false;
            $product->approved_by = null;
        } else {
            // If not approved, approve it
            $product->is_approved = true;
            $product->approved_by = Auth::id();
        }
        $product->save();

        return response()->json(['message' => 'Product approval status updated', 'is_approved' => $product->is_approved], 200);
        
    }

    public function approveRejectSupplierOffer(Request $request , $id)
    {
        $offer = SupplierOffers::find($id);

        if (!$offer) {
            return response()->json(['error' => 'Supplier offer not found'], 404);
        }

        $validator = Validator::make($request->all(), [
            'status' => 'required|in:Approved,Rejected,Pending',
        ]);
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }
        $offer->status = $request->status;
        $offer->save();

        return response()->json(['message' => 'Supplier offer approval status updated', 'status' => $offer->status], 200);
        
    }


    public function importMasterProducts()
    {
        $filePath = base_path('Products-2.csv'); // CSV in Laravel root
        
        if (!file_exists($filePath)) {
            dd("CSV file not found.");
        }

        $handle = fopen($filePath, 'r');
       
        // Skip header row
        $header = fgetcsv($handle);

        while (($row = fgetcsv($handle)) !== false) {

            // CSV Columns Example:
            // 0 => Product Name
            // 1 => Product Type
            // 2 => Unit of Measure
            // 3 => Delivery Method

            $productName     = trim($row[0] ?? null);
            $productType     = trim($row[1] ?? null);
            $unitMeasure     = trim($row[2] ?? null);
            $deliveryMethod  = trim($row[3] ?? null);
       

            if (!$productName) {
                continue; // skip empty rows
            }

            MasterProducts::updateOrCreate(
                ['product_name' => $productName], // unique key
                [
                    'product_type'     => $productType,
                    'unit_of_measure'  => $unitMeasure,
                    'delivery_method'  => $deliveryMethod,

                    'category'         => 1,
                    'is_approved'      => 1,
                    'approved_by'      => 1,
                    'added_by'         => 1,

                    'slug'             => Str::slug($productName),

                    // other fields set null as requested
                    'specifications'   => null,
                    'tech_doc'         => null,
                    'photo'            => null,
                ]
            );
        }

        fclose($handle);

        return "Master products imported successfully.";
    }

    public function importOffers()
    {
        $filePath = base_path('supplier-offers.csv'); // CSV in Laravel root
        
        if (!file_exists($filePath)) {
            dd("CSV file not found.");
        }

        $handle = fopen($filePath, 'r');
        
        // Skip header row
        $header = fgetcsv($handle);

        while (($row = fgetcsv($handle)) !== false) {

            // CSV Columns Example:
            // 0 => Supplier ID
            // 1 => Product ID
            // 2 => Price


            $supplierId = trim($row[0] ?? null);
            $productId = trim($row[1] ?? null);
            $price = trim($row[2] ?? null);

            // Remove the dollar sign and format the price to two decimal places
            $price = str_replace('$', '', $price);
            $price = number_format((float)$price, 2, '.', ''); // Ensure 2 decimal places

            if (!$supplierId || !$productId) {
                continue; // skip empty rows
            }

            SupplierOffers::updateOrCreate(
                [
                    'supplier_id' => $supplierId,
                    'master_product_id' => $productId,
                    'price' => $price,
                    'availability_status' => 'In Stock',
                    'status' => 'Approved',
                ]
            );
        }

        fclose($handle);

        return "Supplier offers imported successfully.";
    }


    public function importUsers()
    {
        $filePath = base_path('suppliers.csv'); // CSV in Laravel root
        
        if (!file_exists($filePath)) {
            dd("CSV file not found.");
        }

        $handle = fopen($filePath, 'r');
        
        // Skip header row
        $header = fgetcsv($handle);

        while (($row = fgetcsv($handle)) !== false) {

            // CSV Columns Example:
            // 0 => Name
            // 1 => Email
            // 2 => Company Name
            // 3 => Contact Number

            $name     = trim($row[0] ?? null);
            $email    = trim($row[1] ?? null);
            $company_name = trim($row[2] ?? null);
            $contact_number     = trim($row[3] ?? null);


            if (!$name || !$email || !$company_name || !$contact_number) {
                continue; // skip empty rows
            }

            $company = Company::firstOrCreate(
                ['name' => $company_name]
            );
            $client_public_id = 'MC-' . str_pad(User::count() + 440, 3, '0', STR_PAD_LEFT);
            User::updateOrCreate(
                ['email' => $email], // unique key
                [
                    'name'     => $company_name,
                    'password' => Hash::make('password'),
                    'role'     => 'supplier',
                    'company_id' => $company->id,
                    'contact_number' => $contact_number,
                    'company_name' => $company_name,
                    'contact_name' => $name,
                    'status' => 'Active',
                    'client_public_id' => $client_public_id,
                ]
            );
        }

        fclose($handle);

        return "Users imported successfully.";
    }



    public function updateDeliveryZonesFromCSV()
    {

        set_time_limit(300);
        // Path to the CSV file in the root directory
        $filePath = base_path('zones.csv'); // Use base_path() to get the project root directory

        // Read the CSV file into an array
        $csvData = array_map('str_getcsv', file($filePath));
        $header = array_shift($csvData); // Extract the header to get column names
        $suppliers = [];

        // Loop through the CSV data and group by supplier name
        foreach ($csvData as $row) {
            $supplierName = $row[0]; // Assuming 'Supplier Name' is in the first column
            $address = $row[1]; // Assuming 'Address' is in the second column
            $radius = $row[2]; // Assuming 'Radius' is in the third column
            
            // Store data grouped by supplier name
            if (!isset($suppliers[$supplierName])) {
                $suppliers[$supplierName] = [];
            }
            
            $suppliers[$supplierName][] = [
                'address' => $address,
                'radius' => $radius
            ];
        }

        // Google Maps API Key
        $googleMapsApiKey = "AIzaSyAUjFL6wmCy8ETAqV1bhFRUEySaUAAX2_k"; // Ensure you set this in your .env file

        // Loop through each supplier, get lat/lng for each address, and update users
        foreach ($suppliers as $supplierName => $zones) {
            // Find the user by supplier name
            $user = User::where('name', $supplierName)->first();
            
            if ($user) {
                $deliveryZones = [];

                foreach ($zones as $zone) {
                    // Fetch lat/long using Google Maps API
                    $response = Http::get('https://maps.googleapis.com/maps/api/geocode/json', [
                        'address' => $zone['address'],
                        'key' => $googleMapsApiKey,
                    ]);

                    $data = $response->json();

                    if (isset($data['results'][0]['geometry']['location'])) {
                        $lat = $data['results'][0]['geometry']['location']['lat'];
                        $long = $data['results'][0]['geometry']['location']['lng'];
                        
                        // Add the data to delivery zones
                        $deliveryZones[] = [
                            'address' => $zone['address'],
                            'lat' => $lat,
                            'long' => $long,
                            'radius' => $zone['radius'],
                        ];
                    }
                }
                // dd($deliveryZones);
                // Encode the delivery zones and save to the user's delivery_zones field
                $user->delivery_zones = json_encode($deliveryZones);
                $user->save();
            }
        }

        return response()->json(['status' => 'Zones updated successfully']);
    }


    public function importOffersWithProducts()
{
    $filePath = base_path('offers.csv'); // CSV in Laravel root
    
    if (!file_exists($filePath)) {
        dd("CSV file not found.");
    }

    $handle = fopen($filePath, 'r');
    
    // Skip header row
    $header = fgetcsv($handle);

    $suppliers = [];

    // Read through the file and group products by supplier name
    while (($row = fgetcsv($handle)) !== false) {

        // CSV Columns Example (based on your clarification):
        // 0 => Supplier Name
        // 1 => Product Name
        // 2 => Product Type
        // 3 => Price
        // 4 => Unit of Measure
        // 5 => Delivery Method

        $supplierName    = trim($row[0] ?? null);
        $productName     = trim($row[1] ?? null);
        $productType     = trim($row[2] ?? null);
        $price           = trim($row[3] ?? null);
        $unitMeasure     = trim($row[4] ?? null);
        $deliveryMethod  = trim($row[5] ?? null);

        if (!$supplierName || !$productName || !$price) {
            continue; // skip empty rows
        }

        // Remove any non-numeric characters (such as currency symbols) from the price
        $price = preg_replace('/[^\d.]/', '', $price); // Remove any non-numeric characters except decimal
        $price = number_format((float)$price, 2, '.', ''); // Ensure two decimal places

        // Group by Supplier Name
        if (!isset($suppliers[$supplierName])) {
            $suppliers[$supplierName] = [];
        }

        $suppliers[$supplierName][] = [
            'product_name'   => $productName,
            'product_type'   => $productType,
            'price'          => $price,
            'unit_measure'   => $unitMeasure,
            'delivery_method'=> $deliveryMethod
        ];
    }

    fclose($handle);

    // Now process each supplier's products
    foreach ($suppliers as $supplierName => $products) {
        // Find the supplier ID by name
        $supplier = User::where('name', $supplierName)->first();

        if ($supplier) {
            foreach ($products as $product) {
                // Check if the product already exists in the MasterProducts table
                $masterProduct = MasterProducts::where('product_name', $product['product_name'])->first();

                if (!$masterProduct) {
                    // If the product doesn't exist, add it to the MasterProducts table
                    $masterProduct = MasterProducts::create([
                        'product_name'   => $product['product_name'],
                        'product_type'   => $product['product_type'],
                        'unit_of_measure'=> $product['unit_measure'],
                        'delivery_method'=> $product['delivery_method'],
                        'category'       => 1,
                        'is_approved'    => 1,
                        'approved_by'    => 1,
                        'added_by'       => 1,
                        'slug'           => Str::slug($product['product_name']),
                    ]);
                }

                // Now, create the offer for the supplier and product
                SupplierOffers::updateOrCreate(
                    [
                        'supplier_id' => $supplier->id,
                        'master_product_id' => $masterProduct->id,
                        'price' => $product['price'], // Correctly formatted price
                        'availability_status' => 'In Stock',
                        'status' => 'Approved',
                    ]
                );
            }
        }
    }

    return "Offers with products imported successfully.";
}


}


------------------------------------------------------------
FILE: app/Http/Controllers/Admin/OrderAdminController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers\Admin;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\DB;
use App\Models\Orders; // Adjust if your model is named Order
use App\Models\Projects;
use App\Models\OrderItem;
use App\Services\OrderPricingService;
use App\Models\SupplierOffers;
use App\Models\User; // assuming clients are users with role=client
use Illuminate\Validation\Rule;
use Illuminate\Support\Facades\Validator;
use Stripe\Climate\Order;

// use Pest\Configuration\Project;

class OrderAdminController extends Controller
{
    //


    public function index(Request $request)
    {
        $perPage   = (int) $request->get('per_page', 10);
        $search    = trim((string) $request->get('search', ''));
        $clientId  = $request->get('client_id');
        $projectId = $request->get('project_id');
        $supplierId= $request->get('supplier_id');
        $workflow  = $request->get('workflow');
        $payment   = $request->get('payment_status');
        $ddFrom    = $request->get('delivery_date_from');
        $ddTo      = $request->get('delivery_date_to');
        $method    = $request->get('delivery_method');
        $repeat    = $request->get('repeat_order') ?? null;
        $hasMissing= $request->get('has_missing_supplier');
        $confirms  = $request->get('supplier_confirms'); // "true"/"false" or null
        $minTotal  = $request->get('min_total');
        $maxTotal  = $request->get('max_total');
        $sort      = $request->get('sort', 'created_at');
        $dir       = strtolower($request->get('dir', 'desc')) === 'asc' ? 'asc' : 'desc';
        $details   = filter_var($request->get('details', false), FILTER_VALIDATE_BOOLEAN);

        if (!is_null($confirms)) {
            $confirms = $confirms === "true";
        }

        // Allowed sort columns (updated)
        $sortMap = [
            'po_number'      => 'po_number',
            'delivery_date'  => 'delivery_date',
            'created_at'     => 'created_at',
            'updated_at'     => 'updated_at',
            'total_price'    => 'total_price',          // use this instead of customer_cost/total
            'profit_amount'  => 'profit_amount',        // actual profit amount column
            'profit_before_tax'    => 'profit_before_tax',
            'profit_margin_percent'=> 'profit_margin_percent',
            'items_count'    => DB::raw('items_count'),
        ];
        if (!array_key_exists($sort, $sortMap)) {
            $sort = 'created_at';
        }

        // Base query
        $query = Orders::query()
            ->with([
                'client:id,name',
                'project:id,name',
                'items:id,order_id,supplier_id,quantity,supplier_confirms'
            ])
            ->withCount([
                'items as items_count',
                'items as unassigned_items_count' => function ($q) {
                    $q->whereNull('supplier_id');
                },
            ])
            ->withCount(['items as suppliers_count' => function ($q) {
                $q->whereNotNull('supplier_id')->select(DB::raw('COUNT(DISTINCT supplier_id)'));
            }]);

        // Text search
        if ($search !== '') {
            $query->where('po_number', 'like', "%{$search}%");
        }
        if ($clientId) {
            $query->where('client_id', $clientId);
        }
        if ($projectId) {
            $query->where('project_id', $projectId);
        }
        if ($workflow) {
            $query->where('workflow', $workflow);
        }
        if ($payment) {
            $query->where('payment_status', $payment);
        }
        if ($method) {
            $query->where('delivery_method', $method);
        }
        if ($ddFrom) {
            $query->whereDate('delivery_date', '>=', $ddFrom);
        }
        if ($ddTo) {
            $query->whereDate('delivery_date', '<=', $ddTo);
        }
        if (isset($repeat) && $repeat !== '') {
            $query->where('repeat_order', filter_var($repeat, FILTER_VALIDATE_BOOLEAN) ? 1 : 0);
        }
        if ($supplierId) {
            $query->whereHas('items', function ($q) use ($supplierId) {
                $q->where('supplier_id', $supplierId);
            });
        }
        if ($hasMissing) {
            $query->whereHas('items', function ($q) {
                $q->whereNull('supplier_id');
            });
        }
        if (!is_null($confirms)) {
            $query->whereHas('items', function ($q) use ($confirms) {
                $q->where('supplier_confirms', $confirms);
            });
        }

        // Totals filter now uses total_price only
        if ($minTotal !== null) {
            $query->where('total_price', '>=', $minTotal);
        }
        if ($maxTotal !== null) {
            $query->where('total_price', '<=', $maxTotal);
        }

        // Sorting
        if ($sort === 'items_count') {
            $query->orderBy('items_count', $dir);
        } else {
            $query->orderBy($sortMap[$sort], $dir);
        }

        $paginator = $query->paginate($perPage);

        // Transform rows
        $data = $paginator->getCollection()->map(function (Orders $o) {
            $total  = (float)($o->total_price ?? 0);
            $profit = (float)($o->profit_amount ?? $o->profit_amount ?? 0);

            $orderInfo = null;
            if ($o->workflow === 'Supplier Missing' && $o->unassigned_items_count > 0) {
                $orderInfo = 'Supplier missing for ' . $o->unassigned_items_count . ' items';
            } elseif ($o->workflow === 'Supplier Assigned') {
                $orderInfo = 'Waiting for suppliers to confirm';
            } elseif ($o->workflow === 'Payment Requested') {
                $orderInfo = 'Awaiting client payment';
            }
          
            //claude
            return [
                'id'                       => $o->id,
                'po_number'                => $o->po_number,
                'client'                   => optional($o->client)->name,
                'project'                  => optional($o->project)->name,
                'delivery_date'            => $o->delivery_date,
                'delivery_time'            => $o->delivery_time,
                'delivery_method'          => $o->delivery_method,
                'workflow'                 => $o->workflow,
                'payment_status'           => $o->payment_status,
                'order_process'            => $o->order_process,
                'items_count'              => $o->items_count,
                'unassigned_items_count'   => $o->unassigned_items_count,
                'suppliers_count'          => $o->suppliers_count ?? 0,
                
                // NEW: Supplier costs
                'supplier_item_cost'       => round((float)($o->supplier_item_cost ?? 0), 2),
                'supplier_delivery_cost'   => round((float)($o->supplier_delivery_cost ?? 0), 2),
                'supplier_total'           => round((float)($o->supplier_item_cost ?? 0) + (float)($o->supplier_delivery_cost ?? 0), 2),
                
                // NEW: Customer costs
                'customer_item_cost'       => round((float)($o->customer_item_cost ?? 0), 2),
                'customer_delivery_cost'   => round((float)($o->customer_delivery_cost ?? 0), 2),
                
                'total_price'              => round($total, 2),
                'profit_amount'            => round($profit, 2),
                'profit_margin_percent'    => round((float)($o->profit_margin_percent ?? 0), 4),
                
                // NEW: Other charges
                'gst_tax'                  => round((float)($o->gst_tax ?? 0), 2),
                'discount'                 => round((float)($o->discount ?? 0), 2),
                'other_charges'            => round((float)($o->other_charges ?? 0), 2),
                
                'order_info'               => $orderInfo,
                'repeat_order'             => $o->repeat_order,
                'created_at'               => $o->created_at,
                'updated_at'               => $o->updated_at,
            ];
        });

        // Metrics
        $base = Orders::query();
        $metrics = [
            'total_orders_count'     => (clone $base)->count(),
            'supplier_missing_count' => (clone $base)->where('workflow', 'Supplier Missing')->count(),
            'supplier_assigned_count'=> (clone $base)->where('workflow', 'Supplier Assigned')->count(),
            'awaiting_payment_count' => (clone $base)->where('workflow', 'Payment Requested')->count(),
            'delivered_count'        => (clone $base)->where('workflow', 'Delivered')->count(),
        ];

        $response = [
            'data' => $data,
            'pagination' => [
                'per_page'       => $paginator->perPage(),
                'current_page'   => $paginator->currentPage(),
                'total_pages'    => $paginator->lastPage(),
                'total_items'    => $paginator->total(),
                'has_more_pages' => $paginator->hasMorePages(),
            ],
            'metrics' => $metrics,
        ];

        if ($details) {
            $response['filters'] = [
                'clients'          => User::query()->where('role', 'client')->select('id','name','profile_image')->orderBy('name')->get(),
                'suppliers'        => User::where('role','supplier')->select('id','name','profile_image')->orderBy('name')->get(),
                'projects'         => Projects::query()->select('id','name')->orderBy('name')->get(),
                'workflows'        => ['Requested','Supplier Missing','Supplier Assigned','Payment Requested','On Hold','Delivered'],
                'payment_statuses' => ['Pending','Requested','Paid','Partially Paid','Partial Refunded','Refunded'],
                'delivery_methods' => ['Other','Tipper','Agitator','Pump','Ute'],
            ];
        }

        return response()->json($response);
    }



    public function show(Orders $order)
    {
        // dd($order->delivery_method);
        $order->load(['client:id,name', 'project:id,name', 'items.product:id,product_name']);
     
        $deliveryLat = $order->delivery_lat ?? null;   // adjust if different
        $deliveryLng = $order->delivery_long ?? null;
        // dd($order->project->id);
        $filters['projects'] = Projects::where('added_by', $order->client_id)->where('id', '!=', $order->project->id)->get();
        

        $payload = [
            //Order Details For Display (Not Changeable)
            'id' => $order->id,
            'po_number' => $order->po_number,
            'client' => optional($order->client)->name,
            'project' => optional($order->project)->name,
            'delivery_address' => $order->delivery_address,
            'delivery_lat'=>$order->delivery_lat,
            'delivery_long'=> $order->delivery_long,
            'delivery_date' => $order->delivery_date,
            'delivery_time' => $order->delivery_time,
            'delivery_window'=> $order->delivery_window,
            'delivery_method' => $order->delivery_method,
            'load_size'=> $order->load_size,
            'special_equipment'=> $order->special_equipment,
            'repeat_order'=> (int) $order->repeat_order,
            'order_process'=> $order->order_process,
                //status
            'workflow' => $order->workflow,
            'payment_status' => $order->payment_status,
            'order_status' => $order->order_status,

            'gst_tax'=> round((float)$order->gst_tax),
            'discount'=>round((float)$order->discount),
            'other_charges'=>round((float)$order->other_charges),
            'total_price'=>round((float)$order->total_price),
            'customer_item_cost'=>round((float)$order->customer_item_cost),
            'customer_delivery_cost'=>round((float)$order->customer_delivery_cost),
            'supplier_item_cost'=>round((float)$order->supplier_item_cost),
            'supplier_delivery_cost'=>round((float)$order->supplier_delivery_cost),
            'profit_margin_percent'=>(float)$order->profit_margin_percent,
            'profit_amount'=>round((float)$order->profit_amount),
            'items' => [],
            'filters'=>$filters
        ];

        // If not Supplier Missing, return items without eligibility calc
        if ($order->workflow !== 'Supplier Missing') {
            
            foreach ($order->items as $it) {
            //    dd($it->is_quoted);
                $payload['items'][] = [
                    'id' => $it->id,
                    'product_id' => $it->product_id,
                    'product_name' => optional($it->product)->product_name,
                    'quantity' => $it->quantity,
                    'supplier' => $it->supplier,
                    'choosen_offer_id' => $it->choosen_offer_id ?? null,
                    'supplier_confirms' => $it->supplier_confirms,
                    'supplier_unit_cost' => $it->supplier_unit_cost,
                    'delivery_cost' => $it->delivery_cost,
                    'supplier_discount' => $it->supplier_discount,
                    'delivery_type'=>$it->delivery_type,
                    'is_quoted'         => (int) $it->is_quoted,
                    'is_paid' => (int) $it->is_paid,
                    'quoted_price'=>$it->quoted_price,
                    'eligible_suppliers' => [],
                ];
            }
            return response()->json(['data' => $payload]);
        }

        $canComputeDistance = is_numeric($deliveryLat) && is_numeric($deliveryLng);

        // preload offers for all products on this order
        $masterIds = $order->items->pluck('product_id')->filter()->unique()->values();

        $offersByProduct = SupplierOffers::query()
            ->whereIn('master_product_id', $masterIds)
            ->with(['supplier:id,name,role,delivery_zones'])
            ->get()
            ->groupBy('master_product_id');
     
        foreach ($order->items as $it) {
            // already assigned  just echo item info
            if (!is_null($it->supplier_id)) {
                // dd($it);
                $payload['items'][] = [
                    'id' => $it->id,
                    'product_id' => $it->product_id,
                    'product_name' => optional($it->product)->product_name,
                    'quantity' => $it->quantity,
                    'supplier' => $it->supplier()->select('id','name','profile_image','delivery_zones')->first(),
                    'choosen_offer_id' => $it->choosen_offer_id ?? null,
                    'supplier_confirms' => $it->supplier_confirms,
                    'supplier_unit_cost' => $it->supplier_unit_cost,
                    'delivery_cost' => $it->delivery_cost,
                    'supplier_discount' => $it->supplier_discount,
                    'delivery_type'=>$it->delivery_type,
                    'is_quoted'         => (int) $it->is_quoted,
                    'is_paid' => (int) $it->is_paid,
                    'quoted_price'=>$it->quoted_price,
                    'eligible_suppliers' => [],
                ];
                continue;
            }

            // unassigned  build eligible_suppliers
            $eligible = [];
            $productOffers = $offersByProduct->get($it->product_id, collect());

            foreach ($productOffers as $offer) {
                $supplier = $offer->supplier; // users table row
                if (!$supplier) continue;
                if (strtolower((string)$supplier->role) !== 'supplier') continue;

                if (empty($supplier->delivery_zones)) continue; // must not be null/empty
                $zones = is_array($supplier->delivery_zones)
                    ? $supplier->delivery_zones
                    : $this->decodeZones($supplier->delivery_zones);
                if (empty($zones)) continue;

                $distance = null;
                // dd($canComputeDistance);
                // $canComputeDistance = true;
                if ($canComputeDistance) {
                    // dd($zones, $deliveryLat, $deliveryLng);
                    $distance = $this->nearestZoneDistanceKm($zones, (float)$deliveryLat, (float)$deliveryLng);
                }

                $eligible[] = [
                    'supplier_id' => (int) $supplier->id,
                    'name'=> (string) $supplier->name,
                    'offer_id'    => (int) $offer->id,
                    'unit_cost' => (float) $offer->price,
                    'distance'    => is_null($distance) ? null : round($distance, 3),
                ];
            }

            usort($eligible, function ($a, $b) {
                if ($a['distance'] === null && $b['distance'] === null) return 0;
                if ($a['distance'] === null) return 1;
                if ($b['distance'] === null) return -1;
                return $a['distance'] <=> $b['distance'];
            });

            $payload['items'][] = [
                'id' => $it->id,
                'product_id' => $it->product_id,
                'product_name' => optional($it->product)->product_name,
                'quantity' => $it->quantity,
                'supplier_id' => $it->supplier_id,
                'eligible_suppliers' => $eligible,
            ];
        }

        return response()->json(['data' => $payload]);
    }

    public function assignSupplier(Request $request)
    {
        $v = Validator::make($request->all(), [
            'order_id' => ['required','integer','min:1'],
            'item_id'  => ['required','integer','min:1'],
            'supplier' => ['required','integer','min:1'],     // supplier_id
            'offer_id' => ['sometimes','integer','min:1'],    // optional
        ]);
        if ($v->fails()) return response()->json(['error' => $v->errors()], 422);

        $orderId    = (int) $request->order_id;
        $itemId     = (int) $request->item_id;
        $supplierId = (int) $request->supplier;
        $offerId    = $request->filled('offer_id') ? (int) $request->offer_id : null;

        return DB::transaction(function () use ($orderId, $itemId, $supplierId, $offerId) {

            /** @var Orders $order */
            $order = Orders::with('items')->lockForUpdate()->findOrFail($orderId);

            /** @var OrderItem $item */
            $item = $order->items()->whereKey($itemId)->lockForUpdate()->firstOrFail();
            if (!$item->product_id) {
                return response()->json(['error' => ['item' => ['Item has no product_id.']]], 422);
            }

            // supplier must exist and be role=supplier
            $supplier = User::find($supplierId);
            if (!$supplier || strtolower((string)$supplier->role) !== 'supplier') {
                return response()->json(['error' => ['supplier' => ['Invalid supplier.']]], 422);
            }

            // pick matching offer by supplier+product (or the explicit one)
            $offerQ = SupplierOffers::query()
                ->where('supplier_id', $supplierId)
                ->where('master_product_id', $item->product_id)
                ->where('status','Approved')
                ->whereIn('availability_status',['In Stock','Limited']);
            if ($offerId) $offerQ->whereKey($offerId);

            $offer = $offerQ->orderBy('price')->first();
            if (!$offer) {
                return response()->json(['error' => ['offer' => ['No offer for this supplier and product.']]], 422);
            }

            $unitCost         = (float)($offer->price ?? $offer->price ?? 0);
            // $supplierDiscount = (float)($offer->supplier_discount ?? $offer->discount ?? 0);

            // assign. delivery fields stay null. no confirms flag.
            $item->forceFill([
                'supplier_id'            => $supplierId,
                'choosen_offer_id'       => $offer->id,
                'supplier_unit_cost'     => round($unitCost, 2),
                'supplier_discount'      => 0.00,
                'supplier_delivery_cost' => 0.00,
                'delivery_type'          => null,
                'delivery_cost'          => 0.00,
            ])->saveOrFail();

            // if all items now have a supplier -> set workflow
            $unassignedCount = $order->items()->whereNull('supplier_id')->count();
            if ($unassignedCount === 0 && $order->workflow !== 'Supplier Assigned') {
                $order->workflow = 'Supplier Assigned';
                $order->save();
            }

            // recalc customer totals
            $order->load('items');
            OrderPricingService::recalcCustomer($order, null, null, true);

            return response()->json([
                'message' => 'Supplier assigned.',
                'order' => [
                    'id'                     => $order->id,
                    'workflow'               => $order->workflow,
                    'total_price'            => $order->total_price,
                    'profit_amount'          => $order->profit_amount,
                    'profit_margin_percent'  => $order->profit_margin_percent,
                ],
                'item' => [
                    'id'                     => $item->id,
                    'product_id'             => $item->product_id,
                    'supplier_id'            => $item->supplier_id,
                    'choosen_offer_id'       => $item->choosen_offer_id,
                    'supplier_unit_cost'     => $item->supplier_unit_cost,
                    'supplier_discount'      => $item->supplier_discount,
                    'supplier_delivery_cost' => $item->supplier_delivery_cost, // null
                    'delivery_type'          => $item->delivery_type,          // null
                    'delivery_cost'          => $item->delivery_cost,          // null
                ],
                'offer' => [
                    'id'                => $offer->id,
                    'supplier_id'       => $offer->supplier_id,
                    'master_product_id' => $offer->master_product_id,
                ],
            ]);
        });
    }

    public function supplierPaidStatus(Request $request, Orders $order, OrderItem $orderItem)
    {
        // only admins hit this via middleware
        $v = Validator::make($request->all(), [
            'is_paid'         => ['sometimes','required','boolean'],
            
        ]);
        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }

        $item = OrderItem::find((int)$orderItem->id);
        if (!$item) {
            return response()->json(['error' => 'Item not found'], 404);
        }

        $isPaid = filter_var($request->is_paid, FILTER_VALIDATE_BOOLEAN);

        $item->is_paid = $isPaid ? 1 : 0;
        // $item->supplier_status = $isPaid ? 'Paid' : 'Unpaid';
        $item->save();

        return response()->json([
            'success' => true,
            'message' => $isPaid
                ? 'Item marked as paid and supplier status set to Paid'
                : 'Item marked as unpaid and supplier status set to Unpaid',
            'item' => $item,
        ]);

    }

    public function adminUpdate(Request $request, Orders $order)
    {
        // only admins hit this via middleware
        $v = Validator::make($request->all(), [
            'discount'        => ['sometimes','required','numeric','min:0'],
            'is_paid'         => ['sometimes','required','boleean'],
            'item_id'         => ['sometimes','required','numeric','min:1'],  
        ]);

        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }
        //for discount
        

        $dirty = [];

        //for discount
        if ($request->has('discount')) {
            $dirty['discount'] = (float)$request->discount;
            // dd($request->discount);
            // Apply updates
            $order->update($dirty);

            // Refresh minimal payload
            $order->load(['project:id,name','items:id,order_id,product_id,supplier_id,supplier_delivery_date']);
            // Recalculate customer-facing totals only
            OrderPricingService::recalcCustomer($order, null, null, true);

            return response()->json([
                'success' => true,
                'message' => 'Order updated by admin',
                'order'   => $order,
            ]);
        }

        if ($request->has('item_id') && $request->has('is_paid')) {
            $item = OrderItem::find((int)$request->item_id);
            if (!$item) {
                return response()->json(['error' => 'Item not found'], 404);
            }

            $isPaid = filter_var($request->is_paid, FILTER_VALIDATE_BOOLEAN);

            $item->is_paid = $isPaid ? 1 : 0;
            $item->supplier_status = $isPaid ? 'Paid' : 'Unpaid';
            $item->save();

            return response()->json([
                'success' => true,
                'message' => $isPaid
                    ? 'Item marked as paid and supplier status set to Paid'
                    : 'Item marked as unpaid and supplier status set to Unpaid',
                'item' => $item,
            ]);
        }
        
    }


    /** Decode users.delivery_zones JSON to [['lat'=>..,'lng'=>..,'radius_km'=>?...],...] */
    private function decodeZones($json): array
    {
        try {
            $raw = is_array($json) ? $json : json_decode($json, true, 512, JSON_THROW_ON_ERROR);
        } catch (\Throwable $e) {
            return [];
        }
        $zones = [];
        foreach ((array)$raw as $z) {
            $lat = $z['lat'] ?? $z['latitude'] ?? null;
            $lng = $z['lng'] ?? $z['longitude'] ?? null;
            $rkm = $z['radius_km'] ?? $z['radius'] ?? null;
            if (is_numeric($lat) && is_numeric($lng)) {
                $zones[] = ['lat'=>(float)$lat,'lng'=>(float)$lng,'radius_km'=>is_numeric($rkm)?(float)$rkm:null];
            }
        }
        return $zones;
    }

    /** Nearest zones center distance in km */
    private function nearestZoneDistanceKm(array $zones, float $lat, float $lng): ?float
    {
        // dd($zones, $lat , $lng);
        $min = null;
        foreach ($zones as $z) {
            $d = $this->haversineKm($lat, $lng, $z['lat'], $z['long']);
            if ($min === null || $d < $min) $min = $d;
        }
        return $min;
    }

    /** Haversine distance in km */
    private function haversineKm(float $lat1, float $lon1, float $lat2, float $lon2): float
    {
        $R = 6371;
        $dLat = deg2rad($lat2 - $lat1);
        $dLon = deg2rad($lon2 - $lon1);
        $a = sin($dLat/2)**2 + cos(deg2rad($lat1))*cos(deg2rad($lat2))*sin($dLon/2)**2;
        return 2 * $R * atan2(sqrt($a), sqrt(1 - $a));
    }



    public function setItemQuotedPrice(Request $request, int $orderId, int $itemId)
    {
       
        $data = $request->validate([
            'quoted_price' => 'nullable|numeric|min:0', // null clears quote
        ]);

        $check = Orders::where('id',$orderId)->where('payment_status','pending')->first();

        if(!$check)
        {
            return response()->json([
                'error'=>"Can not update it's pricing now",
            ], 409);
        }

        return DB::transaction(function () use ($orderId, $itemId, $data) {
            // Lock the item row and guarantee it belongs to the order
            /** @var OrderItem $item */
            $item = OrderItem::where('order_id', $orderId)
                ->lockForUpdate()
                ->findOrFail($itemId);

            // Important: do not coerce null to 0.00
            $quoted = array_key_exists('quoted_price', $data) ? $data['quoted_price'] : null;

            // Assign and save
            $item->forceFill([
                'quoted_price' => $quoted,                 // stays null if clearing
                'is_quoted'    => is_null($quoted) ? 0 : 1,
            ]);

            $item->saveOrFail();

            // Recalculate customer-facing totals only
            $order = Orders::with('items')->findOrFail($orderId);
            OrderPricingService::recalcCustomer($order, null, null, true);

            return response()->json([
                'message' => 'Quoted price saved. Customer totals recalculated.',
                'order' => [
                    'id'                     => $order->id,
                    'customer_item_cost'     => $order->customer_item_cost,
                    'customer_delivery_cost' => $order->customer_delivery_cost,
                    'gst_tax'                => $order->gst_tax,
                    'total_price'            => $order->total_price,
                    'profit_amount'          => $order->profit_amount,
                    'profit_margin_percent'  => $order->profit_margin_percent,
                ],
                'item' => [
                    'id'           => $item->id,
                    'is_quoted'    => (int)$item->is_quoted,
                    'quoted_price' => $item->quoted_price, // null if cleared
                ],
            ]);
        });
    }


    public function updateOrderPricingAdmin(Request $request, OrderItem $orderItem)
    {
        $v = Validator::make($request->all(), [
            'supplier_unit_cost' => 'sometimes|required|numeric|min:0',
            'supplier_discount' => 'sometimes|required|numeric|min:0',
            'supplier_delivery_date' => 'sometimes|required|date',
            'supplier_confirms' => 'sometimes|required|boolean',
            'delivery_cost' => 'sometimes|required|numeric|min:0',
            'delivery_type'=> 'required|in:Included,Supplier,ThirdParty,Fleet,None ',
            'supplier_notes' => 'sometimes|nullable|string|max:500',
            'quantity' => 'sometimes|nullable|numeric|min:1'
        ]);

        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }

        // Check if the authenticated user is the supplier for this order item

        if(!in_array($orderItem->order->workflow, ['Supplier Assigned', 'Requested', 'Payment Requested'])) {  //, 'Payment Requested', 'On Hold', 'Delivered'
            return response()->json([
                'message' => 'Cannot update order item now as the order is in '.$orderItem->order->workflow.' status'
            ], 403);
        }   

        // Check if order item is already confirmed
        if ($orderItem->supplier_confirms && $request->has('supplier_confirms') && !$request->supplier_confirms) {
            return response()->json([
                'message' => 'Cannot unconfirm an already confirmed order item'
            ], 422);
        }

        try {
            DB::beginTransaction();

            // Update the order item with provided fields
            $updateData = [];
            
            if ($request->has('supplier_unit_cost')) {
                $updateData['supplier_unit_cost'] = $request->supplier_unit_cost;
            }
            
            if ($request->has('delivery_cost')) {
                $updateData['delivery_cost'] = $request->delivery_cost;
            }
            
            if ($request->has('supplier_discount')) {
                $updateData['supplier_discount'] = $request->supplier_discount;
            }

            if ($request->has('delivery_type')) {
                $updateData['delivery_type'] = $request->delivery_type;
            }
            
            if ($request->has('supplier_delivery_date')) {
                $updateData['supplier_delivery_date'] = $request->supplier_delivery_date;
            }
            
            if ($request->has('supplier_confirms')) {
                $updateData['supplier_confirms'] = $request->supplier_confirms;
            }
            
            if ($request->has('supplier_notes')) {
                $updateData['supplier_notes'] = $request->supplier_notes;
            }
            
            if($request->has('quantity')) {
                $updateData['quantity'] = $request->quantity;
            }

            // Update the order item
            $orderItem->update($updateData);

            // If supplier confirmed the order, trigger workflow check
            if ($request->has('supplier_confirms') && $request->supplier_confirms) {
                $this->workflow($orderItem->order);
            }

            DB::commit();

            // Reload the order item with relationships
            $orderItem->load(['order', 'product', 'chosenOffer']);

            return response()->json([
                'success' => true,
                'message' => 'Order item updated successfully',
                'data' => $orderItem
            ]);

        } catch (\Exception $e) {
            DB::rollBack();
            return response()->json([
                'error' => 'Failed to update order item: ' . $e->getMessage()
            ], 500);
        }
    }

    private function workflow(Orders $order)
    {
        $currentWorkflow = $order->workflow;

        switch ($currentWorkflow) {
            case 'Supplier Assigned':
                $allConfirmed = $order->items()->where('supplier_confirms', false)->count() === 0;
                if (!$allConfirmed) {
                    break;
                }

                // Constants
                $ADMIN_MARGIN    = 0.50;
                $DELIVERY_MARGIN = 0.10;
                $FLEET_MARGIN    = 0.15;
                $GST_RATE        = 0.10;

                // Accumulators
                $customer_item_cost     = 0.0;
                $customer_delivery_cost = 0.0;
                $supplier_item_cost     = 0.0;
                $supplier_delivery_cost = 0.0;

                foreach ($order->items as $item) {
                    // Supplier material cost
                    $base_material_cost = ($item->supplier_unit_cost * $item->quantity) - $item->supplier_discount;
                    if ($base_material_cost < 0) { $base_material_cost = 0; }
                    $supplier_item_cost += $base_material_cost;

                    // Customer item cost with admin margin or quoted override
                    if ((int)$item->is_quoted === 1 && $item->quoted_price !== null) {
                        $customer_item_cost += (float)$item->quoted_price;
                    } else {
                        $customer_item_cost += $base_material_cost * (1 + $ADMIN_MARGIN);
                    }

                    // Delivery handling
                    $dtype = (string)$item->delivery_type;
                    if ($dtype === 'Supplier' || $dtype === 'ThirdParty') {
                        $customer_delivery_cost += $item->delivery_cost * (1 + $DELIVERY_MARGIN);
                        $supplier_delivery_cost += $item->delivery_cost;
                    } elseif ($dtype === 'Fleet') {
                        $customer_delivery_cost += $item->delivery_cost * (1 + $FLEET_MARGIN);
                        $supplier_delivery_cost += $item->delivery_cost;
                    } elseif ($dtype === 'Included' || $dtype === 'None' || $dtype === '' || $dtype === null) {
                        // No delivery cost
                    } else {
                        // Unknown type: supplier bears base delivery
                        $supplier_delivery_cost += (float)$item->delivery_cost;
                    }
                }

                // GST on customer-facing costs
                $gst_tax = ($customer_item_cost + $customer_delivery_cost) * $GST_RATE;

                // Totals
                $discount      = (float)($order->discount ?? 0);
                $other_charges = (float)($order->other_charges ?? 0);

                $total_price = $customer_item_cost
                            + $customer_delivery_cost
                            + $gst_tax
                            - $discount
                            + $other_charges;

                // Profit metrics
                $supplier_total    = $supplier_item_cost + $supplier_delivery_cost;
                $profit_before_tax = $total_price - $supplier_total - $gst_tax;
                $profit_margin_percent = $supplier_total > 0 ? ($profit_before_tax / $supplier_total) : 0.0;

                // Save to order
                $order->customer_item_cost     = round($customer_item_cost, 2);
                $order->customer_delivery_cost = round($customer_delivery_cost, 2);
                $order->supplier_item_cost     = round($supplier_item_cost, 2);
                $order->supplier_delivery_cost = round($supplier_delivery_cost, 2);
                $order->gst_tax                = round($gst_tax, 2);
                $order->total_price            = round($total_price, 2);

                // Actual profit amount (not percentage)
                $order->profit_amount          = round($profit_before_tax, 2);
                $order->profit_margin_percent  = round($profit_margin_percent,2);

                $order->workflow = 'Payment Requested';
                $order->order_status = "Confirmed";
                // dd($customer_item_cost, $customer_delivery_cost, $supplier_item_cost, $supplier_delivery_cost, $profit_margin_percent, $profit_before_tax);
                $order->save();

                break;
        }
    
    }

    public function updateOrderStatus(Request $request,Order $order){
    $v = Validator::make($request->all(), [
        'order_status' => ['required','string'],
    ]);
    if ($v->fails()) return response()->json(['error' => $v->errors()], 422);
    
    $order->order_status = $request->order_status;
    $order->save();

    // FIXED: Remove the extra "->order"
    return response()->json([
        'order_status' => $order->order_status,
        'message' => 'Order Status set to ' . $order->order_status
    ], 200);
}
}


------------------------------------------------------------
FILE: app/Http/Controllers/AdminController.php
------------------------------------------------------------
<?php
//To be deleted
namespace App\Http\Controllers;

use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;



class AdminController extends Controller
{
    public function clients()
    {
        // dd('here');
        $clients = User::where('role', 'client')->get();
        $totalClients = $clients->count();
        $activeClients = $clients->where('status', 'Active')->count();
        $inactiveClients = $clients->where('status', 'In-Active')->count();
        $joinedThisMonth = $clients->where('created_at', '>=', now()->startOfMonth())->count();
        return view('clients.index', compact('clients','totalClients','activeClients','inactiveClients','joinedThisMonth'));
    }

    public function addClient(Request $request)
    {
        $data = $request->validate([
            'name'           => 'required|string|max:120',
            'email'          => 'required|email|max:120|unique:users,email',
            'password'       => 'required|string|min:8|confirmed',
            'company_name'   => 'nullable|string|max:120',
            'contact_name'   => 'nullable|string|max:100',
            'contact_number' => 'nullable|string|max:20',
            'shipping_address' => 'nullable|string|max:255',
            'delivery_address' => 'nullable|string|max:255',
        ]);


        $user = User::create([
            'name'           => $data['name'],
            'email'          => $data['email'],
            'password'       => Hash::make($data['password']),   // <-- hashed here
            'role'           => 'client',
            'company_name'   => $data['company_name'] ?? null,
            'contact_name'   => $data['contact_name'] ?? null,
            'contact_number' => $data['contact_number'] ?? null,
            'shipping_address' => $data['shipping_address'] ?? null,
            'delivery_address' => $data['delivery_address'] ?? null,
            'status'         => 'Active', // Default status
        ]);


        return redirect()->route('clients')->with('success', 'Client added successfully');
    }


    
}


------------------------------------------------------------
FILE: app/Http/Controllers/ApiAuthController.php
------------------------------------------------------------
<?php
namespace App\Http\Controllers;

use App\Models\User;
use App\Models\Company;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Str;
use Illuminate\Support\Facades\Validator;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Storage;
use Laravel\Sanctum\HasApiTokens;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Http;

class ApiAuthController extends Controller
{
    // Register Client
    public function registerClient(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users,email',
            'password' => 'required|string|min:6',
            'contact_name' => 'required|string|max:255',
            'contact_number' => 'required|string|max:255',
            'shipping_address' => 'required|string|max:255',
            'billing_address' => 'required|string|max:255',
            'profile_image' => 'nullable|image|max:2048', // Optional profile image
            'company_name' => 'nullable|string|max:255',
            'lat' => 'nullable|numeric',
            'long' => 'nullable|numeric',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $imageUrl = null;
        // Handle profile image
        if ($request->hasFile('profile_image') && $request->file('profile_image')->isValid()) {
            // Store the file under 'profile_images' directory in the 'public' disk
            $path = $request->file('profile_image')->store('profile_images', 'public');
            $imageUrl = 'storage/' . $path; // Relative path to the image
        } 

        // Check if company exists, or create new
        $company = Company::firstOrCreate([
            'name' => Str::lower($request->company_name),
        ]);

        // Generate unique client ID
        do {
            $clientPublicId = 'MC-' . rand(100, 999);
        } while (User::where('client_public_id', $clientPublicId)->exists());

        // Register client
        $user = User::create([
            'name' => $request->name,
            'email' => $request->email,
            'password' => Hash::make($request->password),
            'role' => 'client',
            'company_id' => $company->id,
            'contact_name' => $request->contact_name,
            'contact_number' => $request->contact_number,
            'shipping_address' => $request->shipping_address,
            'billing_address' => $request->billing_address,
            'client_public_id' => $clientPublicId,
            'isDeleted' => false,
            'profile_image' => $imageUrl, // Store the relative path
            'lat' => $request->lat,
            'long' => $request->long,
        ]);

        // Create Sanctum Token for the user
        $token = $user->createToken('ClientApp')->plainTextToken;


        return response()->json([
            'message' => 'Client registered successfully.',
            'token' => $token,
            'user' => $user,
            'role' => $user->role,
            'profile_image_url' => $imageUrl, // Return the image URL in response
        ], 201);
    }


    // Register Supplier
    public function registerSupplier(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users,email',
            'password' => 'required|string|min:6',
            'contact_name' => 'required|string|max:255',
            'contact_number' => 'required|string|max:255',
            'location' => 'nullable|string|max:255',
            'company_name' => 'required|string|max:255',
            'profile_image' => 'nullable|image|max:2048', // Optional profile image
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        // Check if company exists, or create new
        $company = Company::firstOrCreate([
            'name' => Str::lower($request->company_name), // Assuming the company name is based on contact name
        ]);

        $imageUrl = null;
        // Handle profile image
        if ($request->hasFile('profile_image') && $request->file('profile_image')->isValid()) {
            // Store the file under 'profile_images' directory in the 'public' disk
            $path = $request->file('profile_image')->store('profile_images', 'public');
            $imageUrl = 'storage/' . $path; // Relative path to the image
        }

        // Register supplier (auto-role assignment)
        $user = User::create([
            'name' => $request->name,
            'email' => $request->email,
            'password' => Hash::make($request->password),
            'role' => 'supplier', // Set role as supplier for registration
            'company_id' => $company->id,
            'contact_name' => $request->contact_name,
            'contact_number' => $request->contact_number,
            'location' => $request->location,
            'isDeleted' => false,
            'profile_image' => $imageUrl,
        ]);

        // Create Sanctum Token for the user
        $token = $user->createToken('SupplierApp')->plainTextToken;

        return response()->json([
            'message' => 'Supplier registered successfully.',
            'token' => $token,
            'user' => $user,
            'role' => $user->role,
            'profile_image_url' => $imageUrl, // Return the image URL in response
        ], 201);
    }
    
    // Login Function
    public function login(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'email' => 'required|email',
            'password' => 'required|string|min:6',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        if (!User::where('email', $request->email)->exists()) {
            return response()->json(['error' => 'Email not registered.'], 404);
        }

        // Check credentials
        if (Auth::attempt(['email' => $request->email, 'password' => $request->password])) {
            $user = Auth::user();

            // Create a new token for the user
            $token = $user->createToken('UserApp')->plainTextToken;

            return response()->json([
                'message' => 'Login successful.',
                'token' => $token,
                'user' => $user,
                'role' => $user->role,
            ], 200);
        }

        return response()->json(['error' => 'Password is wrong'], 401);
    }


    public function checkAuth(Request $request)
    {
        // Check if the user is authenticated using Sanctum or session authentication
        if (Auth::check()) {
            // The user is authenticated
            $user = Auth::user()->load('company'); // Get the authenticated user
            if($user->role === 'supplier' && $user->delivery_zones && $user->delivery_zones !== 'null' && $user->delivery_zones !== null ) {
                $user->delivery_zones = $user->delivery_zones;
            }
    
            // Return the user details along with the role
            return response()->json([
                'message' => 'User is authenticated',
                'user' => $user,
                'role' => $user->role,
            ], 200); // 200 OK status code
        } else {
            // The user is not authenticated
            return response()->json([
                'message' => 'User is not authenticated',
            ], 401); // Unauthorized status code
        }
    }


    public function logout(Request $request)
    {
        $user = Auth::user();
        if ($request->boolean('all')) {
            $user->tokens()->delete();                 // revoke all tokens
        } else {
            $user->currentAccessToken()?->delete();    // revoke current token
        }
        return response()->json(['message' => 'Logged out'], 200);
    }

    /**
     * Update profile (no password). Handles client and supplier fields.
     * Accepts:
     *  - Common: name, email, contact_name, contact_number, profile_image
     *  - Client: shipping_address, billing_address, lat, long, company_name
     *  - Supplier: location, delivery_radius, company_name
     */
    public function updateProfile(Request $request)
    {
        $user = Auth::user();

        $validator = Validator::make($request->all(), [
            'name'            => 'sometimes|string|max:255',
            'email'           => 'sometimes|email|unique:users,email,' . $user->id,
            'contact_name'    => 'sometimes|nullable|string|max:255',
            'contact_number'  => 'sometimes|nullable|string|max:255',
            'profile_image'   => 'sometimes|file|image|max:4096',

            // client fields
            'shipping_address'=> 'sometimes|nullable|string|max:255',
            'billing_address' => 'sometimes|nullable|string|max:255',
            'lat'             => 'sometimes|nullable|numeric',
            'long'            => 'sometimes|nullable|numeric',

            // supplier fields
            'location'        => 'sometimes|nullable|string|max:255',
            'delivery_radius' => 'sometimes|nullable|numeric',

            // both roles may set or change company
            'company_name'    => 'sometimes|nullable|string|max:255',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 422);
        }

        // company
        $companyId = $user->company_id;
        if ($request->filled('company_name')) {
            $company = Company::firstOrCreate(['name' => Str::lower($request->company_name)]);
            $companyId = $company->id;
        }

        // profile image
        $profileImagePath = $user->profile_image;
        if ($request->hasFile('profile_image') && $request->file('profile_image')->isValid()) {
            if ($profileImagePath) {
                $old = str_replace('storage/', '', $profileImagePath);
                Storage::disk('public')->delete($old);
            }
            $stored = $request->file('profile_image')->store('profile_images', 'public');
            $profileImagePath = 'storage/' . $stored;
        }

        // payload
        $data = [
            'name'            => $request->input('name', $user->name),
            'email'           => $request->input('email', $user->email),
            'contact_name'    => $request->input('contact_name', $user->contact_name),
            'contact_number'  => $request->input('contact_number', $user->contact_number),
            'profile_image'   => $profileImagePath,
            'company_id'      => $companyId,
        ];

        if ($user->role === 'client') {
            $data += [
                'shipping_address'=> $request->input('shipping_address', $user->shipping_address),
                'billing_address' => $request->input('billing_address', $user->billing_address),
                'lat'             => $request->input('lat', $user->lat),
                'long'            => $request->input('long', $user->long),
            ];
        }

        if ($user->role === 'supplier') {
            $data += [
                'location'        => $request->input('location', $user->location),
                'delivery_radius' => $request->input('delivery_radius', $user->delivery_radius),
            ];
        }

        $user->update($data);

        return response()->json([
            'message' => 'Profile updated',
            'user'    => $user->fresh((['company'])),
        ], 200);
    }

    /**
     * Change password.
     * Required: current_password, new_password, new_password_confirmation
     */
    public function changePassword(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'current_password'        => 'required|string',
            'new_password'            => 'required|string|min:6|confirmed',
            // field name must be new_password_confirmation
        ], [
            'new_password.confirmed' => 'New password confirmation does not match.',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 422);
        }

        $user = Auth::user();

        if (!Hash::check($request->current_password, $user->password)) {
            return response()->json(['error' => ['current_password' => ['Current password is incorrect.']]], 400);
        }

        $user->password = Hash::make($request->new_password);
        $user->save();

        // Optional: rotate token on password change
        $request->user()->tokens()->delete();
        $newToken = $user->createToken('UserApp')->plainTextToken;

        return response()->json([
            'message' => 'Password updated',
            'token'   => $newToken,
        ], 200);
    }
    
    
    public function dataHanlde(Request $request)
    {
        // Loop through each user from the request
        foreach ($request->all() as $user) {
            // Generate client_public_id based on the count of users in the database
            $client_public_id = 'MC-' . str_pad(User::count() + 440, 3, '0', STR_PAD_LEFT);
    
            // Prepare user data to insert into the users table
            $userData = [
                'name' => $user['name'],
                'contact_name' => $user['contact_name'],
                'email' => isset($user['email']) ? $user['email'] : null, // Use email if provided, otherwise set to null
                'password' => Hash::make('password'), // Use Hash::make to securely hash the password
                'status' => 'active',
                'client_public_id' => $client_public_id,
                'role' => 'supplier',
                'company_id' => $user['company_id'], // Use the company_id from the request
            ];
    
            // Create a new user record
            User::create($userData);
        }
    
        return response()->json(['message' => 'Users have been successfully added!']);
    }


public function deliveryZonesManagementWithLatLong(Request $request)
{
    // Google Maps API Key
    $googleMapsApiKey = "AIzaSyAUjFL6wmCy8ETAqV1bhFRUEySaUAAX2_k"; // Store your Google Maps API Key in .env file

    // Validate the request
    $validator = Validator::make($request->all(), [
        'zones' => 'sometimes|array',
        'zones.*.user_id' => 'required|exists:users,id', // Ensure the user_id exists in users table
        'zones.*.address' => 'sometimes|string|max:255',
        'zones.*.radius' => 'sometimes|numeric',
    ]);

    if ($validator->fails()) {
        return response()->json(['error' => $validator->errors()], 400);
    }

    // Check if zones are provided, otherwise clear the delivery zones
    if (!$request->zones || count($request->zones) === 0) {
        return response()->json(['message' => 'No zones provided'], 400);
    }

    // Initialize an array to collect zones by user_id
    $userZones = [];

    // Loop through each zone and get latitude and longitude using Google Maps API
    foreach ($request->zones as $zone) {
        // Google Maps Geocoding API request
        $response = Http::get('https://maps.googleapis.com/maps/api/geocode/json', [
            'address' => $zone['address'],
            'key' => $googleMapsApiKey,
        ]);

        // Check if the response is successful
        if ($response->successful()) {
            $result = $response->json()['results'][0] ?? null;

            if ($result) {
                // Extract latitude and longitude from the response
                $lat = $result['geometry']['location']['lat'];
                $long = $result['geometry']['location']['lng'];

                // Create the zone data with lat, long, and radius
                $zoneData = [
                    'address' => $zone['address'],
                    'lat' => $lat,
                    'long' => $long,
                    'radius' => $zone['radius'],
                ];

                // Append the zone to the user's zones collection
                if (!isset($userZones[$zone['user_id']])) {
                    $userZones[$zone['user_id']] = [];
                }
                $userZones[$zone['user_id']][] = $zoneData;
            }
        }
    }

    // Now update each user with their corresponding zones
    foreach ($userZones as $userId => $zones) {
        // Find the user by user_id
        $user = DB::table('users')->where('id', $userId)->first();

        if (!$user) {
            return response()->json(['error' => 'Supplier not found for user_id ' . $userId], 404);
        }

        // Check if the user already has zones, and merge new zones if needed
        $existingZones = json_decode($user->delivery_zones, true) ?? [];

        // Merge the existing zones with the new ones
        $mergedZones = array_merge($existingZones, $zones);

        // Update the delivery_zones for the user
        DB::table('users')
            ->where('id', $userId)
            ->update(['delivery_zones' => json_encode($mergedZones)]);
    }

    return response()->json(['message' => 'Delivery zones updated successfully']);
}

}


------------------------------------------------------------
FILE: app/Http/Controllers/AuthController.php
------------------------------------------------------------
<?php
//To be deleted
namespace App\Http\Controllers;

use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Log;

class AuthController extends Controller
{
    public function registerAdmin(Request $request)
    {
        
        $data = $request->validate([
            'name'     => 'required|string|max:120',
            'email'    => 'required|email|max:120|unique:users,email',
            'password' => 'required|string|min:8|confirmed',
        ]);

        $user = User::create([
            'name'     => $data['name'],
            'email'    => $data['email'],
            'password' => Hash::make($data['password']),   // <-- hashed here
            'role'     => 'admin',
        ]);

        Auth::login($user);

        return response()->json(['message' => 'Admin registered successfully'], 201);

        // return redirect()->route('dashboard')->with('success', 'Admin registered successfully');
    }


    // Register (client only)
    public function register(Request $request)
    {
        $data = $request->validate([
            'name'           => 'required|string|max:120',
            'email'          => 'required|email|max:120|unique:users,email',
            'password'       => 'required|string|min:8|confirmed',
            'company_name'   => 'nullable|string|max:120',
            'contact_name'   => 'nullable|string|max:100',
            'contact_number' => 'nullable|string|max:20',
            'shipping_address' => 'nullable|string|max:255',
            'delivery_address' => 'nullable|string|max:255',
        ]);
        // dd($data);

        $user = User::create([
            'name'           => $data['name'],
            'email'          => $data['email'],
            'password'       => Hash::make($data['password']),   // <-- hashed here
            'role'           => 'client',
            'company_name'   => $data['company_name'] ?? null,
            'contact_name'   => $data['contact_name'] ?? null,
            'contact_number' => $data['contact_number'] ?? null,
            'shipping_address' => $data['shipping_address'] ?? null,
            'delivery_address' => $data['delivery_address'] ?? null,
            'status'         => 'Active', // Default status
        ]);

        Auth::login($user);
        // dd($user);
        return redirect()->route('dashboard')->with('success', 'Registered successfully');
    }

    // Login
  public function login(Request $request){
        $credentials = $request->validate([
            'email' => 'required|email',
            'password' => 'required',
        ]);

        if (Auth::attempt($credentials)) {
            $request->session()->regenerate();
            

            
            return redirect()->intended('/dashboard');
        }

        return back()->withErrors([
            'email' => 'Invalid credentials.',
        ]);
    }


    // Logout
    public function logout(Request $request)
    {
        Auth::logout();
        $request->session()->invalidate();
        $request->session()->regenerateToken();
        return redirect('/');
    }

    //dashboard
    public function dashboard()
    {
        
        return view('dashboard');
    }
}


------------------------------------------------------------
FILE: app/Http/Controllers/Controller.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

abstract class Controller
{
    //
}


------------------------------------------------------------
FILE: app/Http/Controllers/OrderController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use App\Models\Orders;
use App\Models\MasterProducts;
use App\Models\SupplierOffers;
use App\Models\OrderItem;
use App\Models\Projects;
use Illuminate\Support\Facades\DB;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Validator;

class OrderController extends Controller
{
    /**
     * Create a new order with multiple products.
     */
    public function createOrder(Request $request)
    {
        $v = Validator::make($request->all(), [
            'po_number'        => 'nullable|unique:orders,po_number|string|max:50',
            'project_id'       => 'required|exists:projects,id',
            'delivery_address' => 'required|string',
            'delivery_lat'     => 'required|numeric',
            'delivery_long'    => 'required|numeric',
            'delivery_date'    => 'required|date',
            'delivery_time'    => 'nullable|date_format:H:i',
            // 'delivery_method'  => 'in:Other,Tipper,Agitator,Pump,Ute',
            'load_size'        => 'nullable|string|max:50',
            'special_equipment'=> 'nullable|string|max:255',
            'items'            => 'required|array|min:1',
            'items.*.product_id'       => 'required|exists:master_products,id',
            'items.*.quantity'         => 'required|numeric|min:0.01',
            'items.*.custom_blend_mix' => 'nullable|string',
            'repeat_order'     => 'nullable|boolean',
            'special_notes'    => 'nullable|string|max:1000',
        ]);

        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }

        $user = Auth::user();

        return DB::transaction(function () use ($request, $user) {
            // 1) Create order
            /** @var Orders $order */
            $order = Orders::create([
                'po_number'        => $request->po_number,
                'client_id'        => $user->id,
                'project_id'       => $request->project_id,
                'delivery_address' => $request->delivery_address,
                'delivery_lat'     => $request->delivery_lat,
                'delivery_long'    => $request->delivery_long,
                'delivery_date'    => $request->delivery_date,
                'delivery_time'    => $request->delivery_time,
                // 'delivery_method'  => $request->delivery_method,
                'load_size'        => $request->load_size,
                'special_equipment'=> $request->special_equipment,
                // monetary fields start at zero; youll roll them up later
                'other_charges'    => 0,
                'gst_tax'          => 0,
                'discount'         => 0,
                'total_price'      => 0,
                'supplier_item_cost'    => 0,
                'customer_item_cost'    => 0,
                'customer_delivery_cost'    => 0,
                'supplier_delivery_cost'    => 0,
                // initial states per spec
                'payment_status'   => 'Pending',
                'order_status'     => 'Draft',
                'order_process'    => 'Automated',
                'generate_invoice' => 0,
                'repeat_order'     => $request->repeat_order ? $request->repeat_order : 0,
                'special_notes'    => $request->special_notes ?? null,
                // add 'workflow' column in your table if not present yet
            ]);

            $lat = (float) $order->delivery_lat;
            $lng = (float) $order->delivery_long;

            // 2) Preload candidate offers for all requested product_ids
            $productIds = collect($request->items)->pluck('product_id')->unique()->values();
            // dd($productIds);
            $offers = SupplierOffers::with(['supplier:id,delivery_zones'])
                ->whereIn('master_product_id', $productIds)   // adjust column name if different
                ->where('status', 'Approved')                     // only approved offers
                ->whereIn('availability_status', ['In Stock', 'Limited'])                       // optional filter if you have it
                ->get()
                ->groupBy('master_product_id');
            $anyMissingSupplier = false;
            // dd($offers);
            // 3) Create items with nearest in-zone supplier if available
            foreach ($request->items as $row) {
                $pid   = (int) $row['product_id'];
                $qty   = (float) $row['quantity'];
                $blend = $row['custom_blend_mix'] ?? null;

                [$chosenOffer, $distanceKm] = $this->pickNearestOfferInZone(
                    $offers->get($pid) ?? collect(), $lat, $lng
                );

                if ($chosenOffer) {
                    $order->items()->create([
                        'product_id'             => $pid,
                        'quantity'               => $qty,
                        'supplier_id'            => $chosenOffer->supplier_id,
                        'custom_blend_mix'       => $blend,
                        'supplier_unit_cost'     => (float) ($chosenOffer->unit_cost ?? $chosenOffer->price ?? 0),
                        'supplier_delivery_cost' => (float) ($chosenOffer->delivery_cost ?? 0),
                        'supplier_delivery_date' => $order->delivery_date,
                        'choosen_offer_id'      => $chosenOffer->id,
                        'supplier_confirms'      => 0,
                    ]);
                } else {
                    $anyMissingSupplier = true;

                    $order->items()->create([
                        'product_id'             => $pid,
                        'quantity'               => $qty,
                        'supplier_id'            => null,
                        'custom_blend_mix'       => $blend,
                        'supplier_unit_cost'     => 0,
                        'supplier_delivery_cost' => 0,
                        'supplier_delivery_date' => $order->delivery_date,
                        'supplier_confirms'      => 0,
                    ]);
                }
            }

            // 4) Update workflow + order_process if any item unassigned
            if ($anyMissingSupplier) {
                $order->workflow      = 'Supplier Missing';
                $order->order_process = 'Action Required';
                $order->save();
            } else {
                // all items assigned to a supplier
                $order->workflow      = 'Supplier Assigned';
                $order->order_process = 'Automated';
                $order->save();
                // $this->workflow($order);
            }

            // Optionally eager-load for response
            $order->load(['items.product','items.supplier']);

            return response()->json([
                'message' => 'Order created',
                'order'   => $order
            ], 201);
        });
    }

    // Helper function | Workflow 
    private function workflow(Orders $order)
    {
        $currentWorkflow = $order->workflow;

        switch ($currentWorkflow) {
            case 'Supplier Assigned':
                $allConfirmed = $order->items()->where('supplier_confirms', false)->count() === 0;
                if ($allConfirmed) {
                    // Calculate pricing
                    $subtotal = 0;
                    $supplierCost = 0;
                    $adminMarginPercentage = 0.50; // 50% admin margin
                    $deliveryCost = 0;
                    $fuelLevy = 0;
                    $itemCostWithMargin= 0;
                    $adminMarginAmount = 0;
                    
                    foreach ($order->items as $item) {
                        // Calculate item cost excluding delivery
                        $itemCost = ($item->supplier_unit_cost * $item->quantity) - $item->supplier_discount;
                        
                        // Add admin margin to item cost (50% on top of item cost)
                        $itemCostWithMargin = $itemCost + ($itemCost * $adminMarginPercentage);
                        
                        $subtotal += $itemCostWithMargin;
                        $supplierCost += $itemCost; // Supplier cost without admin margin
                        $deliveryCost += $item->supplier_delivery_cost;
                    }
                   
                    
                    // Calculate fuel levy (10% on delivery cost as per your example)
                    $fuelLevy = $deliveryCost + ($deliveryCost * 0.10);
                    //  dd($subtotal,$fuelLevy);
                    
                    // Calculate GST (10% on subtotal)
                    $gstTax = $subtotal * 0.10;
                    
                    // Calculate total price
                    $totalPrice = $subtotal + $gstTax + $fuelLevy - $order->discount + $order->other_charges;
                    
                    // Calculate actual admin margin amount (for tracking)
                    $adminMarginAmount = $subtotal * $adminMarginPercentage;

                    // Update order pricing fields
                    $order->subtotal = $subtotal;
                    $order->fuel_levy = $fuelLevy;
                    $order->gst_tax = $gstTax;
                    $order->total_price = $totalPrice;
                    $order->supplier_cost = $supplierCost + $deliveryCost; // Total supplier cost including delivery
                    $order->customer_cost = $totalPrice;
                    $order->admin_margin = $adminMarginAmount; // The actual margin amount
                    $order->workflow = 'Payment Requested';
                    $order->save();
                }
                break;
        }
    }


    /**
     * Pick nearest offer whose supplier has a delivery zone covering the point.
     * Zones format expected on users.delivery_zones: JSON array of
     * [{ "lat": <float>, "long": <float>, "radius": <km as number>, "address": "..." }, ...]
     * Returns [SupplierOffers|null, float distanceKm]
     */
    private function pickNearestOfferInZone($offersForProduct, float $lat, float $lng): array
    {
        // dd( $offersForProduct, $lat, $lng);
        $bestOffer = null;
        $bestDist  = PHP_FLOAT_MAX;

        foreach ($offersForProduct as $offer) {
            $supplier = $offer->supplier;
            if (!$supplier || empty($supplier->delivery_zones)) {
                continue;
            }

            $zones = is_string($supplier->delivery_zones)
                ? json_decode($supplier->delivery_zones, true)
                : $supplier->delivery_zones;
            // dd($zones);

            if (!is_array($zones)) {
                continue;
            }

            foreach ($zones as $z) {
                if (!isset($z['lat'], $z['long'], $z['radius'])) {
                    continue;
                }
                $distKm = $this->haversineKm($lat, $lng, (float)$z['lat'], (float)$z['long']);
                
                if ($distKm <= (float)$z['radius']) {
                    // dd($distKm, $bestDist);
                    // inside this zone
                    if ($distKm < $bestDist) {
                        $bestDist  = $distKm;
                        $bestOffer = $offer;
                    }
                }
            }
        }

        return [$bestOffer, $bestOffer ? $bestDist : INF];
    }

    private function haversineKm(float $lat1, float $lon1, float $lat2, float $lon2): float
    {
        $R = 6371.0088; // mean Earth radius in km
        $dLat = deg2rad($lat2 - $lat1);
        $dLon = deg2rad($lon2 - $lon1);
        $a = sin($dLat/2) * sin($dLat/2)
           + cos(deg2rad($lat1)) * cos(deg2rad($lat2))
           * sin($dLon/2) * sin($dLon/2);
        $c = 2 * atan2(sqrt($a), sqrt(1-$a));
        return $R * $c;
    }


    public function getClientProducts(Request $request)
    {
        // $user    = Auth::user();
        $perPage = (int) $request->integer('per_page', 10);
        $page    = (int) $request->integer('page', 1);

        // aggregate approved, available offers per product (scoped to this client's suppliers)
        $offersAgg = SupplierOffers::query()
            ->select('supplier_offers.master_product_id')
            ->selectRaw('MIN(supplier_offers.price) AS price_min')
            ->selectRaw('MAX(supplier_offers.price) AS price_max')
            ->join('users as suppliers', 'suppliers.id', '=', 'supplier_offers.supplier_id')
            // ->where('suppliers.client_id', $user->id)
            ->where('supplier_offers.status', 'Approved')
            ->whereIn('supplier_offers.availability_status', ['In Stock', 'Limited'])
            ->groupBy('supplier_offers.master_product_id');

        $query = MasterProducts::query()
            ->joinSub($offersAgg, 'oa', function ($join) {
                $join->on('oa.master_product_id', '=', 'master_products.id');
            })
            ->select('master_products.*', 'oa.price_min', 'oa.price_max');

        // search by product_name
        if ($search = trim((string) $request->get('search'))) {
            $query->where('master_products.product_name', 'like', "%{$search}%");
        }

        // filter by category_id
        if ($request->filled('category')) {
            $query->where('master_products.category', $request->get('category'));
        }

        // sort
        if ($request->get('sort') === 'price') {
            $query->orderBy('oa.price_min', 'asc');
        } else {
            $query->orderBy('master_products.product_name', 'asc');
        }

        $products = $query->with('category')->paginate($perPage, ['*'], 'page', $page);

        $products->getCollection()->transform(function ($p) {
            $p->price = ($p->price_min == $p->price_max)
                ? sprintf('$%.2f', $p->price_min)
                : sprintf('$%.2f - $%.2f', $p->price_min, $p->price_max);
            return $p;
        });

        return response()->json([
            'data' => $products->items(),
            'meta' => [
                'current_page' => $products->currentPage(),
                'per_page'     => $products->perPage(),
                'total'        => $products->total(),
                'last_page'    => $products->lastPage(),
            ],
        ]);
    }

    public function getClientProductDetails($id)
    {
        // dd($id);
        // $user = Auth::user();

        $product = MasterProducts::with('category')->find($id);
        if (!$product) {
            return response()->json(['error' => 'Product not found'], 404);
        }

        // fetch approved, available offers for this product (scoped to this client's suppliers)
        $offers = SupplierOffers::with(['supplier:id,company_name,delivery_zones'])
            ->where('master_product_id', $product->id)
            // ->whereHas('supplier', function ($q) use ($user) {
            //     $q->where('client_id', $user->id);
            // })
            ->where('status', 'Approved')
            ->whereIn('availability_status', ['In Stock', 'Limited'])
            ->orderBy('price', 'asc')
            ->get();

        return response()->json($product);
    }

    //Get my orders
    // public function getMyOrders(Request $request)
    // {
    //     $user = Auth::user();

    //     $details = filter_var($request->get('details', false), FILTER_VALIDATE_BOOLEAN);

    //     $perPage = (int) $request->get('per_page', 10);
    //     $search  = trim((string) $request->get('search', ''));
    //     $sort    = $request->get('sort', 'created_at');
    //     $dir     = strtolower($request->get('dir', 'desc')) === 'asc' ? 'asc' : 'desc';
    //     $delivery_date = $request->get('delivery_date');
    //     $project_id    = $request->get('project_id');
    //     $workflow      = $request->get('workflow');
    //     $order_status = $request->get('order_status');
    //     $repeat_order   = null;
    //     if($request->has('repeat_order')) {
    //         $repeat_order = $request->get('repeat_order');
    //         if($repeat_order === 'true' || $repeat_order === '1') {
    //             $repeat_order = true;
    //         } elseif($repeat_order === 'false' || $repeat_order === '0') {
    //             $repeat_order = false;
    //         } else {
    //             $repeat_order = null; // invalid value, ignore filter
    //         }
    //     } else {
    //         $repeat_order = null;
    //     }

    //     $query = Orders::with(['project','items.product','items.supplier'])
    //         ->where('client_id', $user->id);

    //     if ($search !== '')        $query->where('po_number', 'like', "%{$search}%");
    //     if ($delivery_date)        $query->whereDate('delivery_date', $delivery_date);
    //     if ($project_id)           $query->where('project_id', $project_id);
    //     if ($workflow)             $query->where('workflow', $workflow);
    //     if ($repeat_order !== null) $query->where('repeat_order', (bool)$repeat_order);
    //     if ($order_status)         $query->where('order_status',$order_status);
    //     // dd($repeat_order);
    //     $allowedSorts = ['po_number','delivery_date','created_at','updated_at'];
    //     if (!in_array($sort, $allowedSorts, true)) $sort = 'created_at';

    //     $orders = $query->orderBy($sort, $dir)->paginate($perPage);

    //     // enrich each order with order_info
    //     $enriched = collect($orders->items())->map(function (Orders $o) {
    //         $missing = $o->items->whereNull('supplier_id');
    //         if ($o->workflow === 'Supplier Missing') {
    //             $missingNames = $missing->map(fn($it) => optional($it->product)->product_name)
    //                                     ->filter()->unique()->values()->all();
    //             $o->order_info = 'Supplier missing for: ' . implode(', ', $missingNames);
    //         } elseif ($o->workflow === 'Supplier Assigned') {
    //             $o->order_info = 'Waiting for suppliers to confirm';
    //         } elseif ($o->workflow === 'Payment Requested') {
    //             $o->order_info = 'Awaiting your payment';
    //         } else {
    //             $o->order_info = null;
    //         }
    //         return $o;
    //     })->values()->all();

    //     $base = Orders::where('client_id', $user->id);
    //     $metrics = [
    //         'total_orders_count'      => (clone $base)->count(),
    //         'supplier_missing_count'  => (clone $base)->where('workflow', 'Supplier Missing')->count(),
    //         'supplier_assigned_count' => (clone $base)->where('workflow', 'Supplier Assigned')->count(),
    //         'awaiting_payment_count'  => (clone $base)->where('workflow', 'Payment Requested')->count(),
    //         'delivered_count'         => (clone $base)->where('workflow', 'Delivered')->count(),
    //     ];

    //     $response = [
    //         'data' => $enriched,
    //         'pagination' => [
    //             'per_page' => $orders->perPage(),
    //             'current_page' => $orders->currentPage(),
    //             'total_pages' => $orders->lastPage(),
    //             'total_items' => $orders->total(),
    //             'has_more_pages' => $orders->hasMorePages(),
    //         ],
    //         'metrics' => $metrics,
    //     ];

    //     if ($details) {
    //         $projects = Projects::where('added_by', $user->id)
    //             ->orderBy('created_at','desc')
    //             ->get(['id','name']);
    //         $response['projects'] = $projects;
    //     }

    //     return response()->json($response);
    // }
    public function getMyOrders(Request $request)
    {
        $user = Auth::user();

        $details = filter_var($request->get('details', false), FILTER_VALIDATE_BOOLEAN);

        $perPage = (int) $request->get('per_page', 10);
        $search  = trim((string) $request->get('search', ''));
        $sort    = $request->get('sort', 'created_at');
        $dir     = strtolower($request->get('dir', 'desc')) === 'asc' ? 'asc' : 'desc';
        $delivery_date = $request->get('delivery_date');
        $project_id    = $request->get('project_id');
        $order_status  = $request->get('order_status');
        $payment_status = $request->get('payment_status');
        $delivery_method = $request->get('delivery_method');
        
        $repeat_order   = null;
        if($request->has('repeat_order')) {
            $repeat_order = $request->get('repeat_order');
            if($repeat_order === 'true' || $repeat_order === '1') {
                $repeat_order = true;
            } elseif($repeat_order === 'false' || $repeat_order === '0') {
                $repeat_order = false;
            } else {
                $repeat_order = null;
            }
        }

        $query = Orders::with(['project','items.product'])
            ->where('client_id', $user->id);

        if ($search !== '')         $query->where('po_number', 'like', "%{$search}%");
        if ($delivery_date)         $query->whereDate('delivery_date', $delivery_date);
        if ($project_id)            $query->where('project_id', $project_id);
        if ($order_status)          $query->where('order_status', $order_status);
        if ($payment_status)        $query->where('payment_status', $payment_status);
        if ($delivery_method)       $query->where('delivery_method', $delivery_method);
        if ($repeat_order !== null) $query->where('repeat_order', (bool)$repeat_order);

        $allowedSorts = ['po_number','delivery_date','total_price','created_at','updated_at'];
        if (!in_array($sort, $allowedSorts, true)) $sort = 'created_at';

        $orders = $query->orderBy($sort, $dir)->paginate($perPage);

        $enriched = collect($orders->items())->map(function (Orders $o) {
            if ($o->order_status === 'Draft') {
                $o->order_info = 'Order draft created';
            } elseif ($o->order_status === 'Confirmed') {
                $o->order_info = 'Order confirmed, awaiting schedule';
            } elseif ($o->order_status === 'Scheduled') {
                $o->order_info = 'Order scheduled for delivery';
            } elseif ($o->order_status === 'In Transit') {
                $o->order_info = 'Order in transit';
            } elseif ($o->order_status === 'Delivered') {
                $o->order_info = 'Order delivered';
            } elseif ($o->order_status === 'Completed') {
                $o->order_info = 'Order completed';
            } elseif ($o->order_status === 'Cancelled') {
                $o->order_info = 'Order cancelled';
            } elseif ($o->payment_status === 'Unpaid' || $o->payment_status === 'Requested') {
                $o->order_info = 'Payment required';
            } else {
                $o->order_info = null;
            }
            return $o;
        })->values()->all();

        $base = Orders::where('client_id', $user->id);
        $metrics = [
            'total_orders_count'   => (clone $base)->count(),
            'draft_count'          => (clone $base)->where('order_status', 'Draft')->count(),
            'confirmed_count'      => (clone $base)->where('order_status', 'Confirmed')->count(),
            'scheduled_count'      => (clone $base)->where('order_status', 'Scheduled')->count(),
            'in_transit_count'     => (clone $base)->where('order_status', 'In Transit')->count(),
            'delivered_count'      => (clone $base)->where('order_status', 'Delivered')->count(),
            'completed_count'      => (clone $base)->where('order_status', 'Completed')->count(),
            'cancelled_count'      => (clone $base)->where('order_status', 'Cancelled')->count(),
        ];

        $response = [
            'data' => $enriched,
            'pagination' => [
                'per_page' => $orders->perPage(),
                'current_page' => $orders->currentPage(),
                'total_pages' => $orders->lastPage(),
                'total_items' => $orders->total(),
                'has_more_pages' => $orders->hasMorePages(),
            ],
            'metrics' => $metrics,
        ];

        if ($details) {
            $projects = Projects::where('added_by', $user->id)
                ->orderBy('created_at','desc')
                ->get(['id','name']);
            
            $response['projects'] = $projects;
            $response['order_statuses'] = ['Draft', 'Confirmed', 'Scheduled', 'In Transit', 'Delivered', 'Completed', 'Cancelled'];
            $response['payment_statuses'] = ['Unpaid', 'Partially Paid', 'Paid'];
            $response['delivery_methods'] = ['Tipper', 'Agitator', 'Pump', 'Ute', 'Other'];
        }

        return response()->json($response);
    }


    /**
     * Client view. If workflow = Supplier Missing, include eligible suppliers per missing item.
     */
    public function viewMyOrder(Orders $order)
    {
        abort_unless($order->client_id === Auth::id(), 403);

        $order->load(['project','items.product','items.supplier']);

        $missing = $order->items->whereNull('supplier_id');
            if ($order->workflow === 'Supplier Missing') {
                $missingNames = $missing->map(fn($it) => optional($it->product)->product_name)
                                        ->filter()->unique()->values()->all();
                $order->order_info = 'Supplier missing for: ' . implode(', ', $missingNames);
            } elseif ($order->workflow === 'Supplier Assigned') {
                $order->order_info = 'Waiting for suppliers to confirm';
            } elseif ($order->workflow === 'Payment Requested') {
                $order->order_info = 'Awaiting your payment';
            } else {
                $order->order_info = null;
            }

        $orderData = $order->only([
            'id','po_number','project_id','client_id','workflow','delivery_address','order_status',
            'delivery_date','delivery_time','delivery_method','repeat_order','customer_item_cost','payment_status','customer_delivery_cost','discount','other_charges','gst_tax','total_price','reason','created_at','updated_at'
        ]);
        
        $order->items->each(function (OrderItem $item) use ($order) {
            $item->supplier_unit_cost = (((float) $item->supplier_unit_cost - (float)$item->supplier_discount)/2) + (float) $item->supplier_unit_cost ;
        });

        $orderData['project'] = optional($order->project)?->only(['id','name','site_contact_name','site_contact_phone','site_instructions']);
        $orderData['order_info'] = $order->order_info;
        return response()->json([
            'success' => true,
            'data' => [
                'order' => $orderData,
                'items' => $order->items,
            ],
        ]);
    }


    /**
     * Assign a supplier to a specific order item and advance workflow if all assigned.
     * Body: { "supplier_id": <int> }
     */
    public function assignSupplier(Request $request, OrderItem $item)
    {
        $v = Validator::make($request->all(), ['supplier_id' => 'required|exists:users,id']);
        if ($v->fails()) return response()->json(['error'=>$v->errors()], 422);

        $order = $item->order()->with('items')->first();
        abort_unless($order && $order->client_id === Auth::id(), 403);

        $supplierId = (int) $request->supplier_id;

        $chosenOffer = SupplierOffers::with('supplier:id,delivery_zones')
            ->where('supplier_id', $supplierId)
            ->where('master_product_id', $item->product_id)
            ->where('status', 'Approved')
            ->whereIn('availability_status', ['In Stock','Limited'])
            ->whereHas('supplier', fn($q) => $q->whereJsonLength('delivery_zones','>=',1))
            ->first();

        if (!$chosenOffer) {
            return response()->json(['error' => 'No valid offer with delivery zones for this product'], 422);
        }

        $item->update([
            'supplier_id'             => $chosenOffer->supplier_id,
            'choosen_offer_id'        => $chosenOffer->id,
            'supplier_unit_cost'      => (float) ($chosenOffer->unit_cost ?? $chosenOffer->price ?? 0),
            'supplier_delivery_cost'  => (float) ($chosenOffer->delivery_cost ?? 0),
            'supplier_delivery_date'  => $order->delivery_date,
            'supplier_confirms'       => false,
        ]);

        if ($order->items()->whereNull('supplier_id')->count() === 0) {
            $order->update(['workflow' => 'Supplier Assigned', 'order_process' => 'Automated']);
        }

        return response()->json([
            'success' => true,
            'message' => 'Supplier assigned',
            'order_workflow' => $order->workflow,
            'item' => $item->fresh(['product','supplier','chosenOffer']),
        ]);
    }



    /**
     * Mark or unmark an order as repeat order.
     */    
    public function markRepeatOrder(Orders $order, Request $request)
    {
        abort_unless($order->client_id === Auth::id(), 403);
        $order->repeat_order = true;
        $order->save();
        return response()->json([
            'success' => true,
            'message' => 'Order marked as repeat order',
            'order'   => $order->only(['id','repeat_order']),
        ]); 
    }

    
    public function reorderFromProject(Request $request)
    {
        $v = Validator::make($request->all(), [
            'project_id'       => 'required|exists:projects,id',
            'product_id'       => 'required|exists:master_products,id',
            'order_item_id'    => 'required|exists:order_items,id', // NEW
            'quantity'         => 'required|numeric|min:0.01',
            'po_number'        => 'nullable|unique:orders,po_number|string|max:50',
            'delivery_date'    => 'required|date',
            'delivery_time'    => 'nullable|date_format:H:i',
            'delivery_method'  => 'nullable|in:Other,Tipper,Agitator,Pump,Ute',
            'special_notes'    => 'nullable|string|max:1000',
            'custom_blend_mix' => 'nullable|string',
        ]);

        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }

        $user = Auth::user();

        // Verify project belongs to user
        $project = Projects::where('id', $request->project_id)
            ->where('added_by', $user->id)
            ->first();

        if (!$project) {
            return response()->json(['error' => 'Project not found or unauthorized'], 404);
        }

        // Find template item and ensure it belongs to this client's project
        /** @var \App\Models\OrderItem|null $templateItem */
        $templateItem = OrderItem::where('id', $request->order_item_id)
            ->whereHas('order', function ($q) use ($user, $project) {
                $q->where('client_id', $user->id)
                ->where('project_id', $project->id);
            })
            ->first();

        if (!$templateItem) {
            return response()->json(['error' => 'Order item not found for this project'], 404);
        }

        return DB::transaction(function () use ($request, $user, $project, $templateItem) {
            // 1) Create order
            /** @var Orders $order */
            $order = Orders::create([
                'po_number'              => $request->po_number,
                'client_id'              => $user->id,
                'project_id'             => $request->project_id,
                'delivery_address'       => $project->delivery_address,
                'delivery_lat'           => $project->delivery_lat,
                'delivery_long'          => $project->delivery_long,
                'delivery_date'          => $request->delivery_date,
                'delivery_time'          => $request->delivery_time,
                'delivery_method'        => $request->delivery_method ?? 'Other',
                'load_size'              => null,
                'special_equipment'      => null,
                'other_charges'          => 0,
                'gst_tax'                => 0,
                'discount'               => 0,
                'total_price'            => 0,
                'supplier_item_cost'     => 0,
                'customer_item_cost'     => 0,
                'customer_delivery_cost' => 0,
                'supplier_delivery_cost' => 0,
                'payment_status'         => 'Pending',
                'order_status'           => 'Draft',
                'order_process'          => 'Automated',
                'generate_invoice'       => 0,
                'repeat_order'           => 1,
                'special_notes'          => $request->special_notes,
            ]);

            // 2) Create order item by COPYING pricing from template item
            $qty = (float) $request->quantity;

            $order->items()->create([
                'product_id'             => $request->product_id, // should match $templateItem->product_id
                'quantity'               => $qty,

                // copy supplier + offer
                'supplier_id'            => $templateItem->supplier_id,
                'choosen_offer_id'       => $templateItem->choosen_offer_id,

                // copy pricing
                'supplier_unit_cost'     => $templateItem->supplier_unit_cost,
                'supplier_delivery_cost' => $templateItem->supplier_delivery_cost,
                'supplier_discount'      => $templateItem->supplier_discount,

                // quoted logic (if used in your system)
                'is_quoted'              => $templateItem->is_quoted ?? $templateItem->is_qouted,
                'quoted_price'           => $templateItem->quoted_price,

                // copy other attributes
                'custom_blend_mix'       => $request->custom_blend_mix ?? $templateItem->custom_blend_mix,
                'delivery_type'          => $templateItem->delivery_type,
                'delivery_cost'          => $templateItem->delivery_cost,
                'supplier_delivery_date' => $order->delivery_date,

                // IMPORTANT: reset confirmation + payment
                'supplier_confirms'      => 0,
                'is_paid'                => 0,
            ]);

            // 3) Workflow based on whether supplier exists
            if ($templateItem->supplier_id) {
                $order->workflow      = 'Supplier Assigned';
                $order->order_process = 'Automated';
            } else {
                $order->workflow      = 'Supplier Missing';
                $order->order_process = 'Action Required';
            }

            $order->save();

            // If you want to recalc totals using your pricing service:
            // OrderPricingService::recalcCustomer($order, null, null, true);

            $order->load(['items.product', 'items.supplier']);

            return response()->json([
                'message' => 'Order created successfully from project item',
                'order'   => $order,
            ], 201);
        });
    }

        

}




------------------------------------------------------------
FILE: app/Http/Controllers/PaymentController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Stripe\Stripe;
use Stripe\PaymentIntent;
use Stripe\Customer;
use App\Models\Orders;
use App\Models\User;

class PaymentController extends Controller
{
    public function __construct()
    {
        Stripe::setApiKey(env('STRIPE_SECRET'));
    }

    public function processPayment(Request $request)
    {
        $request->validate([
            'payment_method_id' => 'required|string',
            'order_id' => 'required|integer',
        ]);

        $order = Orders::findOrFail($request->order_id);
        $user = auth()->user();

        if ($order->client_id !== $user->id) {
            return response()->json(['error' => 'Unauthorized'], 403);
        }

        if ($order->workflow !== 'Payment Requested') {
            return response()->json(['error' => 'Order not ready for payment'], 400);
        }

        try {
            // Get or create Stripe customer
            $customerId = $this->getOrCreateCustomer($user);

            // Create and confirm payment in one step
            $paymentIntent = PaymentIntent::create([
                'amount' => round($order->total_price * 100),
                'currency' => 'aud',
                'customer' => $customerId,
                'payment_method' => $request->payment_method_id,
                'confirm' => true,
                'automatic_payment_methods' => [
                   'enabled' => true,
                   'allow_redirects' => 'never', // <-- key part
                ],
                'metadata' => [
                    'order_id' => $order->id,
                    'user_id' => $user->id,
                ],
            ]);

            if ($paymentIntent->status === 'succeeded') {
                $order->payment_status = 'Paid';
                $order->workflow = 'Delivered';
                $order->save();

                return response()->json([
                    'success' => true,
                    'message' => 'Payment successful',
                    'order' => [
                        'id' => $order->id,
                        'payment_status' => $order->payment_status,
                        'workflow' => $order->workflow,
                    ]
                ]);
            } else {
                $order->payment_status = 'Failed';
                $order->save();

                return response()->json([
                    'success' => false,
                    'message' => 'Payment failed',
                    'status' => $paymentIntent->status
                ], 400);
            }
        } catch (\Exception $e) {
            return response()->json([
                'success' => false,
                'message' => $e->getMessage()
            ], 500);
        }
    }

    private function getOrCreateCustomer(User $user)
    {
        if ($user->stripe_customer_id) {
            try {
                Customer::retrieve($user->stripe_customer_id);
                return $user->stripe_customer_id;
            } catch (\Exception $e) {
                // Customer doesn't exist, create new one
            }
        }

        $customer = Customer::create([
            'email' => $user->email,
            'name' => $user->name,
            'metadata' => [
                'user_id' => $user->id,
            ],
        ]);

        $user->stripe_customer_id = $customer->id;
        $user->save();

        return $customer->id;
    }
}

------------------------------------------------------------
FILE: app/Http/Controllers/ProjectController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use App\Models\Projects as Project;
use App\Models\Orders;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Validator;
use Illuminate\Validation\Rule;

class ProjectController extends Controller
{
    /**
     * GET /client/projects
     *
     * Project listing for the client, including:
     * - total_orders (count of orders in project)
     * - total_order_amount (sum of order.total_price)
     * - basic filters (search, delivery date range, workflow)
     */
    public function index(Request $request)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        $perPage = (int) $request->get('per_page', 10);
        $search  = trim((string) $request->get('search', ''));
        $sort    = $request->get('sort', 'created_at');
        $dir     = strtolower($request->get('dir', 'desc')) === 'asc' ? 'asc' : 'desc';

        // order filters
        $order_status = $request->get('order_status');                // e.g. "Supplier Missing", "Payment Requested", etc.
        $ddFrom   = $request->get('delivery_date_from');      // Y-m-d
        $ddTo     = $request->get('delivery_date_to');        // Y-m-d

        // Base project query for this client
        $query = Project::query()
            ->where('added_by', $user->id);

        if ($search !== '') {
            $query->where(function ($q) use ($search) {
                $q->where('name', 'like', "%{$search}%")
                  ->orWhere('delivery_address', 'like', "%{$search}%")
                  ->orWhere('site_contact_name', 'like', "%{$search}%");
            });
        }

        // Sort by project fields
        if (!in_array($sort, ['name', 'created_at', 'updated_at'], true)) {
            $sort = 'created_at';
        }

        $paginator = $query->orderBy($sort, $dir)->paginate($perPage);

        // Attach per-project order stats with filters applied
        $userId = $user->id;

        $paginator->getCollection()->transform(function (Project $project) use ($userId, $order_status, $ddFrom, $ddTo) {
            $ordersQuery = $project->orders()
                ->where('client_id', $userId);

            if ($order_status) {
                $ordersQuery->where('order_status', $order_status);
            }
            if ($ddFrom) {
                $ordersQuery->whereDate('delivery_date', '>=', $ddFrom);
            }
            if ($ddTo) {
                $ordersQuery->whereDate('delivery_date', '<=', $ddTo);
            }

            $project->total_orders       = (int) $ordersQuery->count();
            $project->total_order_amount = (float) $ordersQuery->sum('total_price');

            return $project;
        });

        return response()->json([
            'data' => $paginator->items(),
            'meta' => [
                'current_page' => $paginator->currentPage(),
                'per_page'     => $paginator->perPage(),
                'total'        => $paginator->total(),
                'last_page'    => $paginator->lastPage(),
            ],
        ]);
    }

    /**
     * GET /client/projects/{id}
     *
     * View a single project with:
     * - project details
     * - all orders within the project (with filters)
     * - items (products) with consistent pricing per project
     * - analytics
     *
     * NOTE for item pricing:
     *   - if item has `is_quoted == 1`, use `quoted_price` as the price
     *   - otherwise, use `supplier_unit_cost` as the price
     */
    public function projectDetails($id, Request $request)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        /** @var Project|null $project */
        $project = Project::where('id', $id)
            ->where('added_by', $user->id)
            ->first();

        if (!$project) {
            return response()->json(['error' => 'Project not found'], 404);
        }

        // filters for orders inside this project
        $order_status = $request->get('order_status');                // ex: "Supplier Missing"
        $ddFrom   = $request->get('delivery_date_from');      // Y-m-d
        $ddTo     = $request->get('delivery_date_to');        // Y-m-d

        $ordersQuery = $project->orders()
            ->where('client_id', $user->id)
            ->with([
                // FIX: include id + all required product columns
                'items.product:id,product_name,photo,product_type,specifications',
                'items.supplier:id,name',
            ])
            ->orderBy('delivery_date', 'desc')
            ->orderBy('created_at', 'desc');

        if ($order_status) {
            $ordersQuery->where('order_status', $order_status);
        }
        if ($ddFrom) {
            $ordersQuery->whereDate('delivery_date', '>=', $ddFrom);
        }
        if ($ddTo) {
            $ordersQuery->whereDate('delivery_date', '<=', $ddTo);
        }

        /** @var \Illuminate\Support\Collection|\App\Models\Orders[] $orders */
        $orders = $ordersQuery->get();

        // ---- Analytics ----
        $totalOrders = $orders->count();
        $totalAmount = (float) $orders->sum('total_price');

        $byOrderStatus = $orders
            ->groupBy('order_status')
            ->map(fn($group) => $group->count())
            ->toArray();

        $firstOrderDate = optional($orders->min('delivery_date'))->toDateString() ?? null;
        $lastOrderDate  = optional($orders->max('delivery_date'))->toDateString() ?? null;

        $analytics = [
            'total_orders'       => $totalOrders,
            'total_order_amount' => $totalAmount,
            'avg_order_value'    => $totalOrders > 0 ? round($totalAmount / $totalOrders, 2) : 0.0,
            'by_order_status'    => $byOrderStatus,
            'first_order_date'   => $firstOrderDate,
            'last_order_date'    => $lastOrderDate,
        ];

        // ---- Project products with consistent pricing ----
        $allItems = $orders->flatMap(function (Orders $order) {
            return $order->items;
        });

        $projectProducts = $allItems
        ->groupBy('product_id')
        ->map(function ($rows) {
            /** @var \App\Models\OrderItem $first */
            $first = $rows->first();
            $last = $rows->last(); // Get the most recent item for reordering

            // Core rule:
            // if item has quoted price => use quoted_price
            // else => use supplier_unit_cost
            if (!is_null($first->quoted_price) && (int) $first->is_quoted === 1) {
                $unitPrice = (float) $first->quoted_price;
            } else {
                $unitPrice = (float) $first->supplier_unit_cost;
            }

            $deliveryCost = (float) $first->supplier_delivery_cost;

            return [
                'product_id'              => $first->product_id,
                'product_name'            => optional($first->product)->product_name,
                'product_image'           => optional($first->product)->photo,
                'product_type'            => optional($first->product)->product_type,
                'product_specifications'  => optional($first->product)->specifications,
                'unit_price'              => $unitPrice * (1+0.50),
                'delivery_cost'           => $deliveryCost,
                'total_quantity'          => (float) $rows->sum('quantity'),
                'orders_count'            => (int) $rows->pluck('order_id')->unique()->count(),
                'first_order_id'          => $rows->min('order_id'),
                'last_order_id'           => $rows->max('order_id'),
                'last_order_item_id'      => $last->id, // NEW - For reordering with same pricing
            ];
        })
        ->values();

        // ---- Shape orders payload for frontend ----
        $ordersPayload = $orders->map(function (Orders $order) {
            return [
                'id'              => $order->id,
                'po_number'       => $order->po_number,
                'delivery_date'   => $order->delivery_date,
                'delivery_time'   => $order->delivery_time,
                'delivery_method' => $order->delivery_method,
                'order_status'    => $order->order_status,
                'payment_status'  => $order->payment_status,
                'total_price'     => (float) $order->total_price,
                'items'           => $order->items->map(function ($item) {
                    // Apply "quoted vs supplier_unit_cost" rule for display price
                    if (!is_null($item->quoted_price) && (int) $item->is_quoted === 1) {
                        $displayUnitPrice = (float) $item->quoted_price;
                    } else {
                        $displayUnitPrice = (float) $item->supplier_unit_cost;
                    }

                    return [
                        'id'                     => $item->id,
                        'product_id'             => $item->product_id,
                        'product_name'           => optional($item->product)->product_name,
                        'product_image'          => optional($item->product)->photo,
                        'product_type'           => optional($item->product)->product_type,
                        'product_specifications' => optional($item->product)->specifications,
                        'quantity'               => (float) $item->quantity,
                        'is_quoted'              => (int) $item->is_quoted,
                        'quoted_price'           => $item->quoted_price,
                        'supplier_unit_cost'     => $item->supplier_unit_cost,
                        'supplier_delivery_cost' => $item->supplier_delivery_cost,
                        'display_unit_price'     => $displayUnitPrice,
                        'supplier_name'          => optional($item->supplier)->name,
                        'custom_blend_mix'       => $item->custom_blend_mix,
                    ];
                }),
            ];
        });

        return response()->json([
            'project'          => $project,
            'analytics'        => $analytics,
            'orders'           => $ordersPayload,
            'project_products' => $projectProducts,
        ]);
    }

    public function show($id)
    {
        
        $project = Project::find($id);
        if (!$project) {
            return response()->json(['error' => 'Project not found'], 404);
        }
    
        
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        // compare against the FK column
        abort_unless((int) $project->added_by === (int) $user->id, 404, 'Project not found');
        

        $project->load('added_by.company');
        // dd($project);
        return response()->json($project, 200);
    }


    public function store(Request $request)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        $validator = Validator::make($request->all(), [
            'name'               => ['required','string','max:255'],
            'site_contact_name'  => ['nullable','string','max:255'],
            'site_contact_phone' => ['nullable','string','max:50'],
            'site_instructions'  => ['nullable','string'],
            'delivery_address' => 'required|string',
            'delivery_lat'     => 'required|numeric',
            'delivery_long'    => 'required|numeric',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $data = $validator->validated();

        $project = Project::create([
            ...$data,
            'added_by' => $user->id, // lock to this client
        ]);

        return response()->json($project->load('added_by.company'), 201);
    }

    public function update(Request $request, Project $project)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');
        abort_unless($project->added_by === $user->id, 404, 'Project not found');

        $validator = Validator::make($request->all(), [
            'name'               => ['sometimes','required','string','max:255'],
            'site_contact_name'  => ['nullable','string','max:255'],
            'site_contact_phone' => ['nullable','string','max:50'],
            'site_instructions'  => ['nullable','string'],
            'delivery_address' => 'required|string',
            'delivery_lat'     => 'required|numeric',
            'delivery_long'    => 'required|numeric',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $data = $validator->validated();

        // do NOT change added_by
        $project->update($data);

        return response()->json($project->fresh()->load('added_by.company'), 200);
    }
}


------------------------------------------------------------
FILE: app/Http/Controllers/ProjectController2.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use App\Models\Projects as Project; // keep alias if your model is named Projects
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Validator; // added
use Illuminate\Validation\Rule;

class ProjectController extends Controller
{
    // GET /client/projects
    public function index(Request $request)
    {

        $projects= Project::where('added_by', Auth::id())->get();
        return response()->json(['data'=>$projects]);
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        $perPage = (int) $request->get('per_page', 10);
        $search  = trim((string) $request->get('search', ''));
        $sort    = $request->get('sort', 'created_at');
        $dir     = $request->get('dir', 'desc');

        $query = Project::with('added_by.company')
            ->where('added_by', $user->id);

        if ($search !== '') {
            $query->where('name', 'like', "%{$search}%");
        }

        $allowedSorts = ['name','created_at','updated_at'];
        if (!in_array($sort, $allowedSorts, true)) $sort = 'created_at';
        $dir = strtolower($dir) === 'asc' ? 'asc' : 'desc';

        return response()->json(
            $query->orderBy($sort, $dir)->paginate($perPage),
            200
        );
    }

    // GET /client/projects/{project}
    public function show($id)
    {
        
        $project = Project::find($id);
        if (!$project) {
            return response()->json(['error' => 'Project not found'], 404);
        }
    
        
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        // compare against the FK column
        abort_unless((int) $project->added_by === (int) $user->id, 404, 'Project not found');
        

        $project->load('added_by.company');
        // dd($project);
        return response()->json($project, 200);
    }

    // POST /client/projects
    public function store(Request $request)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');

        $validator = Validator::make($request->all(), [
            'name'               => ['required','string','max:255'],
            'site_contact_name'  => ['nullable','string','max:255'],
            'site_contact_phone' => ['nullable','string','max:50'],
            'site_instructions'  => ['nullable','string'],
            'delivery_address' => 'required|string',
            'delivery_lat'     => 'required|numeric',
            'delivery_long'    => 'required|numeric',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $data = $validator->validated();

        $project = Project::create([
            ...$data,
            'added_by' => $user->id, // lock to this client
        ]);

        return response()->json($project->load('added_by.company'), 201);
    }

    // PUT /client/projects/{project}
    public function update(Request $request, Project $project)
    {
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');
        abort_unless($project->added_by === $user->id, 404, 'Project not found');

        $validator = Validator::make($request->all(), [
            'name'               => ['sometimes','required','string','max:255'],
            'site_contact_name'  => ['nullable','string','max:255'],
            'site_contact_phone' => ['nullable','string','max:50'],
            'site_instructions'  => ['nullable','string'],
            'delivery_address' => 'required|string',
            'delivery_lat'     => 'required|numeric',
            'delivery_long'    => 'required|numeric',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $data = $validator->validated();

        // do NOT change added_by
        $project->update($data);

        return response()->json($project->fresh()->load('added_by.company'), 200);
    }

    // DELETE /client/projects/{project}
    public function destroy($id)
    {
        $project = Project::find($id);
        if (!$project) {
            return response()->json(['error' => 'Project not found'], 404);
        }
        
        $user = Auth::user();
        abort_unless($user && $user->role === 'client', 403, 'Forbidden');
        abort_unless($project->added_by === $user->id, 404, 'Project not found');

        $project->delete();
        return response()->json(['message' => 'Project deleted'], 200);
    }
}


------------------------------------------------------------
FILE: app/Http/Controllers/SupplierController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\SupplierOffers;
use App\Models\MasterProducts;
use App\Models\User;
use Illuminate\Support\Facades\Validator;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Str;

class SupplierController extends Controller
{   

    /**
     * Add a product to the supplier's inventory.
     */

    public function deliveryZonesManagement(Request $request)
    {
        // Logic for managing delivery zones
        $validator = Validator::make($request->all(), [
            'zones' => 'sometimes|array',
            'zones.*.lat' => 'sometimes|numeric',
            'zones.*.long' => 'sometimes|numeric',
            'zones.*.radius' => 'sometimes|numeric',
            'zones.*.address' => 'sometimes|string|max:255',
        ]);
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }
        /** @var User $user */
        $user = Auth::user();
        abort_unless($user && $user->role === 'supplier', 403, 'Forbidden');
        if( !$request->zones || $request->zones === null || $request->zones === '' || count($request->zones) === 0){
            $user->delivery_zones = null;
            $user->save();
            return response()->json(['message' => 'Delivery zones cleared', 'delivery_zones' => []], 200);
        }
        $user->delivery_zones = json_encode($request->zones);
        $user->save();
        return response()->json(['message' => 'Delivery zones updated successfully', 'delivery_zones' => $user->delivery_zones], 200);
    }

    public function getDeliveryZones()
    {
        // Get the authenticated user
        $user = Auth::user();

        // Ensure the user exists and is a supplier
        abort_unless($user && $user->role === 'supplier', 403, 'Forbidden');

        // Check if delivery_zones is not set, null, or empty
        if (!$user->delivery_zones || $user->delivery_zones === null || $user->delivery_zones === '') {
            return response()->json(['delivery_zones' => []], 200);
        }

        // Decode the delivery_zones if it is a JSON string
        $decodedZones = json_decode($user->delivery_zones, true);

        // If json_decode fails and the result is null, handle that case
        if (json_last_error() !== JSON_ERROR_NONE) {
            return response()->json(['error' => 'Invalid JSON format in delivery_zones'], 400);
        }

        // Return the decoded delivery_zones
        return response()->json(['delivery_zones' => $decodedZones], 200);
    }


    /**
     * Get Master Product Inventory.
     */
    public function getMasterProductInventory(Request $request)
    {
        $perPage = (int) $request->get('per_page', 10);
        $page = (int) $request->get('page', 1); 
        $query = MasterProducts::with(['added_by', 'approved_by', 'category'])
            ->where('is_approved', true); // Only approved products

        //Apply Category filter
        if ($request->filled('category_id')) {
            $query->where('category', $request->get('category_id'));
        }
        // Apply search filter
        if ($request->filled('search')) {
            $search = $request->get('search');
            $query->where('product_name', 'like', "%{$search}%");
        }
        // Paginate after filters
        $products = $query->paginate($perPage, ['*'], 'page', $page);
        // dd($products->toArray());
        // Append supplier offers count
        $products->getCollection()->transform(function ($product) {
            $product->supplierOffersCount = SupplierOffers::where('master_product_id', $product->id)->count();
            $product->suppliers = SupplierOffers::with('supplier')->where('master_product_id', $product->id)->get();
            $product->suppliers->transform(function ($supplier) {
                $supplier->isMe = Auth::id() == $supplier->supplier_id;
                return $supplier;
            });
            return $product;
        });
        return response()->json($products, 200);
    }

    /**
     * Add a product to the supplier's inventory.
     */
    public function addProductToInventory(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'master_product_id' => 'required|exists:master_products,id',
            'price' => 'required|numeric',
            'availability_status' => 'required|in:In Stock,Out of Stock,Limited',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        // Create supplier offer for the product
        $supplierOffer = SupplierOffers::updateOrCreate([
            'supplier_id' => Auth::id(), // Authenticated supplier
            'master_product_id' => $request->master_product_id,
            'price' => $request->price,
            'availability_status' => $request->availability_status,
            'status' => 'Pending', // Default status, awaiting approval if needed
        ]);

        return response()->json(['message' => 'Product added to inventory successfully', 'supplier_offer' => $supplierOffer], 201);
    }

    /**
     * Request a new product to be added to the master catalog.
     */
    public function requestNewProduct(Request $request)
    {
        $validator = Validator::make($request->all(), [
            'product_name' => 'required|string|max:255',
            'product_type' => 'required|string|max:255',
            'category_id' => 'nullable|exists:category,id', // Optional category
            'specifications' => 'nullable|string',
            'unit_of_measure' => 'nullable|string|max:100',
            'price' => 'required|numeric',
            'availability_status' => 'required|in:In Stock,Out of Stock,Limited',
        ]);
        
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }
      

        // Create a new product request (admin will approve or reject)
        $newProduct = MasterProducts::create([
            'product_name' => $request->product_name,
            'product_type' => $request->product_type,
            'category' => $request->category_id,
            'specifications' => $request->specifications,
            'unit_of_measure' => $request->unit_of_measure,
            'slug' => Str::slug($request->product_name) . '-' . Str::random(6),
            'is_approved' => false, // Pending approval by admin
            'added_by' => Auth::id(), // Supplier is adding the product
        ]);
        $supplierOffer = SupplierOffers::updateOrCreate([
            'supplier_id' => Auth::id(), // Authenticated supplier
            'master_product_id' => $newProduct->id,
            'price' => $request->price,
            'availability_status' => $request->availability_status,
            'status' => 'Pending', // Default status, awaiting approval if needed
        ]);

        return response()->json(['message' => 'Product request submitted successfully', 'new_product' => $newProduct], 201);
    }

    /**
     * View the supplier's products list.
     */
    public function getSupplierProducts(Request $request)
    {
        // Fetch supplier's products from SupplierOffers
        $supplierOffers = SupplierOffers::with(['masterProduct', 'masterProduct.category','supplier'])
            ->where('supplier_id', Auth::id())
            ->paginate(10); // Pagination if needed

        return response()->json($supplierOffers);
    }

    /**
     * Edit product pricing in the supplier's inventory.
     */
    public function updateProductPricing(Request $request, $offerId)
    {
        $validator = Validator::make($request->all(), [
            'price' => 'required|numeric',
            'availability_status' => 'required|in:In Stock,Out of Stock,Limited',
        ]);

        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        // Find the existing supplier offer
        $supplierOffer = SupplierOffers::find($offerId);

        if (!$supplierOffer || $supplierOffer->supplier_id != Auth::id()) {
            return response()->json(['error' => 'Offer not found or you are not authorized to edit this offer'], 404);
        }

        // Update the product pricing and availability
        $supplierOffer->update([
            'price' => $request->price,
            'availability_status' => $request->availability_status,
        ]);

        return response()->json(['message' => 'Product pricing updated successfully', 'supplier_offer' => $supplierOffer], 200);
    }

    /**
     * Delete product from the supplier's inventory.
     */
    public function deleteProductFromInventory($offerId)
    {
        // Find the existing supplier offer
        $supplierOffer = SupplierOffers::find($offerId);
        if (!$supplierOffer || $supplierOffer->supplier_id != Auth::id()) {
            return response()->json(['error' => 'Offer not found or you are not authorized to delete this offer'], 404);
        }
        $supplierOffer->delete();
        return response()->json(['message' => 'Product removed from inventory successfully'], 200);
    }

    /**
     * Get Status of Supplier Offers.
     */
    public function getSupplierOfferStatus()
    {
        $offers = SupplierOffers::where('supplier_id', Auth::id())->get();
        return response()->json($offers, 200);
    }

}


------------------------------------------------------------
FILE: app/Http/Controllers/SupplierOrderController.php
------------------------------------------------------------
<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use App\Models\Orders;
use App\Models\OrderItem;
use App\Models\MasterProducts;
use App\Models\SupplierOffers;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Auth;
use Illuminate\Support\Facades\Validator;

class SupplierOrderController extends Controller
{
    // Helper function | Workflow 
    private function workflow(Orders $order)
    {
        $currentWorkflow = $order->workflow;

        switch ($currentWorkflow) {
            case 'Supplier Assigned':
                $allConfirmed = $order->items()->where('supplier_confirms', false)->count() === 0;
                if (!$allConfirmed) {
                    break;
                }

                // Constants
                $ADMIN_MARGIN    = 0.50;
                $DELIVERY_MARGIN = 0.10;
                $FLEET_MARGIN    = 0.15;
                $GST_RATE        = 0.10;

                // Accumulators
                $customer_item_cost     = 0.0;
                $customer_delivery_cost = 0.0;
                $supplier_item_cost     = 0.0;
                $supplier_delivery_cost = 0.0;

                foreach ($order->items as $item) {
                    // Supplier material cost
                    $base_material_cost = ($item->supplier_unit_cost * $item->quantity) - $item->supplier_discount;
                    if ($base_material_cost < 0) { $base_material_cost = 0; }
                    $supplier_item_cost += $base_material_cost;

                    // Customer item cost with admin margin or quoted override
                    if ((int)$item->is_quoted === 1 && $item->quoted_price !== null) {
                        $customer_item_cost += (float)$item->quoted_price;
                    } else {
                        $customer_item_cost += $base_material_cost * (1 + $ADMIN_MARGIN);
                    }

                    // Delivery handling
                    $dtype = (string)$item->delivery_type;
                    if ($dtype === 'Supplier' || $dtype === 'ThirdParty') {
                        $customer_delivery_cost += $item->delivery_cost * (1 + $DELIVERY_MARGIN);
                        $supplier_delivery_cost += $item->delivery_cost;
                    } elseif ($dtype === 'Fleet') {
                        $customer_delivery_cost += $item->delivery_cost * (1 + $FLEET_MARGIN);
                        $supplier_delivery_cost += $item->delivery_cost;
                    } elseif ($dtype === 'Included' || $dtype === 'None' || $dtype === '' || $dtype === null) {
                        // No delivery cost
                    } else {
                        // Unknown type: supplier bears base delivery
                        $supplier_delivery_cost += (float)$item->delivery_cost;
                    }
                }

                // GST on customer-facing costs
                $gst_tax = ($customer_item_cost + $customer_delivery_cost) * $GST_RATE;

                // Totals
                $discount      = (float)($order->discount ?? 0);
                $other_charges = (float)($order->other_charges ?? 0);

                $total_price = $customer_item_cost
                            + $customer_delivery_cost
                            + $gst_tax
                            - $discount
                            + $other_charges;

                // Profit metrics
                $supplier_total    = $supplier_item_cost + $supplier_delivery_cost;
                $profit_before_tax = $total_price - $supplier_total - $gst_tax;
                $profit_margin_percent = $supplier_total > 0 ? ($profit_before_tax / $supplier_total) : 0.0;

                // Save to order
                $order->customer_item_cost     = round($customer_item_cost, 2);
                $order->customer_delivery_cost = round($customer_delivery_cost, 2);
                $order->supplier_item_cost     = round($supplier_item_cost, 2);
                $order->supplier_delivery_cost = round($supplier_delivery_cost, 2);
                $order->gst_tax                = round($gst_tax, 2);
                $order->total_price            = round($total_price, 2);

                // Actual profit amount (not percentage)
                $order->profit_amount          = round($profit_before_tax, 2);
                $order->profit_margin_percent  = round($profit_margin_percent,2);

                $order->workflow = 'Payment Requested';
                // dd($customer_item_cost, $customer_delivery_cost, $supplier_item_cost, $supplier_delivery_cost, $profit_margin_percent, $profit_before_tax);
                $order->save();

                break;
        }
    }


    // public function getSupplierOrders(Request $request)
    // {
    //     $user = Auth::user();

    //     // Pagination and filtering parameters
    //     $perPage = (int) $request->get('per_page', 10);
    //     $search = trim((string) $request->get('search', ''));
    //     $confirmed = $request->get('supplier_confirms');
    //     $deliveryDate = $request->get('supplier_delivery_date');
    //     $productId = $request->get('product_id');
    //     $details = $request->boolean('details', false);

    //     // Base query for supplier's order items - reusable for all metrics
    //     $baseQuery = function () use ($user, $search, $confirmed, $deliveryDate, $productId) {
    //         $query = OrderItem::where('supplier_id', $user->id);

    //         // Apply search filter (by product name)
    //         if (!empty($search)) {
    //             $query->whereHas('product', function ($q) use ($search) {
    //                 $q->where('product_name', 'like', '%' . $search . '%');
    //             });
    //         }

    //         // Apply confirmed filter
    //         if ($confirmed !== null) {
    //             $query->where('supplier_confirms', filter_var($confirmed, FILTER_VALIDATE_BOOLEAN));
    //         }

    //         // Apply delivery date filter
    //         if (!empty($deliveryDate)) {
    //             $query->whereDate('supplier_delivery_date', $deliveryDate);
    //         }

    //         // Apply product ID filter
    //         if (!empty($productId)) {
    //             $query->where('product_id', $productId);
    //         }

    //         return $query;
    //     };

    //     // Get metrics with applied filters
    //     $totalOrdersCount = $baseQuery()->count();
    //     $supplierConfirmedCount = $baseQuery()->where('supplier_confirms', true)->count();
    //     $awaitingPaymentCount = $baseQuery()->where('is_paid', false)->count();
    //     $deliveredCount = $baseQuery()->whereHas('order', function ($query) {
    //         $query->where('workflow', 'Delivered');
    //     })->count();

    //     // Get paginated results using the same base query
    //     $orderItemsQuery = $baseQuery()->with(['order', 'product', 'chosenOffer']);
    //     $orderItems = $orderItemsQuery->orderBy('created_at', 'desc')->paginate($perPage);

    //     // Prepare response data
    //     $data = [
    //         'data' => $orderItems->items(),
    //         'pagination' => [
    //             'current_page' => $orderItems->currentPage(),
    //             'per_page' => $orderItems->perPage(),
    //             'total' => $orderItems->total(),
    //             'last_page' => $orderItems->lastPage(),
    //         ],
    //         'metrics' => [
    //             'total_orders_count' => $totalOrdersCount,
    //             'supplier_confirmed_count' => $supplierConfirmedCount,
    //             'awaiting_payment_count' => $awaitingPaymentCount,
    //             'delivered_count' => $deliveredCount,
    //         ]
    //     ];

    //     // Add filters data if details=true
    //     if ($details) {
    //         // Get products that this supplier offers
    //         $supplierProducts = MasterProducts::whereHas('supplierOffers', function ($query) use ($user) {
    //             $query->where('supplier_id', $user->id);
    //         })
    //         ->select('id', 'product_name', 'photo')
    //         ->get()
    //         ->map(function ($product) {
    //             return [
    //                 'id' => $product->id,
    //                 'product_name' => $product->product_name,
    //                 'photo' => $product->photo,
    //             ];
    //         });

    //         $data['filters'] = [
    //             'products' => $supplierProducts
    //         ];
    //     }

    //     return response()->json([
    //         'success' => true,
    //         'data' => $data
    //     ]);
    // }
    public function getSupplierOrders(Request $request)
    {
        $user = Auth::user();

        // Pagination and filtering parameters
        $perPage = (int) $request->get('per_page', 10);
        $search = trim((string) $request->get('search', ''));
        $confirmed = $request->get('supplier_confirms');
        $deliveryDate = $request->get('supplier_delivery_date');
        $productId = $request->get('product_id');
        $details = $request->boolean('details', false);
        // dd($user);
        // Base query for orders that have items assigned to this supplier
        $baseQuery = function () use ($user, $search, $confirmed, $deliveryDate, $productId) {
            $query = Orders::whereHas('items', function ($q) use ($user, $search, $confirmed, $deliveryDate, $productId) {
                $q->where('supplier_id', $user->id);

                // Apply search filter (by product name)
                if (!empty($search)) {
                    $q->whereHas('product', function ($productQuery) use ($search) {
                        $productQuery->where('product_name', 'like', '%' . $search . '%');
                    });
                }

                // Apply confirmed filter
                if ($confirmed !== null) {
                    $q->where('supplier_confirms', filter_var($confirmed, FILTER_VALIDATE_BOOLEAN));
                }

                // Apply delivery date filter
                if (!empty($deliveryDate)) {
                    $q->whereDate('supplier_delivery_date', $deliveryDate);
                }

                // Apply product ID filter
                if (!empty($productId)) {
                    $q->where('product_id', $productId);
                }
            });

            return $query;
        };

        // Get metrics with applied filters
        $totalOrdersCount = $baseQuery()->count();
        
        $supplierConfirmedCount = Orders::whereHas('items', function ($q) use ($user, $search, $confirmed, $deliveryDate, $productId) {
            $q->where('supplier_id', $user->id)
            ->where('supplier_confirms', true);

            // Apply the same filters for consistency
            if (!empty($search)) {
                $q->whereHas('product', function ($productQuery) use ($search) {
                    $productQuery->where('product_name', 'like', '%' . $search . '%');
                });
            }
            if (!empty($deliveryDate)) {
                $q->whereDate('supplier_delivery_date', $deliveryDate);
            }
            if (!empty($productId)) {
                $q->where('product_id', $productId);
            }
        })->count();
        
        // $awaitingPaymentCount = Orders::whereHas('items', function ($q) use ($user, $search, $confirmed, $deliveryDate, $productId) {
        //     $q->where('supplier_id', $user->id)
        //     ->where('is_paid', false);
        $awaitingPaymentCount = Orders::where(function ($orderQuery) use ($user) {
        $orderQuery->whereNull('supplier_paid_ids')
                ->orWhereJsonDoesntContain('supplier_paid_ids', $user->id); // User ID not in paid list
        })
        ->whereHas('items', function ($q) use ($user, $search, $confirmed, $deliveryDate, $productId) {
            $q->where('supplier_id', $user->id);

            // Optional filters
            if (!empty($search)) {
                $q->whereHas('product', function ($productQuery) use ($search) {
                    $productQuery->where('product_name', 'like', '%' . $search . '%');
                });
            }

            if (!empty($deliveryDate)) {
                $q->whereDate('supplier_delivery_date', $deliveryDate);
            }

            if (!empty($productId)) {
                $q->where('product_id', $productId);
            }
        })->count();


        
        $deliveredCount = $baseQuery()->where('workflow', 'Delivered')->count();

        // Get paginated results with supplier's items count and relationship
        $ordersQuery = $baseQuery()->with(['items' => function ($query) use ($user) {
            $query->where('supplier_id', $user->id)
                ->with(['product', 'chosenOffer']);
        }]);

        $orders = $ordersQuery->orderBy('created_at', 'desc')->paginate($perPage);

        // Transform the response to include items count for this supplier
        $transformedOrders = $orders->getCollection()->map(function ($order) use ($user) {
            $supplierItems = $order->items->where('supplier_id', $user->id);
            $totalAmount = 0;
            foreach ($supplierItems as $item) {
                $itemCost = ($item->supplier_unit_cost * $item->quantity) - $item->supplier_discount + $item->supplier_delivery_cost;
                $totalAmount += $itemCost;
            }

            return [
                'id' => $order->id,
                'po_number' => $order->po_number,          // was 'order_number'
                'order_status' => $order->order_status,    // show status to suppliers
                // 'workflow' => $order->workflow,         // remove from supplier view
                'total_amount' => $totalAmount,
                'created_at' => $order->created_at,
                'updated_at' => $order->updated_at,
                'supplier_items_count' => $supplierItems->count(),
                'supplier_items' => $supplierItems->map(function ($item) {
                    return [
                        'id' => $item->id,
                        'product_id' => $item->product_id,
                        'quantity' => $item->quantity,
                        'supplier_unit_cost' => $item->supplier_unit_cost,
                        // 'supplier_delivery_cost' => $item->supplier_delivery_cost,
                        'delivery_cost' => $item->delivery_cost ?? null,  // keep if present in model
                        'delivery_type' => $item->delivery_type ?? null,  // keep if present in model
                        'supplier_discount' => $item->supplier_discount,
                        'supplier_delivery_date' => $item->supplier_delivery_date,
                        'supplier_confirms' => $item->supplier_confirms,
                        'supplier_notes' => $item->supplier_notes ?? null,
                        'product' => $item->product,
                        'chosen_offer' => $item->chosenOffer,
                    ];
                }),
            ];
        });

        // Prepare response data
        $data = [
            'data' => $transformedOrders,
            'pagination' => [
                'current_page' => $orders->currentPage(),
                'per_page' => $orders->perPage(),
                'total' => $orders->total(),
                'last_page' => $orders->lastPage(),
            ],
            'metrics' => [
                'total_orders_count' => $totalOrdersCount,
                'supplier_confirmed_count' => $supplierConfirmedCount,
                'awaiting_payment_count' => $awaitingPaymentCount,
                'delivered_count' => $deliveredCount,
            ]
        ];

        // Add filters data if details=true
        if ($details) {
            // Get products that this supplier offers
            $supplierProducts = MasterProducts::whereHas('supplierOffers', function ($query) use ($user) {
                $query->where('supplier_id', $user->id);
            })
            ->select('id', 'product_name', 'photo')
            ->get()
            ->map(function ($product) {
                return [
                    'id' => $product->id,
                    'product_name' => $product->product_name,
                    'photo' => $product->photo,
                ];
            });

            $data['filters'] = [
                'products' => $supplierProducts
            ];
        }

        return response()->json([
            'success' => true,
            'data' => $data
        ]);
    }

    public function updateOrderPricing(Request $request, OrderItem $orderItem)
    {
        $v = Validator::make($request->all(), [
            'supplier_unit_cost' => 'sometimes|required|numeric|min:0',
            'supplier_discount' => 'sometimes|required|numeric|min:0',
            'supplier_delivery_date' => 'sometimes|required|date',
            'supplier_confirms' => 'sometimes|required|boolean',
            'delivery_cost' => 'sometimes|required|numeric|min:0',
            'delivery_type'=> 'required|in:Included,Supplier,ThirdParty,Fleet,None ',
            'supplier_notes' => 'sometimes|nullable|string|max:500'
        ]);

        if ($v->fails()) {
            return response()->json(['error' => $v->errors()], 422);
        }

        // Check if the authenticated user is the supplier for this order item
        $user = Auth::user();

        if(!in_array($orderItem->order->workflow, ['Supplier Assigned', 'Requested'])) {  //, 'Payment Requested', 'On Hold', 'Delivered'
            return response()->json([
                'message' => 'Cannot update order item now as the order is in '.$orderItem->order->workflow.' status'
            ], 403);
        }   
        if ($orderItem->supplier_id !== $user->id) {
            return response()->json([
                'message' => 'You are not authorized to update this order item'
            ], 403);
        }

        // Check if order item is already confirmed
        if ($orderItem->supplier_confirms && $request->has('supplier_confirms') && !$request->supplier_confirms) {
            return response()->json([
                'message' => 'Cannot unconfirm an already confirmed order item'
            ], 422);
        }

        try {
            DB::beginTransaction();

            // Update the order item with provided fields
            $updateData = [];
            
            if ($request->has('supplier_unit_cost')) {
                $updateData['supplier_unit_cost'] = $request->supplier_unit_cost;
            }
            
            if ($request->has('delivery_cost')) {
                $updateData['delivery_cost'] = $request->delivery_cost;
            }
            
            if ($request->has('supplier_discount')) {
                $updateData['supplier_discount'] = $request->supplier_discount;
            }

            if ($request->has('delivery_type')) {
                $updateData['delivery_type'] = $request->delivery_type;
            }
            
            if ($request->has('supplier_delivery_date')) {
                $updateData['supplier_delivery_date'] = $request->supplier_delivery_date;
            }
            
            if ($request->has('supplier_confirms')) {
                $updateData['supplier_confirms'] = $request->supplier_confirms;
            }
            
            if ($request->has('supplier_notes')) {
                $updateData['supplier_notes'] = $request->supplier_notes;
            }

            // Update the order item
            $orderItem->update($updateData);

            // If supplier confirmed the order, trigger workflow check
            if ($request->has('supplier_confirms') && $request->supplier_confirms) {
                $this->workflow($orderItem->order);
            }

            DB::commit();

            // Reload the order item with relationships
            $orderItem->load(['order', 'product', 'chosenOffer']);

            return response()->json([
                'success' => true,
                'message' => 'Order item updated successfully',
                'data' => $orderItem
            ]);

        } catch (\Exception $e) {
            DB::rollBack();
            return response()->json([
                'error' => 'Failed to update order item: ' . $e->getMessage()
            ], 500);
        }
    }

    public function viewOrderDetails(Orders $order)
    {
        $user = Auth::user();

        // Ensure the supplier has items in this order
        $supplierItems = $order->items()->where('supplier_id', $user->id)->with(['product', 'chosenOffer'])->get();

        if ($supplierItems->isEmpty()) {
            return response()->json([
                'error' => 'You do not have any items in this order'
            ], 403);
        }

        // Reload the order with only selected fields and relationships
        $order = Orders::where('id', $order->id)
            ->select([
                'id',
                'po_number', // Make sure this field exists in your table
                'project_id',
                'client_id',
                'workflow',
                'delivery_address',
                'delivery_date',
                'delivery_time',
                'delivery_window',
                'delivery_method',
                'load_size',
                'special_equipment',
                'special_notes',
                'created_at',
                'updated_at'
            ])
            ->with(['client:id,name,email', 'project:id,name,site_contact_name,site_contact_phone,site_instructions'])
            ->first();

        return response()->json([
            'success' => true,
            'data' => [
                'order' => $order,
                'supplier_items' => $supplierItems
            ]
        ]);
    }



    
}


------------------------------------------------------------
FILE: app/Http/Controllers/UserManagement.php
------------------------------------------------------------
<?php
namespace App\Http\Controllers;

use App\Models\User;
use App\Models\Company;
use App\Models\Category;
use Illuminate\Http\Request;
use Illuminate\Support\Str;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Facades\Validator;
use Illuminate\Support\Facades\Storage;

class UserManagement extends Controller
{
    // List Users with Multiple Filters and Pagination
    public function index(Request $request)
    {
        $query = User::query();

        // Filters
        if ($request->has('role') && in_array($request->role, ['admin', 'client', 'supplier','accountant','support'])) {
          
            $query->where('role', $request->role);
        }

        if ($request->has('isDeleted')) {
        // Ensure the value is treated as a boolean (either true or false)
        $isDeleted = filter_var($request->isDeleted, FILTER_VALIDATE_BOOLEAN, FILTER_NULL_ON_FAILURE);

        // If valid, apply the filter
        if ($isDeleted !== null) {
            $query->where('isDeleted', $isDeleted);
        }
}

        if ($request->has('company_id') && is_numeric($request->company_id)) {
            $query->where('company_id', $request->company_id);
        }

        if ($request->has('contact_name')) {
            $query->where('contact_name', 'like', '%' . $request->contact_name . '%');
        }

        if ($request->has('location')) {
            $query->where('location', 'like', '%' . $request->location . '%');
        }

        if ($request->has('lat') && $request->has('long')) {
            $query->where('lat', $request->lat)->where('long', $request->long);
        }

        // Get the 'per_page' value from the request, default to 10 if not provided
        $perPage = $request->get('per_page', 10); // Default to 10 if no value is provided

        $query->with('company');

        // Pagination
        $users = $query->paginate($perPage);

        return response()->json($users);
    }

    
    // Add User
    public function store(Request $request)
    {
        // Manual validation handling (same as in registerSupplier)
        $validator = Validator::make($request->all(), [
            'name' => 'required|string|max:255',
            'email' => 'required|email|unique:users,email',
            'password' => 'required|string|min:6',
            'role' => 'required|string|in:admin,client,supplier,accountant,support',
            'company_name' => 'nullable|string|max:255', // Make sure the company name is optional
            'contact_name' => 'nullable|string|max:255',
            'contact_number' => 'nullable|string|max:255',
            'location' => 'nullable|string|max:255',
            'lat' => 'nullable|numeric',
            'long' => 'nullable|numeric',
            'delivery_radius' => 'nullable|numeric',
            'shipping_address' => 'nullable|string|max:255',
            'billing_address' => 'nullable|string|max:255',
            'client_public_id' => 'nullable|string|unique:users,client_public_id',
            'profile_image' => 'nullable|image|mimes:jpg,png,jpeg,gif',
            'notes' => 'nullable|string|max:1000',
        ]);

        // Check if validation fails
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        // Handle Company ID if it's for client or supplier
        $company_id = null;
        if ($request->role !== 'admin' && $request->has('company_name')) {
            // Look for the company by name, or create it if not found
            $company = Company::firstOrCreate([
                'name' => Str::lower($request->company_name),  // Company name is case-insensitive
            ]);

            // Assign the found or created company ID
            $company_id = $company->id;
        }

        // Handle Profile Image
        $imageUrl = null;
        if ($request->hasFile('profile_image') && $request->file('profile_image')->isValid()) {
            // Store the file under 'profile_images' directory in the 'public' disk
            $path = $request->file('profile_image')->store('profile_images', 'public');
            $imageUrl = 'storage/' . $path; // Relative path to the image
        }

        // Create the User
        $user = User::create([
            'name' => $request->name,
            'email' => $request->email,
            'password' => Hash::make($request->password),
            'role' => $request->role,
            'company_id' => $company_id,  // Assign company_id (can be null or an existing company ID)
            'contact_name' => $request->contact_name,
            'contact_number' => $request->contact_number,
            'location' => $request->location,
            'lat' => $request->lat,
            'long' => $request->long,
            'delivery_radius' => $request->delivery_radius,
            'shipping_address' => $request->shipping_address,
            'billing_address' => $request->billing_address,
            'client_public_id' => $request->client_public_id ?? 'MC-' . rand(100, 999),
            'profile_image' => $imageUrl,
            'isDeleted' => false,
            'notes' => $request->notes,
        ]);

        // Return the created user along with a success message and profile image URL
        return response()->json([
            'message' => 'User registered successfully.',
            'user' => $user,
            'role' => $user->role,
            'profile_image_url' => $imageUrl, // Return the image URL in response
        ], 201);
    }

    // Show User Details
    public function show($id)
    {
        $user = User::with('company')->find($id);
        if (!$user) {
            return response()->json(['error' => 'User not found'], 404);
        }
        return response()->json($user);
    }

    // Update User
    public function update(Request $request, $id)
    {
        // Find the user by ID
        $user = User::find($id);
        if (!$user) {
            return response()->json(['error' => 'User not found'], 404);
        }

        // Validate the request
        $validator = Validator::make($request->all(), [
            'name' => 'string|max:255',
            'email' => 'email|unique:users,email,' . $id,
            'password' => 'nullable|string|min:6',
            'role' => 'string|in:admin,client,supplier,accountant,support',
            'contact_name' => 'nullable|string|max:255',
            'contact_number' => 'nullable|string|max:255',
            'location' => 'nullable|string|max:255',
            'lat' => 'nullable|numeric',
            'long' => 'nullable|numeric',
            'delivery_radius' => 'nullable|numeric',
            'shipping_address' => 'nullable|string|max:255',
            'billing_address' => 'nullable|string|max:255',
            'profile_image' => 'nullable|image|mimes:jpg,png,jpeg,gif,webp',
            'notes' => 'nullable|string|max:1000',
        ]);

        // Check if validation fails
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        // Handle Profile Image
        $profileImagePath = $user->profile_image; // Existing profile image path

        if ($request->hasFile('profile_image')) {
            // Check if there's an old image and delete it before uploading the new one
            if ($profileImagePath) {
                $oldImagePath = str_replace('storage/', '', $profileImagePath); // Get the relative path
                $oldImagePath = 'storage/app/public/' . $oldImagePath;
                if (Storage::exists($oldImagePath)) {
                    Storage::delete($oldImagePath); // Delete the old image
                }
            }

            // Store the new profile image
            $profileImagePath = 'storage/'.$request->file('profile_image')->store('profile_images', 'public');
        }

        // Update the User with the new data
        $user->update([
            'name' => $request->name ?? $user->name,
            'email' => $request->email ?? $user->email,
            'password' => $request->password ? Hash::make($request->password) : $user->password,
            'role' => $request->role ?? $user->role,
            'contact_name' => $request->contact_name ?? $user->contact_name,
            'contact_number' => $request->contact_number ?? $user->contact_number,
            'location' => $request->location ?? $user->location,
            'lat' => $request->lat ?? $user->lat,
            'long' => $request->long ?? $user->long,
            'delivery_radius' => $request->delivery_radius ?? $user->delivery_radius,
            'shipping_address' => $request->shipping_address ?? $user->shipping_address,
            'billing_address' => $request->billing_address ?? $user->billing_address,
            'profile_image' => $profileImagePath ? $profileImagePath : $user->profile_image, // Store the relative path
            'notes' => $request->notes ?? $user->notes,
        ]);

        // Return the updated user information as a JSON response
        return response()->json($user->load('company'));
    }

    // Soft Delete User (Mark isDeleted as true)
    public function destroy($id)
    {
        $user = User::find($id);
        if (!$user) {
            return response()->json(['error' => 'User not found'], 404);
        }

        // Mark the user as deleted
        if($user->isDeleted){
            $user->update(['isDeleted' => false]);
            return response()->json(['message' => 'User restored successfully']);
        }
        $user->update(['isDeleted' => true]);

        return response()->json(['message' => 'User marked as deleted successfully']);
    }

    // Check if Company Exists
    public function checkCompany(Request $request)
    {
        $companyName = Str::lower($request->company_name);
        $company = Company::where('name', $companyName)->first();

        if ($company) {
            return response()->json(['exists' => true, 'company_id' => $company->id]);
        } else {
            return response()->json(['exists' => false]);
        }
    }


    public function addCategory(Request $request)
    {

        $validator = Validator::make($request->all(), [
            'name' => 'required|string|max:120|unique:category,name',
        ]);

        // Check if validation fails
        if ($validator->fails()) {
            return response()->json(['error' => $validator->errors()], 400);
        }

        $category = Category::create([
            'name' => $request->name,
        ]);
        return response()->json(['message' => 'Category added successfully', 'category' => $category], 201);
    }
    public function listCategories(Request $request)
    {
        // Default pagination parameters
        $perPage = $request->get('per_page', 10);  // Default 10 items per page
        $page = $request->get('page', 1);
        // Fetch categories with pagination
        $categories = Category::paginate($perPage);
        return response()->json($categories, 200);
    }

    public function deleteCategory($id)
    {
        $category = Category::find($id);
        if (!$category) {
            return response()->json(['error' => 'Category not found'], 404);
        }
        $category->delete();
        return response()->json(['message' => 'Category deleted successfully'], 200);
    }

    public function updateCategory(Request $request, $id)
    {
        $category = Category::find($id);
        if (!$category) {
            return response()->json(['error' => 'Category not found'], 404);
        }

        $data = $request->validate([
            'name' => 'required|string|max:120|unique:category,name,' . $id,
        ]);

        $category->update([
            'name' => $data['name'],
        ]);

        return response()->json(['message' => 'Category updated successfully', 'category' => $category], 200);
    }

    public function getCategory($id)
    {
      
        $category = Category::find($id);
        if (!$category) {
            return response()->json(['error' => 'Category not found'], 404);
        }
        return response()->json($category, 200);
    }

    public function getCompanies()
    {
        $companies = Company::all();
        return response()->json($companies);
    }

    // public function getSuppliersWithDeliveryZones(Request $request)
    // {
    //     $perPage = (int) $request->get('per_page', 10);
    //     $search = $request->get('search');

    //     $suppliers = User::where('role', 'supplier')
    //         ->whereNotNull('delivery_zones')
    //         ->where('delivery_zones', '!=', '[]')
    //         ->when($search, function ($query) use ($search) {
    //             return $query->where('name', 'like', '%' . $search . '%');
    //         })
    //         ->select('id', 'name', 'email', 'profile_image', 'delivery_zones')
    //         ->paginate($perPage);

    //     // Decode JSON for each supplier in paginated result
    //     // $suppliers->getCollection()->transform(function ($supplier) {
    //     //     $supplier->delivery_zones = json_decode($supplier->delivery_zones, true);
    //     //     return $supplier;
    //     // });

    //     return response()->json($suppliers);
    // }

    public function getSuppliersWithDeliveryZones(Request $request)
    {
        $perPage = (int) $request->get('per_page', 10);
        $search = $request->get('search');

        // Query to get the suppliers with delivery zones
        $suppliers = User::where('role', 'supplier')
            ->whereNotNull('delivery_zones')
            ->where('delivery_zones', '!=', '[]')
            ->when($search, function ($query) use ($search) {
                return $query->where('name', 'like', '%' . $search . '%');
            })
            ->select('id', 'name', 'email', 'profile_image', 'delivery_zones')
            ->paginate($perPage);

        // Decode delivery zones for each supplier in the paginated result
        $suppliers->getCollection()->transform(function ($supplier) {
            $supplier->delivery_zones = json_decode($supplier->delivery_zones, true);
            return $supplier;
        });

        // Return the paginated result as JSON
        return response()->json($suppliers);
    }


}


------------------------------------------------------------
FILE: app/Http/Middleware/AuthMiddleware.php
------------------------------------------------------------
<?php
// app/Http/Middleware/AuthMiddleware.php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Symfony\Component\HttpFoundation\Response;
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Auth;

class AuthMiddleware
{
    public function handle(Request $request, Closure $next): Response
    {
        $path = $request->path();
        $isAuthenticated = Auth::check();
        
        Log::info('AuthMiddleware Debug', [
            'path' => $path,
            'authenticated' => $isAuthenticated,
            'user_id' => $isAuthenticated ? Auth::id() : null,
            'session_id' => session()->getId(),
            'cookie_received' => $request->cookie(config('session.cookie'))
        ]);

        // Public routes that don't require authentication
        $publicRoutes = ['login', 'register', 'login-submit', 'register-submit', 'logout', '', 'debug-auth', 'debug-sessions', 'reset-sessions', 'debug-session-full'];
        
        // If not authenticated and trying to access protected route
        if (!$isAuthenticated && !in_array($path, $publicRoutes)) {
            Log::warning('Redirecting to login - not authenticated', [
                'session_match' => $request->cookie(config('session.cookie')) === session()->getId()
            ]);
            return redirect()->route('login')->withErrors(['message' => 'Please log in to access this page.']);
        }

        Log::info('Allowing request to proceed');
        return $next($request);
    }
}

------------------------------------------------------------
FILE: app/Http/Middleware/IsAdmin.php
------------------------------------------------------------
<?php
namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Illuminate\Http\Response;

class isAdmin
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return \Illuminate\Http\Response
     */
    public function handle(Request $request, Closure $next)
    {
        // Ensure the user is authenticated before checking role
        $user = auth()->user();
      
        if (!$user) {
            // Return an unauthorized response if the user is not authenticated
            return response()->json(['message' => 'Unauthorized'], 401);  // Explicitly returning JsonResponse, but it's fine in this context
        }

        // Check if the authenticated user is an admin
        if ($user->role !== 'admin' && $user->role !== "support" && $user->role !== "accountant") {
            // Return a forbidden response if the user is not an admin
            return response()->json(['message' => 'Forbidden. Admin access only.'], 403);  // Explicitly returning JsonResponse
        }

        // Allow the request to proceed to the next middleware or controller
        return $next($request);  // This is a valid return, it doesn't return a JsonResponse
    }
}


------------------------------------------------------------
FILE: app/Http/Middleware/IsClient.php
------------------------------------------------------------
<?php
namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Illuminate\Http\Response;
use Illuminate\Support\Facades\Auth;
class isClient
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return \Illuminate\Http\Response
     */
    public function handle(Request $request, Closure $next)
    {
        // Ensure the user is authenticated before checking role
        $user = Auth::user();
      
        if (!$user) {
            // Return an unauthorized response if the user is not authenticated
            return response()->json(['message' => 'Unauthorized'], 401);  
        }

        // Check if the authenticated user is an client
        if (Auth::user()->role !== 'client') {
            // Return a forbidden response if the user is not an client
            return response()->json(['message' => 'Forbidden. Client access only.'], 403);  // Explicitly returning JsonResponse
        }

        // Allow the request to proceed to the next middleware or controller
        return $next($request);  // This is a valid return, it doesn't return a JsonResponse
    }
}


------------------------------------------------------------
FILE: app/Http/Middleware/IsSupplier.php
------------------------------------------------------------
<?php
namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;

class isSupplier
{
    /**
     * Handle an incoming request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @param  \Closure  $next
     * @return \Illuminate\Http\Response
     */
    public function handle(Request $request, Closure $next)
    {
        // Ensure the user is authenticated before checking role
        $user = Auth::user();
      
        if (!$user) {
            // Return an unauthorized response if the user is not authenticated
            return response()->json(['message' => 'Unauthorized'], 401);  
        }

        // Check if the authenticated user is an supplier
        if (Auth::user()->role !== 'supplier') {
            // Return a forbidden response if the user is not an supplier
            return response()->json(['message' => 'Forbidden. Supplier access only.'], 403);  // Explicitly returning JsonResponse
        }

        // Allow the request to proceed to the next middleware or controller
        return $next($request);  // This is a valid return, it doesn't return a JsonResponse
    }
}


------------------------------------------------------------
FILE: app/Models/Category.php
------------------------------------------------------------
<?php
namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Category extends Model
{
    use HasFactory;

    protected $table = 'category';

    protected $fillable = ['name'];


    public function products()
    {
        return $this->hasMany(MasterProducts::class, 'category');
    }
}


------------------------------------------------------------
FILE: app/Models/Company.php
------------------------------------------------------------
<?php
namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Company extends Model
{
    use HasFactory;

    protected $table = 'companies';

    protected $fillable = ['name'];

    public function users()
    {
        return $this->hasMany(User::class);
    }
}


------------------------------------------------------------
FILE: app/Models/MasterProducts.php
------------------------------------------------------------
<?php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class MasterProducts extends Model
{
    protected $table = 'master_products';
    protected $fillable = ['product_name', 'product_type', 'specifications', 'unit_of_measure', 'tech_doc', 'photo','is_approved','added_by','approved_by', 'slug', 'category'];

    public function supplierOffers()
    {
        return $this->hasMany(SupplierOffers::class, 'master_product_id');
    }

    public function category()
    {
        return $this->belongsTo(Category::class, 'category')->select('id', 'name');
    }

    public function added_by()
    {
        return $this->belongsTo(User::class, 'added_by')->select('id', 'name', 'email','profile_image');
    }

    // Relationship with the user who approved the product
    public function approved_by()
    {
        return $this->belongsTo(User::class, 'approved_by')->select('id', 'name', 'email','profile_image');
    }
}


------------------------------------------------------------
FILE: app/Models/OrderItem.php
------------------------------------------------------------
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\{BelongsTo};

class OrderItem extends Model
{
    protected $table = 'order_items';

    protected $fillable = [
        'order_id',
        'product_id',
        'quantity',
        'supplier_id',
        'custom_blend_mix',
        'supplier_unit_cost',
        'supplier_delivery_cost',
        'supplier_discount',
        'supplier_delivery_date',
        'choosen_offer_id',
        'suppier_notes',
        'supplier_confirms',
        'delivery_type',
        'delivery_cost',
        'is_qouted',
        'quoted_price',
        'is_paid',
    ];

    protected $casts = [
        'quantity'               => 'decimal:2',
        'supplier_unit_cost'     => 'decimal:2',
        'supplier_delivery_cost' => 'decimal:2',
        'supplier_discount'      => 'decimal:2',
        'quoted_price'           => 'decimal:2',
        'delivery_cost'          => 'decimal:2',
        'supplier_confirms'      => 'boolean',
        'is_paid'                => 'boolean',
        'is_qouted'              => 'boolean',
        'supplier_delivery_date' => 'datetime',

    ];

    // Relations
    public function order(): BelongsTo
    {
        return $this->belongsTo(Orders::class, 'order_id');
    }

    public function product(): BelongsTo
    {
        return $this->belongsTo(MasterProducts::class, 'product_id');
    }

    public function supplier(): BelongsTo
    {
        return $this->belongsTo(User::class, 'supplier_id');
    }

    public function chosenOffer(): BelongsTo
    {
        return $this->belongsTo(SupplierOffers::class, 'choosen_offer_id');
    }
}


------------------------------------------------------------
FILE: app/Models/Orders.php
------------------------------------------------------------
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\{BelongsTo, HasMany, HasManyThrough};

class Orders extends Model
{
    protected $table = 'orders';

    protected $fillable = [
        'po_number',
        'client_id',
        'project_id',
        'delivery_address',
        'delivery_lat',
        'delivery_long',
        'delivery_date',
        'delivery_time',
        'delivery_window',
        'delivery_method',
        'load_size',
        'special_equipment',
        'subtotal',
        'fuel_levy',
        'other_charges',
        'gst_tax',
        'discount',
        'total_price',
        'supplier_cost',
        'customer_cost',
        'customer_item_cost',
        'customer_delivery_cost',
        'payment_status',
        'order_status',
        'workflow',
        'reason',
        'repeat_order',
        'generate_invoice',
        'order_process',
        'special_notes',
        'supplier_paid_ids',
    ];

    protected $casts = [
        'delivery_date'     => 'datetime',
        'delivery_time'     => 'datetime:H:i:s',
        'delivery_lat'      => 'float',
        'delivery_long'     => 'float',
        'subtotal'          => 'decimal:2',
        'fuel_levy'         => 'decimal:2',
        'other_charges'     => 'decimal:2',
        'gst_tax'           => 'decimal:2',
        'discount'          => 'decimal:2',
        'total_price'       => 'decimal:2',
        'supplier_cost'     => 'decimal:2',
        'customer_cost'     => 'decimal:2',
        'customer_item_cost'         => 'decimal:2',
        'customer_delivery_cost'     => 'decimal:2',
        'supplier   _item_cost'         => 'decimal:2',
        'supplier   _delivery_cost'     => 'decimal:2',
        'profit_amount'      => 'decimal:2',
        'profit_margin_percent'      => 'decimal:2',
        'admin_margin'      => 'decimal:2',
        'repeat_order'      => 'boolean',
        'generate_invoice'  => 'boolean',
    ];

    // Enums as constants (optional helpers)
    public const PAYMENT_STATUS = ['Pending','Paid','Partially Paid','Partial Refunded','Refunded','Requested'];
    public const ORDER_STATUS   = ['Draft','Confirmed','Scheduled','In Transit','Delivered','Completed','Cancelled'];
    public const DELIVERY_WINDOW = ['Morning','Afternoon','Evening'];
    public const DELIVERY_METHOD = ['Other','Tipper','Agitator','Pump','Ute'];
    public const ORDER_PROCESS   = ['Automated','Action Required'];
    public const WORKFLOW        = ['Requested','Supplier Missing','Supplier Assigned','Payment Requested','On Hold','Delivered'];

    // Relations
    public function client(): BelongsTo
    {
        return $this->belongsTo(User::class, 'client_id');
    }

    public function project(): BelongsTo
    {
        return $this->belongsTo(Projects::class, 'project_id');
    }

    public function items(): HasMany
    {
        return $this->hasMany(OrderItem::class, 'order_id');
    }

    // Convenience: unique suppliers on this order
    public function suppliers(): HasManyThrough
    {
        return $this->hasManyThrough(
            User::class,
            OrderItem::class,
            'order_id',   // OrderItem foreign key...
            'id',         // User local key
            'id',         // Order local key
            'supplier_id' // OrderItem supplier key
        )->whereNotNull('order_items.supplier_id')->distinct();
    }

    // Scopes
    public function scopeForClient($q, int $clientId) { return $q->where('client_id', $clientId); }
    public function scopeStatus($q, string $status)   { return $q->where('order_status', $status); }
}


------------------------------------------------------------
FILE: app/Models/Projects.php
------------------------------------------------------------
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;


class Projects extends Model
{
    use HasFactory;

    // Define the table associated with the model
    protected $table = 'projects';

    // Define the fields that are mass assignable
    protected $fillable = [
        'name',
        'site_contact_name',
        'site_contact_phone',
        'site_instructions',
        'delivery_address',
        'delivery_lat',
        'delivery_long',
        'added_by',
    ];

    // Define the relationship to the User model
    public function added_by()
    {
        return $this->belongsTo(User::class, 'added_by')->select('id','name','email','profile_image');  // 'added_by' is the foreign key
    }

    public function orders(): HasMany
    {
        return $this->hasMany(Orders::class, 'project_id');
    }
}


------------------------------------------------------------
FILE: app/Models/SupplierOffers.php
------------------------------------------------------------
<?php
namespace App\Models;

use Illuminate\Database\Eloquent\Model;

class SupplierOffers extends Model
{
    protected $table = 'supplier_offers';
    protected $fillable = ['supplier_id', 'master_product_id', 'price', 'availability_status', 'status'];

    public function masterProduct()
    {
        return $this->belongsTo(MasterProducts::class);
    }

    public function supplier()
    {
        return $this->belongsTo(User::class, 'supplier_id')
            ->select('id', 'name', 'email', 'profile_image', 'delivery_zones')
            ->withCasts(['delivery_zones' => 'array']);
    }
}


------------------------------------------------------------
FILE: app/Models/User.php
------------------------------------------------------------
<?php

namespace App\Models;

use Illuminate\Foundation\Auth\User as Authenticatable;
use Illuminate\Notifications\Notifiable;
use Illuminate\Database\Eloquent\Factories\HasFactory;
use Laravel\Sanctum\HasApiTokens; 


class User extends Authenticatable
{
    use HasFactory, Notifiable, HasApiTokens;

    protected $fillable = [
        'name',
        'email',
        'password',
        'role',
        'company_id',
        'contact_name',
        'contact_number',
        'location',
        'lat',
        'long',
        'delivery_radius',
        'shipping_address',
        'billing_address',
        'client_public_id',
        'profile_image',
        'isDeleted',
        'notes',
        'delivery_zones',
        'company_name'
    ];

    protected $hidden = ['password', 'remember_token'];
    protected $casts = [
        'isDeleted' => 'boolean',
        'lat' => 'float',
        'long' => 'float',
        'delivery_zones' => 'array',
    ];


    // If it's stored as TEXT and not JSON type, use accessor:
    public function getDeliveryZonesAttribute($value)
    {
        return $value ? json_decode($value, true) : [];
    }

    public function company()
    {
        return $this->belongsTo(Company::class);
    }

    public function projects()
    {
        return $this->hasMany(Projects::class, 'added_by');  // 'added_by' is the foreign key
    }

    public function supplierOffers()
    {
        return $this->hasMany(SupplierOffers::class, 'supplier_id'); // 'supplier_id' is the foreign key in SupplierOffer
    }
}


------------------------------------------------------------
FILE: app/Providers/AppServiceProvider.php
------------------------------------------------------------
<?php

namespace App\Providers;

use Illuminate\Support\ServiceProvider;

class AppServiceProvider extends ServiceProvider
{
    /**
     * Register any application services.
     */
    public function register(): void
    {
        //
    }

    /**
     * Bootstrap any application services.
     */
    public function boot(): void
    {
        //
    }
}


------------------------------------------------------------
FILE: app/Services/OrderPricingService.php
------------------------------------------------------------
<?php

namespace App\Services;

use App\Models\Orders;
use App\Models\OrderItem;
use Illuminate\Support\Facades\DB;

class OrderPricingService
{
    /**
     * Recalculate customer-facing pricing when admin edits item price/discount/quoted price.
     * Supplier totals remain unchanged.
     *
     * @param  Orders $order  Loaded order with items relation (or will lazy-load).
     * @param  float|null $adminMargin  Override admin margin (default 0.50).
     * @param  float|null $gstRate      Override GST rate (default 0.05).
     * @param  bool $save               Persist changes.
     * @return Orders
     */
    public static function recalcCustomer(Orders $order, ?float $adminMargin = null, ?float $gstRate = null, bool $save = true): Orders
    {
        $ADMIN_MARGIN = $adminMargin ?? 0.50; // 50%
        $GST_RATE     = $gstRate     ?? 0.10; // 10%

        // Ensure items loaded
        $order->loadMissing(['items:id,order_id,quantity,supplier_unit_cost,supplier_discount,is_quoted,quoted_price,delivery_type,delivery_cost']);

        // 1) Rebuild customer_item_cost from items only
        $customer_item_cost = 0.0;
        $allItems = OrderItem::where('order_id',$order->id)->get();
        foreach ($allItems as $item) {
        
            if ((int)$item->is_quoted === 1 && $item->quoted_price !== null) {
  
                $customer_item_cost += (float)$item->quoted_price;
                continue;
            }
           
            $base_material = ($item->supplier_unit_cost * $item->quantity) - $item->supplier_discount;
            if ($base_material < 0) { $base_material = 0; }
     
            $customer_item_cost += $base_material * (1 + $ADMIN_MARGIN);
        }
     

        // 2) Keep existing customer_delivery_cost and supplier totals unchanged
        $customer_delivery_cost = (float) ($order->customer_delivery_cost ?? 0);
        $supplier_item_cost     = (float) ($order->supplier_item_cost ?? 0);
        $supplier_delivery_cost = (float) ($order->supplier_delivery_cost ?? 0);

        // 3) Recompute GST and totals
        $gst_tax = ($customer_item_cost + $customer_delivery_cost) * $GST_RATE;

        $discount      = (float) ($order->discount ?? 0);
        $other_charges = (float) ($order->other_charges ?? 0);

        $total_price = $customer_item_cost
                     + $customer_delivery_cost
                     + $gst_tax
                     - $discount
                     + $other_charges;

        // 4) Profit metrics based on frozen supplier totals
        $supplier_total        = $supplier_item_cost + $supplier_delivery_cost;
        $profit_before_tax     = $total_price - $supplier_total - $gst_tax - $other_charges;
        $profit_margin_percent = $supplier_total > 0 ? ($profit_before_tax / $supplier_total) : 0.0;
        // dd($total_price,$supplier_total,$gst_tax,$discount,$other_charges,$profit_before_tax, $profit_margin_percent);

        // 5) Persist
        $order->customer_item_cost     = round($customer_item_cost, 2);
        // customer_delivery_cost unchanged
        $order->gst_tax                = round($gst_tax, 2);
        $order->total_price            = round($total_price, 2);
        $order->profit_margin_percent  = $profit_margin_percent;
        $order->profit_amount          = round($profit_before_tax, 2); // actual profit amount
        
        if ($save) {
            DB::transaction(function () use ($order) {
                $order->save();
            });
        }

        return $order;
    }
}


------------------------------------------------------------
FILE: app/Services/Payments/LiveGroup.php
------------------------------------------------------------
<?php
namespace App\Services\Payments;

use GuzzleHttp\Client;
use Illuminate\Support\Facades\Config;

class LiveGroup {
  private Client $http; private string $merchant; private string $apiKey;
  public function __construct() {
    $this->merchant = Config::get('livegroup.merchant_id');
    $this->apiKey   = Config::get('livegroup.api_key');
    $this->http     = new Client([
      'base_uri' => Config::get('livegroup.base_url'),
      'timeout'  => Config::get('livegroup.timeout'),
    ]);
  }
  public function createIntent(array $payload): array {
    return $this->req('POST', '/v1/payments/intents', $payload);
  }
  public function getIntent(string $intentId): array {
    return $this->req('GET', "/v1/payments/intents/{$intentId}");
  }
  private function req(string $m, string $path, array $json=[]): array {
    $res = $this->http->request($m, $path, [
      'headers' => [
        'Authorization' => "Bearer {$this->apiKey}",
        'X-Merchant-Id' => $this->merchant,
        'Accept' => 'application/json',
      ],
      'json' => $json ?: null,
    ]);
    return json_decode((string)$res->getBody(), true);
  }
}


------------------------------------------------------------
FILE: bootstrap/app.php
------------------------------------------------------------
<?php

use Illuminate\Foundation\Application;
use Illuminate\Foundation\Configuration\Exceptions;
use Illuminate\Foundation\Configuration\Middleware;

return Application::configure(basePath: dirname(__DIR__))
    ->withRouting(
        web: __DIR__.'/../routes/web.php',
        api: __DIR__.'/../routes/api.php',
        commands: __DIR__.'/../routes/console.php',
        health: '/up',
    )
    ->withMiddleware(function (Middleware $middleware) {
        $middleware->use([
            // App\Http\Middleware\AuthMiddleware::class,
            // App\Http\Middleware\isAdmin::class,
        ]);
    })
    ->withExceptions(function (Exceptions $exceptions) {
        //
    })
    ->create();

------------------------------------------------------------
FILE: bootstrap/providers.php
------------------------------------------------------------
<?php

return [
    App\Providers\AppServiceProvider::class,
];


------------------------------------------------------------
FILE: config/app.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Application Name
    |--------------------------------------------------------------------------
    |
    | This value is the name of your application, which will be used when the
    | framework needs to place the application's name in a notification or
    | other UI elements where an application name needs to be displayed.
    |
    */

    'name' => env('APP_NAME', 'Laravel'),

    /*
    |--------------------------------------------------------------------------
    | Application Environment
    |--------------------------------------------------------------------------
    |
    | This value determines the "environment" your application is currently
    | running in. This may determine how you prefer to configure various
    | services the application utilizes. Set this in your ".env" file.
    |
    */

    'env' => env('APP_ENV', 'production'),

    /*
    |--------------------------------------------------------------------------
    | Application Debug Mode
    |--------------------------------------------------------------------------
    |
    | When your application is in debug mode, detailed error messages with
    | stack traces will be shown on every error that occurs within your
    | application. If disabled, a simple generic error page is shown.
    |
    */

    'debug' => (bool) env('APP_DEBUG', false),

    /*
    |--------------------------------------------------------------------------
    | Application URL
    |--------------------------------------------------------------------------
    |
    | This URL is used by the console to properly generate URLs when using
    | the Artisan command line tool. You should set this to the root of
    | the application so that it's available within Artisan commands.
    |
    */

    'url' => env('APP_URL', 'http://localhost'),

    /*
    |--------------------------------------------------------------------------
    | Application Timezone
    |--------------------------------------------------------------------------
    |
    | Here you may specify the default timezone for your application, which
    | will be used by the PHP date and date-time functions. The timezone
    | is set to "UTC" by default as it is suitable for most use cases.
    |
    */

    'timezone' => 'UTC',

    /*
    |--------------------------------------------------------------------------
    | Application Locale Configuration
    |--------------------------------------------------------------------------
    |
    | The application locale determines the default locale that will be used
    | by Laravel's translation / localization methods. This option can be
    | set to any locale for which you plan to have translation strings.
    |
    */

    'locale' => env('APP_LOCALE', 'en'),

    'fallback_locale' => env('APP_FALLBACK_LOCALE', 'en'),

    'faker_locale' => env('APP_FAKER_LOCALE', 'en_US'),

    /*
    |--------------------------------------------------------------------------
    | Encryption Key
    |--------------------------------------------------------------------------
    |
    | This key is utilized by Laravel's encryption services and should be set
    | to a random, 32 character string to ensure that all encrypted values
    | are secure. You should do this prior to deploying the application.
    |
    */

    'cipher' => 'AES-256-CBC',

    'key' => env('APP_KEY'),

    'previous_keys' => [
        ...array_filter(
            explode(',', (string) env('APP_PREVIOUS_KEYS', ''))
        ),
    ],

    /*
    |--------------------------------------------------------------------------
    | Maintenance Mode Driver
    |--------------------------------------------------------------------------
    |
    | These configuration options determine the driver used to determine and
    | manage Laravel's "maintenance mode" status. The "cache" driver will
    | allow maintenance mode to be controlled across multiple machines.
    |
    | Supported drivers: "file", "cache"
    |
    */

    'maintenance' => [
        'driver' => env('APP_MAINTENANCE_DRIVER', 'file'),
        'store' => env('APP_MAINTENANCE_STORE', 'database'),
    ],

];


------------------------------------------------------------
FILE: config/auth.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Authentication Defaults
    |--------------------------------------------------------------------------
    |
    | This option defines the default authentication "guard" and password
    | reset "broker" for your application. You may change these values
    | as required, but they're a perfect start for most applications.
    |
    */

    'defaults' => [
        'guard' => env('AUTH_GUARD', 'web'),
        'passwords' => env('AUTH_PASSWORD_BROKER', 'users'),
    ],

    /*
    |--------------------------------------------------------------------------
    | Authentication Guards
    |--------------------------------------------------------------------------
    |
    | Next, you may define every authentication guard for your application.
    | Of course, a great default configuration has been defined for you
    | which utilizes session storage plus the Eloquent user provider.
    |
    | All authentication guards have a user provider, which defines how the
    | users are actually retrieved out of your database or other storage
    | system used by the application. Typically, Eloquent is utilized.
    |
    | Supported: "session"
    |
    */

    'guards' => [
        'web' => [
            'driver' => 'session',
            'provider' => 'users',
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | User Providers
    |--------------------------------------------------------------------------
    |
    | All authentication guards have a user provider, which defines how the
    | users are actually retrieved out of your database or other storage
    | system used by the application. Typically, Eloquent is utilized.
    |
    | If you have multiple user tables or models you may configure multiple
    | providers to represent the model / table. These providers may then
    | be assigned to any extra authentication guards you have defined.
    |
    | Supported: "database", "eloquent"
    |
    */

    'providers' => [
        'users' => [
            'driver' => 'eloquent',
            'model' => env('AUTH_MODEL', App\Models\User::class),
        ],

        // 'users' => [
        //     'driver' => 'database',
        //     'table' => 'users',
        // ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Resetting Passwords
    |--------------------------------------------------------------------------
    |
    | These configuration options specify the behavior of Laravel's password
    | reset functionality, including the table utilized for token storage
    | and the user provider that is invoked to actually retrieve users.
    |
    | The expiry time is the number of minutes that each reset token will be
    | considered valid. This security feature keeps tokens short-lived so
    | they have less time to be guessed. You may change this as needed.
    |
    | The throttle setting is the number of seconds a user must wait before
    | generating more password reset tokens. This prevents the user from
    | quickly generating a very large amount of password reset tokens.
    |
    */

    'passwords' => [
        'users' => [
            'provider' => 'users',
            'table' => env('AUTH_PASSWORD_RESET_TOKEN_TABLE', 'password_reset_tokens'),
            'expire' => 60,
            'throttle' => 60,
        ],
    ],

    /*
    |--------------------------------------------------------------------------
    | Password Confirmation Timeout
    |--------------------------------------------------------------------------
    |
    | Here you may define the number of seconds before a password confirmation
    | window expires and users are asked to re-enter their password via the
    | confirmation screen. By default, the timeout lasts for three hours.
    |
    */

    'password_timeout' => env('AUTH_PASSWORD_TIMEOUT', 10800),

];


------------------------------------------------------------
FILE: config/cache.php
------------------------------------------------------------
<?php

use Illuminate\Support\Str;

return [

    /*
    |--------------------------------------------------------------------------
    | Default Cache Store
    |--------------------------------------------------------------------------
    |
    | This option controls the default cache store that will be used by the
    | framework. This connection is utilized if another isn't explicitly
    | specified when running a cache operation inside the application.
    |
    */

    'default' => env('CACHE_STORE', 'database'),

    /*
    |--------------------------------------------------------------------------
    | Cache Stores
    |--------------------------------------------------------------------------
    |
    | Here you may define all of the cache "stores" for your application as
    | well as their drivers. You may even define multiple stores for the
    | same cache driver to group types of items stored in your caches.
    |
    | Supported drivers: "array", "database", "file", "memcached",
    |                    "redis", "dynamodb", "octane", "null"
    |
    */

    'stores' => [

        'array' => [
            'driver' => 'array',
            'serialize' => false,
        ],

        'database' => [
            'driver' => 'database',
            'connection' => env('DB_CACHE_CONNECTION'),
            'table' => env('DB_CACHE_TABLE', 'cache'),
            'lock_connection' => env('DB_CACHE_LOCK_CONNECTION'),
            'lock_table' => env('DB_CACHE_LOCK_TABLE'),
        ],

        'file' => [
            'driver' => 'file',
            'path' => storage_path('framework/cache/data'),
            'lock_path' => storage_path('framework/cache/data'),
        ],

        'memcached' => [
            'driver' => 'memcached',
            'persistent_id' => env('MEMCACHED_PERSISTENT_ID'),
            'sasl' => [
                env('MEMCACHED_USERNAME'),
                env('MEMCACHED_PASSWORD'),
            ],
            'options' => [
                // Memcached::OPT_CONNECT_TIMEOUT => 2000,
            ],
            'servers' => [
                [
                    'host' => env('MEMCACHED_HOST', '127.0.0.1'),
                    'port' => env('MEMCACHED_PORT', 11211),
                    'weight' => 100,
                ],
            ],
        ],

        'redis' => [
            'driver' => 'redis',
            'connection' => env('REDIS_CACHE_CONNECTION', 'cache'),
            'lock_connection' => env('REDIS_CACHE_LOCK_CONNECTION', 'default'),
        ],

        'dynamodb' => [
            'driver' => 'dynamodb',
            'key' => env('AWS_ACCESS_KEY_ID'),
            'secret' => env('AWS_SECRET_ACCESS_KEY'),
            'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
            'table' => env('DYNAMODB_CACHE_TABLE', 'cache'),
            'endpoint' => env('DYNAMODB_ENDPOINT'),
        ],

        'octane' => [
            'driver' => 'octane',
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Cache Key Prefix
    |--------------------------------------------------------------------------
    |
    | When utilizing the APC, database, memcached, Redis, and DynamoDB cache
    | stores, there might be other applications using the same cache. For
    | that reason, you may prefix every cache key to avoid collisions.
    |
    */

    'prefix' => env('CACHE_PREFIX', Str::slug((string) env('APP_NAME', 'laravel')).'-cache-'),

];


------------------------------------------------------------
FILE: config/database.php
------------------------------------------------------------
<?php

use Illuminate\Support\Str;

return [

    /*
    |--------------------------------------------------------------------------
    | Default Database Connection Name
    |--------------------------------------------------------------------------
    |
    | Here you may specify which of the database connections below you wish
    | to use as your default connection for database operations. This is
    | the connection which will be utilized unless another connection
    | is explicitly specified when you execute a query / statement.
    |
    */

    'default' => env('DB_CONNECTION', 'sqlite'),

    /*
    |--------------------------------------------------------------------------
    | Database Connections
    |--------------------------------------------------------------------------
    |
    | Below are all of the database connections defined for your application.
    | An example configuration is provided for each database system which
    | is supported by Laravel. You're free to add / remove connections.
    |
    */

    'connections' => [

        'sqlite' => [
            'driver' => 'sqlite',
            'url' => env('DB_URL'),
            'database' => env('DB_DATABASE', database_path('database.sqlite')),
            'prefix' => '',
            'foreign_key_constraints' => env('DB_FOREIGN_KEYS', true),
            'busy_timeout' => null,
            'journal_mode' => null,
            'synchronous' => null,
            'transaction_mode' => 'DEFERRED',
        ],

        'mysql' => [
            'driver' => 'mysql',
            'url' => env('DB_URL'),
            'host' => env('DB_HOST', '127.0.0.1'),
            'port' => env('DB_PORT', '3306'),
            'database' => env('DB_DATABASE', 'laravel'),
            'username' => env('DB_USERNAME', 'root'),
            'password' => env('DB_PASSWORD', ''),
            'unix_socket' => env('DB_SOCKET', ''),
            'charset' => env('DB_CHARSET', 'utf8mb4'),
            'collation' => env('DB_COLLATION', 'utf8mb4_unicode_ci'),
            'prefix' => '',
            'prefix_indexes' => true,
            'strict' => true,
            'engine' => null,
            'options' => extension_loaded('pdo_mysql') ? array_filter([
                PDO::MYSQL_ATTR_SSL_CA => env('MYSQL_ATTR_SSL_CA'),
            ]) : [],
        ],

        'mariadb' => [
            'driver' => 'mariadb',
            'url' => env('DB_URL'),
            'host' => env('DB_HOST', '127.0.0.1'),
            'port' => env('DB_PORT', '3306'),
            'database' => env('DB_DATABASE', 'laravel'),
            'username' => env('DB_USERNAME', 'root'),
            'password' => env('DB_PASSWORD', ''),
            'unix_socket' => env('DB_SOCKET', ''),
            'charset' => env('DB_CHARSET', 'utf8mb4'),
            'collation' => env('DB_COLLATION', 'utf8mb4_unicode_ci'),
            'prefix' => '',
            'prefix_indexes' => true,
            'strict' => true,
            'engine' => null,
            'options' => extension_loaded('pdo_mysql') ? array_filter([
                PDO::MYSQL_ATTR_SSL_CA => env('MYSQL_ATTR_SSL_CA'),
            ]) : [],
        ],

        'pgsql' => [
            'driver' => 'pgsql',
            'url' => env('DB_URL'),
            'host' => env('DB_HOST', '127.0.0.1'),
            'port' => env('DB_PORT', '5432'),
            'database' => env('DB_DATABASE', 'laravel'),
            'username' => env('DB_USERNAME', 'root'),
            'password' => env('DB_PASSWORD', ''),
            'charset' => env('DB_CHARSET', 'utf8'),
            'prefix' => '',
            'prefix_indexes' => true,
            'search_path' => 'public',
            'sslmode' => 'prefer',
        ],

        'sqlsrv' => [
            'driver' => 'sqlsrv',
            'url' => env('DB_URL'),
            'host' => env('DB_HOST', 'localhost'),
            'port' => env('DB_PORT', '1433'),
            'database' => env('DB_DATABASE', 'laravel'),
            'username' => env('DB_USERNAME', 'root'),
            'password' => env('DB_PASSWORD', ''),
            'charset' => env('DB_CHARSET', 'utf8'),
            'prefix' => '',
            'prefix_indexes' => true,
            // 'encrypt' => env('DB_ENCRYPT', 'yes'),
            // 'trust_server_certificate' => env('DB_TRUST_SERVER_CERTIFICATE', 'false'),
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Migration Repository Table
    |--------------------------------------------------------------------------
    |
    | This table keeps track of all the migrations that have already run for
    | your application. Using this information, we can determine which of
    | the migrations on disk haven't actually been run on the database.
    |
    */

    'migrations' => [
        'table' => 'migrations',
        'update_date_on_publish' => true,
    ],

    /*
    |--------------------------------------------------------------------------
    | Redis Databases
    |--------------------------------------------------------------------------
    |
    | Redis is an open source, fast, and advanced key-value store that also
    | provides a richer body of commands than a typical key-value system
    | such as Memcached. You may define your connection settings here.
    |
    */

    'redis' => [

        'client' => env('REDIS_CLIENT', 'phpredis'),

        'options' => [
            'cluster' => env('REDIS_CLUSTER', 'redis'),
            'prefix' => env('REDIS_PREFIX', Str::slug((string) env('APP_NAME', 'laravel')).'-database-'),
            'persistent' => env('REDIS_PERSISTENT', false),
        ],

        'default' => [
            'url' => env('REDIS_URL'),
            'host' => env('REDIS_HOST', '127.0.0.1'),
            'username' => env('REDIS_USERNAME'),
            'password' => env('REDIS_PASSWORD'),
            'port' => env('REDIS_PORT', '6379'),
            'database' => env('REDIS_DB', '0'),
            'max_retries' => env('REDIS_MAX_RETRIES', 3),
            'backoff_algorithm' => env('REDIS_BACKOFF_ALGORITHM', 'decorrelated_jitter'),
            'backoff_base' => env('REDIS_BACKOFF_BASE', 100),
            'backoff_cap' => env('REDIS_BACKOFF_CAP', 1000),
        ],

        'cache' => [
            'url' => env('REDIS_URL'),
            'host' => env('REDIS_HOST', '127.0.0.1'),
            'username' => env('REDIS_USERNAME'),
            'password' => env('REDIS_PASSWORD'),
            'port' => env('REDIS_PORT', '6379'),
            'database' => env('REDIS_CACHE_DB', '1'),
            'max_retries' => env('REDIS_MAX_RETRIES', 3),
            'backoff_algorithm' => env('REDIS_BACKOFF_ALGORITHM', 'decorrelated_jitter'),
            'backoff_base' => env('REDIS_BACKOFF_BASE', 100),
            'backoff_cap' => env('REDIS_BACKOFF_CAP', 1000),
        ],

    ],

];


------------------------------------------------------------
FILE: config/filesystems.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Default Filesystem Disk
    |--------------------------------------------------------------------------
    |
    | Here you may specify the default filesystem disk that should be used
    | by the framework. The "local" disk, as well as a variety of cloud
    | based disks are available to your application for file storage.
    |
    */

    'default' => env('FILESYSTEM_DISK', 'local'),

    /*
    |--------------------------------------------------------------------------
    | Filesystem Disks
    |--------------------------------------------------------------------------
    |
    | Below you may configure as many filesystem disks as necessary, and you
    | may even configure multiple disks for the same driver. Examples for
    | most supported storage drivers are configured here for reference.
    |
    | Supported drivers: "local", "ftp", "sftp", "s3"
    |
    */

    'disks' => [

        'local' => [
            'driver' => 'local',
            'root' => storage_path('app/private'),
            'serve' => true,
            'throw' => false,
            'report' => false,
        ],

        'public' => [
            'driver' => 'local',
            'root' => storage_path('app/public'),
            'url' => env('APP_URL').'/storage',
            'visibility' => 'public',
            'throw' => false,
            'report' => false,
        ],

        's3' => [
            'driver' => 's3',
            'key' => env('AWS_ACCESS_KEY_ID'),
            'secret' => env('AWS_SECRET_ACCESS_KEY'),
            'region' => env('AWS_DEFAULT_REGION'),
            'bucket' => env('AWS_BUCKET'),
            'url' => env('AWS_URL'),
            'endpoint' => env('AWS_ENDPOINT'),
            'use_path_style_endpoint' => env('AWS_USE_PATH_STYLE_ENDPOINT', false),
            'throw' => false,
            'report' => false,
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Symbolic Links
    |--------------------------------------------------------------------------
    |
    | Here you may configure the symbolic links that will be created when the
    | `storage:link` Artisan command is executed. The array keys should be
    | the locations of the links and the values should be their targets.
    |
    */

    'links' => [
        public_path('storage') => storage_path('app/public'),
    ],

];


------------------------------------------------------------
FILE: config/livegroup.php
------------------------------------------------------------
<?php
return [
  'merchant_id' => env('LIVEGROUP_MERCHANT_ID'),
  'api_key'     => env('LIVEGROUP_API_KEY'),
  'base_url'    => rtrim(env('LIVEGROUP_BASE_URL',''),'/'),
  'timeout'     => 15,
];


------------------------------------------------------------
FILE: config/logging.php
------------------------------------------------------------
<?php

use Monolog\Handler\NullHandler;
use Monolog\Handler\StreamHandler;
use Monolog\Handler\SyslogUdpHandler;
use Monolog\Processor\PsrLogMessageProcessor;

return [

    /*
    |--------------------------------------------------------------------------
    | Default Log Channel
    |--------------------------------------------------------------------------
    |
    | This option defines the default log channel that is utilized to write
    | messages to your logs. The value provided here should match one of
    | the channels present in the list of "channels" configured below.
    |
    */

    'default' => env('LOG_CHANNEL', 'stack'),

    /*
    |--------------------------------------------------------------------------
    | Deprecations Log Channel
    |--------------------------------------------------------------------------
    |
    | This option controls the log channel that should be used to log warnings
    | regarding deprecated PHP and library features. This allows you to get
    | your application ready for upcoming major versions of dependencies.
    |
    */

    'deprecations' => [
        'channel' => env('LOG_DEPRECATIONS_CHANNEL', 'null'),
        'trace' => env('LOG_DEPRECATIONS_TRACE', false),
    ],

    /*
    |--------------------------------------------------------------------------
    | Log Channels
    |--------------------------------------------------------------------------
    |
    | Here you may configure the log channels for your application. Laravel
    | utilizes the Monolog PHP logging library, which includes a variety
    | of powerful log handlers and formatters that you're free to use.
    |
    | Available drivers: "single", "daily", "slack", "syslog",
    |                    "errorlog", "monolog", "custom", "stack"
    |
    */

    'channels' => [

        'stack' => [
            'driver' => 'stack',
            'channels' => explode(',', (string) env('LOG_STACK', 'single')),
            'ignore_exceptions' => false,
        ],

        'single' => [
            'driver' => 'single',
            'path' => storage_path('logs/laravel.log'),
            'level' => env('LOG_LEVEL', 'debug'),
            'replace_placeholders' => true,
        ],

        'daily' => [
            'driver' => 'daily',
            'path' => storage_path('logs/laravel.log'),
            'level' => env('LOG_LEVEL', 'debug'),
            'days' => env('LOG_DAILY_DAYS', 14),
            'replace_placeholders' => true,
        ],

        'slack' => [
            'driver' => 'slack',
            'url' => env('LOG_SLACK_WEBHOOK_URL'),
            'username' => env('LOG_SLACK_USERNAME', 'Laravel Log'),
            'emoji' => env('LOG_SLACK_EMOJI', ':boom:'),
            'level' => env('LOG_LEVEL', 'critical'),
            'replace_placeholders' => true,
        ],

        'papertrail' => [
            'driver' => 'monolog',
            'level' => env('LOG_LEVEL', 'debug'),
            'handler' => env('LOG_PAPERTRAIL_HANDLER', SyslogUdpHandler::class),
            'handler_with' => [
                'host' => env('PAPERTRAIL_URL'),
                'port' => env('PAPERTRAIL_PORT'),
                'connectionString' => 'tls://'.env('PAPERTRAIL_URL').':'.env('PAPERTRAIL_PORT'),
            ],
            'processors' => [PsrLogMessageProcessor::class],
        ],

        'stderr' => [
            'driver' => 'monolog',
            'level' => env('LOG_LEVEL', 'debug'),
            'handler' => StreamHandler::class,
            'handler_with' => [
                'stream' => 'php://stderr',
            ],
            'formatter' => env('LOG_STDERR_FORMATTER'),
            'processors' => [PsrLogMessageProcessor::class],
        ],

        'syslog' => [
            'driver' => 'syslog',
            'level' => env('LOG_LEVEL', 'debug'),
            'facility' => env('LOG_SYSLOG_FACILITY', LOG_USER),
            'replace_placeholders' => true,
        ],

        'errorlog' => [
            'driver' => 'errorlog',
            'level' => env('LOG_LEVEL', 'debug'),
            'replace_placeholders' => true,
        ],

        'null' => [
            'driver' => 'monolog',
            'handler' => NullHandler::class,
        ],

        'emergency' => [
            'path' => storage_path('logs/laravel.log'),
        ],

    ],

];


------------------------------------------------------------
FILE: config/mail.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Default Mailer
    |--------------------------------------------------------------------------
    |
    | This option controls the default mailer that is used to send all email
    | messages unless another mailer is explicitly specified when sending
    | the message. All additional mailers can be configured within the
    | "mailers" array. Examples of each type of mailer are provided.
    |
    */

    'default' => env('MAIL_MAILER', 'log'),

    /*
    |--------------------------------------------------------------------------
    | Mailer Configurations
    |--------------------------------------------------------------------------
    |
    | Here you may configure all of the mailers used by your application plus
    | their respective settings. Several examples have been configured for
    | you and you are free to add your own as your application requires.
    |
    | Laravel supports a variety of mail "transport" drivers that can be used
    | when delivering an email. You may specify which one you're using for
    | your mailers below. You may also add additional mailers if needed.
    |
    | Supported: "smtp", "sendmail", "mailgun", "ses", "ses-v2",
    |            "postmark", "resend", "log", "array",
    |            "failover", "roundrobin"
    |
    */

    'mailers' => [

        'smtp' => [
            'transport' => 'smtp',
            'scheme' => env('MAIL_SCHEME'),
            'url' => env('MAIL_URL'),
            'host' => env('MAIL_HOST', '127.0.0.1'),
            'port' => env('MAIL_PORT', 2525),
            'username' => env('MAIL_USERNAME'),
            'password' => env('MAIL_PASSWORD'),
            'timeout' => null,
            'local_domain' => env('MAIL_EHLO_DOMAIN', parse_url((string) env('APP_URL', 'http://localhost'), PHP_URL_HOST)),
        ],

        'ses' => [
            'transport' => 'ses',
        ],

        'postmark' => [
            'transport' => 'postmark',
            // 'message_stream_id' => env('POSTMARK_MESSAGE_STREAM_ID'),
            // 'client' => [
            //     'timeout' => 5,
            // ],
        ],

        'resend' => [
            'transport' => 'resend',
        ],

        'sendmail' => [
            'transport' => 'sendmail',
            'path' => env('MAIL_SENDMAIL_PATH', '/usr/sbin/sendmail -bs -i'),
        ],

        'log' => [
            'transport' => 'log',
            'channel' => env('MAIL_LOG_CHANNEL'),
        ],

        'array' => [
            'transport' => 'array',
        ],

        'failover' => [
            'transport' => 'failover',
            'mailers' => [
                'smtp',
                'log',
            ],
            'retry_after' => 60,
        ],

        'roundrobin' => [
            'transport' => 'roundrobin',
            'mailers' => [
                'ses',
                'postmark',
            ],
            'retry_after' => 60,
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Global "From" Address
    |--------------------------------------------------------------------------
    |
    | You may wish for all emails sent by your application to be sent from
    | the same address. Here you may specify a name and address that is
    | used globally for all emails that are sent by your application.
    |
    */

    'from' => [
        'address' => env('MAIL_FROM_ADDRESS', 'hello@example.com'),
        'name' => env('MAIL_FROM_NAME', 'Example'),
    ],

];


------------------------------------------------------------
FILE: config/queue.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Default Queue Connection Name
    |--------------------------------------------------------------------------
    |
    | Laravel's queue supports a variety of backends via a single, unified
    | API, giving you convenient access to each backend using identical
    | syntax for each. The default queue connection is defined below.
    |
    */

    'default' => env('QUEUE_CONNECTION', 'database'),

    /*
    |--------------------------------------------------------------------------
    | Queue Connections
    |--------------------------------------------------------------------------
    |
    | Here you may configure the connection options for every queue backend
    | used by your application. An example configuration is provided for
    | each backend supported by Laravel. You're also free to add more.
    |
    | Drivers: "sync", "database", "beanstalkd", "sqs", "redis", "null"
    |
    */

    'connections' => [

        'sync' => [
            'driver' => 'sync',
        ],

        'database' => [
            'driver' => 'database',
            'connection' => env('DB_QUEUE_CONNECTION'),
            'table' => env('DB_QUEUE_TABLE', 'jobs'),
            'queue' => env('DB_QUEUE', 'default'),
            'retry_after' => (int) env('DB_QUEUE_RETRY_AFTER', 90),
            'after_commit' => false,
        ],

        'beanstalkd' => [
            'driver' => 'beanstalkd',
            'host' => env('BEANSTALKD_QUEUE_HOST', 'localhost'),
            'queue' => env('BEANSTALKD_QUEUE', 'default'),
            'retry_after' => (int) env('BEANSTALKD_QUEUE_RETRY_AFTER', 90),
            'block_for' => 0,
            'after_commit' => false,
        ],

        'sqs' => [
            'driver' => 'sqs',
            'key' => env('AWS_ACCESS_KEY_ID'),
            'secret' => env('AWS_SECRET_ACCESS_KEY'),
            'prefix' => env('SQS_PREFIX', 'https://sqs.us-east-1.amazonaws.com/your-account-id'),
            'queue' => env('SQS_QUEUE', 'default'),
            'suffix' => env('SQS_SUFFIX'),
            'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
            'after_commit' => false,
        ],

        'redis' => [
            'driver' => 'redis',
            'connection' => env('REDIS_QUEUE_CONNECTION', 'default'),
            'queue' => env('REDIS_QUEUE', 'default'),
            'retry_after' => (int) env('REDIS_QUEUE_RETRY_AFTER', 90),
            'block_for' => null,
            'after_commit' => false,
        ],

    ],

    /*
    |--------------------------------------------------------------------------
    | Job Batching
    |--------------------------------------------------------------------------
    |
    | The following options configure the database and table that store job
    | batching information. These options can be updated to any database
    | connection and table which has been defined by your application.
    |
    */

    'batching' => [
        'database' => env('DB_CONNECTION', 'sqlite'),
        'table' => 'job_batches',
    ],

    /*
    |--------------------------------------------------------------------------
    | Failed Queue Jobs
    |--------------------------------------------------------------------------
    |
    | These options configure the behavior of failed queue job logging so you
    | can control how and where failed jobs are stored. Laravel ships with
    | support for storing failed jobs in a simple file or in a database.
    |
    | Supported drivers: "database-uuids", "dynamodb", "file", "null"
    |
    */

    'failed' => [
        'driver' => env('QUEUE_FAILED_DRIVER', 'database-uuids'),
        'database' => env('DB_CONNECTION', 'sqlite'),
        'table' => 'failed_jobs',
    ],

];


------------------------------------------------------------
FILE: config/sanctum.php
------------------------------------------------------------
<?php

use Laravel\Sanctum\Sanctum;

return [

    /*
    |--------------------------------------------------------------------------
    | Stateful Domains
    |--------------------------------------------------------------------------
    |
    | Requests from the following domains / hosts will receive stateful API
    | authentication cookies. Typically, these should include your local
    | and production domains which access your API via a frontend SPA.
    |
    */

    'stateful' => explode(',', env('SANCTUM_STATEFUL_DOMAINS', sprintf(
        '%s%s',
        'localhost,localhost:3000,127.0.0.1,127.0.0.1:8000,::1',
        Sanctum::currentApplicationUrlWithPort(),
        // Sanctum::currentRequestHost(),
    ))),

    /*
    |--------------------------------------------------------------------------
    | Sanctum Guards
    |--------------------------------------------------------------------------
    |
    | This array contains the authentication guards that will be checked when
    | Sanctum is trying to authenticate a request. If none of these guards
    | are able to authenticate the request, Sanctum will use the bearer
    | token that's present on an incoming request for authentication.
    |
    */

    'guard' => ['web'],

    /*
    |--------------------------------------------------------------------------
    | Expiration Minutes
    |--------------------------------------------------------------------------
    |
    | This value controls the number of minutes until an issued token will be
    | considered expired. This will override any values set in the token's
    | "expires_at" attribute, but first-party sessions are not affected.
    |
    */

    'expiration' => null,

    /*
    |--------------------------------------------------------------------------
    | Token Prefix
    |--------------------------------------------------------------------------
    |
    | Sanctum can prefix new tokens in order to take advantage of numerous
    | security scanning initiatives maintained by open source platforms
    | that notify developers if they commit tokens into repositories.
    |
    | See: https://docs.github.com/en/code-security/secret-scanning/about-secret-scanning
    |
    */

    'token_prefix' => env('SANCTUM_TOKEN_PREFIX', ''),

    /*
    |--------------------------------------------------------------------------
    | Sanctum Middleware
    |--------------------------------------------------------------------------
    |
    | When authenticating your first-party SPA with Sanctum you may need to
    | customize some of the middleware Sanctum uses while processing the
    | request. You may change the middleware listed below as required.
    |
    */

    'middleware' => [
        'authenticate_session' => Laravel\Sanctum\Http\Middleware\AuthenticateSession::class,
        'encrypt_cookies' => Illuminate\Cookie\Middleware\EncryptCookies::class,
        'validate_csrf_token' => Illuminate\Foundation\Http\Middleware\ValidateCsrfToken::class,
    ],

];


------------------------------------------------------------
FILE: config/services.php
------------------------------------------------------------
<?php

return [

    /*
    |--------------------------------------------------------------------------
    | Third Party Services
    |--------------------------------------------------------------------------
    |
    | This file is for storing the credentials for third party services such
    | as Mailgun, Postmark, AWS and more. This file provides the de facto
    | location for this type of information, allowing packages to have
    | a conventional file to locate the various service credentials.
    |
    */

    'postmark' => [
        'token' => env('POSTMARK_TOKEN'),
    ],

    'resend' => [
        'key' => env('RESEND_KEY'),
    ],

    'ses' => [
        'key' => env('AWS_ACCESS_KEY_ID'),
        'secret' => env('AWS_SECRET_ACCESS_KEY'),
        'region' => env('AWS_DEFAULT_REGION', 'us-east-1'),
    ],

    'slack' => [
        'notifications' => [
            'bot_user_oauth_token' => env('SLACK_BOT_USER_OAUTH_TOKEN'),
            'channel' => env('SLACK_BOT_USER_DEFAULT_CHANNEL'),
        ],
    ],

];


------------------------------------------------------------
FILE: config/session.php
------------------------------------------------------------
<?php

use Illuminate\Support\Str;

return [

    /*
    |--------------------------------------------------------------------------
    | Default Session Driver
    |--------------------------------------------------------------------------
    |
    | This option determines the default session driver that is utilized for
    | incoming requests. Laravel supports a variety of storage options to
    | persist session data. Database storage is a great default choice.
    |
    | Supported: "file", "cookie", "database", "memcached",
    |            "redis", "dynamodb", "array"
    |
    */

    'driver' => env('SESSION_DRIVER', 'database'),

    /*
    |--------------------------------------------------------------------------
    | Session Lifetime
    |--------------------------------------------------------------------------
    |
    | Here you may specify the number of minutes that you wish the session
    | to be allowed to remain idle before it expires. If you want them
    | to expire immediately when the browser is closed then you may
    | indicate that via the expire_on_close configuration option.
    |
    */

    'lifetime' => (int) env('SESSION_LIFETIME', 120),

    'expire_on_close' => env('SESSION_EXPIRE_ON_CLOSE', false),

    /*
    |--------------------------------------------------------------------------
    | Session Encryption
    |--------------------------------------------------------------------------
    |
    | This option allows you to easily specify that all of your session data
    | should be encrypted before it's stored. All encryption is performed
    | automatically by Laravel and you may use the session like normal.
    |
    */

    'encrypt' => env('SESSION_ENCRYPT', false),

    /*
    |--------------------------------------------------------------------------
    | Session File Location
    |--------------------------------------------------------------------------
    |
    | When utilizing the "file" session driver, the session files are placed
    | on disk. The default storage location is defined here; however, you
    | are free to provide another location where they should be stored.
    |
    */

    'files' => storage_path('framework/sessions'),

    /*
    |--------------------------------------------------------------------------
    | Session Database Connection
    |--------------------------------------------------------------------------
    |
    | When using the "database" or "redis" session drivers, you may specify a
    | connection that should be used to manage these sessions. This should
    | correspond to a connection in your database configuration options.
    |
    */

    'connection' => env('SESSION_CONNECTION'),

    /*
    |--------------------------------------------------------------------------
    | Session Database Table
    |--------------------------------------------------------------------------
    |
    | When using the "database" session driver, you may specify the table to
    | be used to store sessions. Of course, a sensible default is defined
    | for you; however, you're welcome to change this to another table.
    |
    */

    'table' => env('SESSION_TABLE', 'sessions'),

    /*
    |--------------------------------------------------------------------------
    | Session Cache Store
    |--------------------------------------------------------------------------
    |
    | When using one of the framework's cache driven session backends, you may
    | define the cache store which should be used to store the session data
    | between requests. This must match one of your defined cache stores.
    |
    | Affects: "dynamodb", "memcached", "redis"
    |
    */

    'store' => env('SESSION_STORE'),

    /*
    |--------------------------------------------------------------------------
    | Session Sweeping Lottery
    |--------------------------------------------------------------------------
    |
    | Some session drivers must manually sweep their storage location to get
    | rid of old sessions from storage. Here are the chances that it will
    | happen on a given request. By default, the odds are 2 out of 100.
    |
    */

    'lottery' => [2, 100],

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Name
    |--------------------------------------------------------------------------
    |
    | Here you may change the name of the session cookie that is created by
    | the framework. Typically, you should not need to change this value
    | since doing so does not grant a meaningful security improvement.
    |
    */

    // 'cookie' => env(
    //     'SESSION_COOKIE',
    //     Str::slug((string) env('APP_NAME', 'laravel')).'-session'
    // ),
    'cookie' => 'laravel_session',

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Path
    |--------------------------------------------------------------------------
    |
    | The session cookie path determines the path for which the cookie will
    | be regarded as available. Typically, this will be the root path of
    | your application, but you're free to change this when necessary.
    |
    */

    'path' => env('SESSION_PATH', '/'),

    /*
    |--------------------------------------------------------------------------
    | Session Cookie Domain
    |--------------------------------------------------------------------------
    |
    | This value determines the domain and subdomains the session cookie is
    | available to. By default, the cookie will be available to the root
    | domain and all subdomains. Typically, this shouldn't be changed.
    |
    */

    'domain' => env('SESSION_DOMAIN'),

    /*
    |--------------------------------------------------------------------------
    | HTTPS Only Cookies
    |--------------------------------------------------------------------------
    |
    | By setting this option to true, session cookies will only be sent back
    | to the server if the browser has a HTTPS connection. This will keep
    | the cookie from being sent to you when it can't be done securely.
    |
    */

    'secure' => env('SESSION_SECURE_COOKIE'),

    /*
    |--------------------------------------------------------------------------
    | HTTP Access Only
    |--------------------------------------------------------------------------
    |
    | Setting this value to true will prevent JavaScript from accessing the
    | value of the cookie and the cookie will only be accessible through
    | the HTTP protocol. It's unlikely you should disable this option.
    |
    */

    'http_only' => env('SESSION_HTTP_ONLY', true),

    /*
    |--------------------------------------------------------------------------
    | Same-Site Cookies
    |--------------------------------------------------------------------------
    |
    | This option determines how your cookies behave when cross-site requests
    | take place, and can be used to mitigate CSRF attacks. By default, we
    | will set this value to "lax" to permit secure cross-site requests.
    |
    | See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#samesitesamesite-value
    |
    | Supported: "lax", "strict", "none", null
    |
    */

    'same_site' => env('SESSION_SAME_SITE', 'lax'),

    /*
    |--------------------------------------------------------------------------
    | Partitioned Cookies
    |--------------------------------------------------------------------------
    |
    | Setting this value to true will tie the cookie to the top-level site for
    | a cross-site context. Partitioned cookies are accepted by the browser
    | when flagged "secure" and the Same-Site attribute is set to "none".
    |
    */

    'partitioned' => env('SESSION_PARTITIONED_COOKIE', false),

];


------------------------------------------------------------
FILE: database/factories/UserFactory.php
------------------------------------------------------------
<?php

namespace Database\Factories;

use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Facades\Hash;
use Illuminate\Support\Str;

/**
 * @extends \Illuminate\Database\Eloquent\Factories\Factory<\App\Models\User>
 */
class UserFactory extends Factory
{
    /**
     * The current password being used by the factory.
     */
    protected static ?string $password;

    /**
     * Define the model's default state.
     *
     * @return array<string, mixed>
     */
    public function definition(): array
    {
        return [
            'name' => fake()->name(),
            'email' => fake()->unique()->safeEmail(),
            'email_verified_at' => now(),
            'password' => static::$password ??= Hash::make('password'),
            'remember_token' => Str::random(10),
        ];
    }

    /**
     * Indicate that the model's email address should be unverified.
     */
    public function unverified(): static
    {
        return $this->state(fn (array $attributes) => [
            'email_verified_at' => null,
        ]);
    }
}


------------------------------------------------------------
FILE: database/migrations/0001_01_01_000000_create_users_table.php
------------------------------------------------------------
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('users', function (Blueprint $table) {
            $table->id();
            $table->string('name');
            $table->string('email')->unique();
            $table->timestamp('email_verified_at')->nullable();
            $table->string('password');
            $table->rememberToken();
            $table->timestamps();
        });

        Schema::create('password_reset_tokens', function (Blueprint $table) {
            $table->string('email')->primary();
            $table->string('token');
            $table->timestamp('created_at')->nullable();
        });

        Schema::create('sessions', function (Blueprint $table) {
            $table->string('id')->primary();
            $table->foreignId('user_id')->nullable()->index();
            $table->string('ip_address', 45)->nullable();
            $table->text('user_agent')->nullable();
            $table->longText('payload');
            $table->integer('last_activity')->index();
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('users');
        Schema::dropIfExists('password_reset_tokens');
        Schema::dropIfExists('sessions');
    }
};


------------------------------------------------------------
FILE: database/migrations/0001_01_01_000001_create_cache_table.php
------------------------------------------------------------
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('cache', function (Blueprint $table) {
            $table->string('key')->primary();
            $table->mediumText('value');
            $table->integer('expiration');
        });

        Schema::create('cache_locks', function (Blueprint $table) {
            $table->string('key')->primary();
            $table->string('owner');
            $table->integer('expiration');
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('cache');
        Schema::dropIfExists('cache_locks');
    }
};


------------------------------------------------------------
FILE: database/migrations/0001_01_01_000002_create_jobs_table.php
------------------------------------------------------------
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('jobs', function (Blueprint $table) {
            $table->id();
            $table->string('queue')->index();
            $table->longText('payload');
            $table->unsignedTinyInteger('attempts');
            $table->unsignedInteger('reserved_at')->nullable();
            $table->unsignedInteger('available_at');
            $table->unsignedInteger('created_at');
        });

        Schema::create('job_batches', function (Blueprint $table) {
            $table->string('id')->primary();
            $table->string('name');
            $table->integer('total_jobs');
            $table->integer('pending_jobs');
            $table->integer('failed_jobs');
            $table->longText('failed_job_ids');
            $table->mediumText('options')->nullable();
            $table->integer('cancelled_at')->nullable();
            $table->integer('created_at');
            $table->integer('finished_at')->nullable();
        });

        Schema::create('failed_jobs', function (Blueprint $table) {
            $table->id();
            $table->string('uuid')->unique();
            $table->text('connection');
            $table->text('queue');
            $table->longText('payload');
            $table->longText('exception');
            $table->timestamp('failed_at')->useCurrent();
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('jobs');
        Schema::dropIfExists('job_batches');
        Schema::dropIfExists('failed_jobs');
    }
};


------------------------------------------------------------
FILE: database/migrations/2025_10_06_041022_create_personal_access_tokens_table.php
------------------------------------------------------------
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    /**
     * Run the migrations.
     */
    public function up(): void
    {
        Schema::create('personal_access_tokens', function (Blueprint $table) {
            $table->id();
            $table->morphs('tokenable');
            $table->text('name');
            $table->string('token', 64)->unique();
            $table->text('abilities')->nullable();
            $table->timestamp('last_used_at')->nullable();
            $table->timestamp('expires_at')->nullable()->index();
            $table->timestamps();
        });
    }

    /**
     * Reverse the migrations.
     */
    public function down(): void
    {
        Schema::dropIfExists('personal_access_tokens');
    }
};


------------------------------------------------------------
FILE: database/seeders/DatabaseSeeder.php
------------------------------------------------------------
<?php

namespace Database\Seeders;

use App\Models\User;
// use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class DatabaseSeeder extends Seeder
{
    /**
     * Seed the application's database.
     */
    public function run(): void
    {
        // User::factory(10)->create();

        User::factory()->create([
            'name' => 'Test User',
            'email' => 'test@example.com',
        ]);
    }
}


------------------------------------------------------------
FILE: php_views.php
------------------------------------------------------------
<?php
/**
 * Laravel Views to Single File Converter
 * Usage: php convert_views.php /path/to/your/laravel/project
 */

class LaravelViewsConverter
{
    protected $outputFile = 'backend.txt';
    protected $excludedDirs = ['vendor', 'node_modules', 'storage', 'cache'];
    protected $allowedExtensions = ['.blade.php', '.php', '.html', '.css', '.js'];

    public function convert($projectPath)
    {
        $viewsPath = $projectPath . '/';
        
        if (!is_dir($viewsPath)) {
            echo "Error: Views directory not found at: $viewsPath\n";
            return false;
        }

        $output = "LARAVEL VIEWS CONVERSION\n";
        $output .= "Generated: " . date('Y-m-d H:i:s') . "\n";
        $output .= "Project: " . realpath($projectPath) . "\n";
        $output .= str_repeat("=", 80) . "\n\n";

        $this->processDirectory($viewsPath, $output, $viewsPath);

        file_put_contents($this->outputFile, $output);
        
        echo "Success! All views have been converted to: " . $this->outputFile . "\n";
        echo "Total file size: " . number_format(strlen($output)) . " bytes\n";
        
        return true;
    }

    protected function processDirectory($dir, &$output, $basePath)
    {
        $files = scandir($dir);
        
        foreach ($files as $file) {
            if ($file == '.' || $file == '..') continue;
            
            $fullPath = $dir . '/' . $file;
            $relativePath = str_replace($basePath . '/', '', $fullPath);
            
            // Skip excluded directories
            if (is_dir($fullPath)) {
                if (in_array($file, $this->excludedDirs)) continue;
                $this->processDirectory($fullPath, $output, $basePath);
                continue;
            }
            
            // Check file extension
            $includeFile = false;
            foreach ($this->allowedExtensions as $ext) {
                if (str_ends_with($file, $ext)) {
                    $includeFile = true;
                    break;
                }
            }
            
            if (!$includeFile) continue;
            
            // Add file to output
            $output .= "\n" . str_repeat("-", 60) . "\n";
            $output .= "FILE: " . $relativePath . "\n";
            $output .= str_repeat("-", 60) . "\n";
            
            $content = file_get_contents($fullPath);
            $output .= $content . "\n";
        }
    }
}

// CLI execution
if (php_sapi_name() === 'cli') {
    $projectPath = $argv[1] ?? getcwd();
    
    $converter = new LaravelViewsConverter();
    $converter->convert($projectPath);
}

------------------------------------------------------------
FILE: public/index.php
------------------------------------------------------------
<?php

use Illuminate\Foundation\Application;
use Illuminate\Http\Request;

define('LARAVEL_START', microtime(true));

// Determine if the application is in maintenance mode...
if (file_exists($maintenance = __DIR__.'/../storage/framework/maintenance.php')) {
    require $maintenance;
}

// Register the Composer autoloader...
require __DIR__.'/../vendor/autoload.php';

// Bootstrap Laravel and handle the request...
/** @var Application $app */
$app = require_once __DIR__.'/../bootstrap/app.php';

$app->handleRequest(Request::capture());


------------------------------------------------------------
FILE: resources/css/app.css
------------------------------------------------------------
@import 'tailwindcss';

@source '../../vendor/laravel/framework/src/Illuminate/Pagination/resources/views/*.blade.php';
@source '../../storage/framework/views/*.php';
@source '../**/*.blade.php';
@source '../**/*.js';

@theme {
    --font-sans: 'Instrument Sans', ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
        'Segoe UI Symbol', 'Noto Color Emoji';
}


------------------------------------------------------------
FILE: resources/js/app.js
------------------------------------------------------------
import './bootstrap';


------------------------------------------------------------
FILE: resources/js/bootstrap.js
------------------------------------------------------------
import axios from 'axios';
window.axios = axios;

window.axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';


------------------------------------------------------------
FILE: resources/views/dashboard.blade.php
------------------------------------------------------------
@extends('layout.main')

@section('title', 'Dashboard - Material Connect')

@push('styles')
<style>
/* Dashboard Specific Styles */
.metric-card {
    border: none;
    border-radius: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}
.metric-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
}
.metric-card .metric-icon {
    width: 48px;
    height: 48px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
}
.metric-value {
    font-size: 2rem;
    font-weight: 700;
    line-height: 1.2;
    margin-bottom: 0.25rem;
}
.metric-label {
    font-size: 0.875rem;
    color: #6c757d;
    font-weight: 500;
}
.metric-change {
    font-size: 0.75rem;
    font-weight: 600;
}
.activity-item {
    border-left: 3px solid #e9ecef;
    transition: border-color 0.2s;
}
.activity-item:hover {
    border-left-color: #0d6efd;
    background-color: #f8f9fa;
}
.activity-icon {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
}
.chart-card {
    height: 100%;
    min-height: 300px;
}
.quick-action-btn {
    border: 2px dashed #dee2e6;
    border-radius: 10px;
    padding: 1.25rem;
    text-align: center;
    transition: all 0.3s;
    cursor: pointer;
    text-decoration: none;
    display: block;
}
.quick-action-btn:hover {
    border-color: #0d6efd;
    background-color: #f8f9ff;
    transform: translateY(-2px);
}
.quick-action-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
}
</style>
@endpush

@section('content')
<!-- Welcome Section -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h2 class="mb-1">Welcome back, Admin</h2>
                <p class="text-muted mb-0">Here's what's happening with your business today.</p>
            </div>
            <div class="d-none d-md-block">
                <span class="badge bg-primary-subtle text-primary px-3 py-2">
                    <i class="bi bi-calendar3"></i> {{ date('l, F j, Y') }}
                </span>
            </div>
        </div>
    </div>
</div>

<!-- Key Metrics Row -->
<div class="row g-3 mb-4">
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card metric-card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div class="metric-icon bg-primary-subtle text-primary">
                        <i class="bi bi-cart-check"></i>
                    </div>
                    <span class="metric-change text-success">
                        <i class="bi bi-arrow-up"></i> 12.5%
                    </span>
                </div>
                <div class="metric-value text-dark">156</div>
                <div class="metric-label">Active Orders</div>
            </div>
        </div>
    </div>
    
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card metric-card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div class="metric-icon bg-success-subtle text-success">
                        <i class="bi bi-currency-dollar"></i>
                    </div>
                    <span class="metric-change text-success">
                        <i class="bi bi-arrow-up"></i> 8.2%
                    </span>
                </div>
                <div class="metric-value text-dark">$45,230</div>
                <div class="metric-label">Monthly Revenue</div>
            </div>
        </div>
    </div>
    
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card metric-card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div class="metric-icon bg-warning-subtle text-warning">
                        <i class="bi bi-people"></i>
                    </div>
                    <span class="metric-change text-success">
                        <i class="bi bi-arrow-up"></i> 3.1%
                    </span>
                </div>
                <div class="metric-value text-dark">84</div>
                <div class="metric-label">Active Clients</div>
            </div>
        </div>
    </div>
    
    <div class="col-12 col-sm-6 col-lg-3">
        <div class="card metric-card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div class="metric-icon bg-info-subtle text-info">
                        <i class="bi bi-truck"></i>
                    </div>
                    <span class="metric-change text-danger">
                        <i class="bi bi-arrow-down"></i> 2.4%
                    </span>
                </div>
                <div class="metric-value text-dark">42</div>
                <div class="metric-label">Active Suppliers</div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Actions -->
<div class="row g-3 mb-4">
    <div class="col-12">
        <h5 class="mb-3">Quick Actions</h5>
    </div>
    <div class="col-6 col-md-3">
        <a href="#" class="quick-action-btn">
            <div class="quick-action-icon text-primary">
                <i class="bi bi-plus-circle"></i>
            </div>
            <div class="fw-semibold">New Order</div>
        </a>
    </div>
    <div class="col-6 col-md-3">
        <a href="#" class="quick-action-btn">
            <div class="quick-action-icon text-success">
                <i class="bi bi-person-plus"></i>
            </div>
            <div class="fw-semibold">Add Client</div>
        </a>
    </div>
    <div class="col-6 col-md-3">
        <a href="#" class="quick-action-btn">
            <div class="quick-action-icon text-warning">
                <i class="bi bi-box-seam"></i>
            </div>
            <div class="fw-semibold">Add Product</div>
        </a>
    </div>
    <div class="col-6 col-md-3">
        <a href="#" class="quick-action-btn">
            <div class="quick-action-icon text-info">
                <i class="bi bi-building"></i>
            </div>
            <div class="fw-semibold">Add Supplier</div>
        </a>
    </div>
</div>

<!-- Charts and Activity -->
<div class="row g-3 mb-4">
    <!-- Revenue Chart -->
    <div class="col-12 col-lg-8">
        <div class="card chart-card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h5 class="card-title mb-0">Revenue Overview</h5>
                    <div class="btn-group btn-group-sm" role="group">
                        <button type="button" class="btn btn-outline-secondary">Week</button>
                        <button type="button" class="btn btn-outline-secondary active">Month</button>
                        <button type="button" class="btn btn-outline-secondary">Year</button>
                    </div>
                </div>
                <div class="text-center py-5 text-muted">
                    <i class="bi bi-bar-chart-line" style="font-size: 3rem;"></i>
                    <p class="mt-3">Chart will be rendered here using Chart.js or similar</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Recent Activity -->
    <div class="col-12 col-lg-4">
        <div class="card chart-card">
            <div class="card-body">
                <h5 class="card-title mb-4">Recent Activity</h5>
                <div class="d-flex flex-column gap-3">
                    <div class="activity-item ps-3 py-2">
                        <div class="d-flex gap-3">
                            <div class="activity-icon bg-primary-subtle text-primary">
                                <i class="bi bi-cart-check"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-semibold small">New Order #1234</div>
                                <div class="text-muted small">Construction Site A</div>
                                <div class="text-muted small">2 minutes ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item ps-3 py-2">
                        <div class="d-flex gap-3">
                            <div class="activity-icon bg-success-subtle text-success">
                                <i class="bi bi-check-circle"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-semibold small">Payment Received</div>
                                <div class="text-muted small">ABC Construction Ltd</div>
                                <div class="text-muted small">15 minutes ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item ps-3 py-2">
                        <div class="d-flex gap-3">
                            <div class="activity-icon bg-warning-subtle text-warning">
                                <i class="bi bi-person-plus"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-semibold small">New Client Added</div>
                                <div class="text-muted small">XYZ Builders</div>
                                <div class="text-muted small">1 hour ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item ps-3 py-2">
                        <div class="d-flex gap-3">
                            <div class="activity-icon bg-info-subtle text-info">
                                <i class="bi bi-truck"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-semibold small">Supplier Approved</div>
                                <div class="text-muted small">Premium Materials Co</div>
                                <div class="text-muted small">3 hours ago</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="activity-item ps-3 py-2">
                        <div class="d-flex gap-3">
                            <div class="activity-icon bg-danger-subtle text-danger">
                                <i class="bi bi-exclamation-triangle"></i>
                            </div>
                            <div class="flex-grow-1">
                                <div class="fw-semibold small">Order Delayed</div>
                                <div class="text-muted small">Order #1201</div>
                                <div class="text-muted small">5 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <a href="#" class="btn btn-sm btn-link">View All Activity</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Bottom Row - Orders & Suppliers -->
<div class="row g-3">
    <!-- Pending Approvals -->
    <div class="col-12 col-lg-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-4">Pending Approvals</h5>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Type</th>
                                <th>Name</th>
                                <th>Date</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge bg-warning-subtle text-warning">Supplier</span></td>
                                <td>BuildMart Supplies</td>
                                <td class="text-muted small">Oct 1, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-success me-1">Approve</button>
                                    <button class="btn btn-sm btn-danger">Reject</button>
                                </td>
                            </tr>
                            <tr>
                                <td><span class="badge bg-info-subtle text-info">Product</span></td>
                                <td>Premium Cement 50kg</td>
                                <td class="text-muted small">Sep 30, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-success me-1">Approve</button>
                                    <button class="btn btn-sm btn-danger">Reject</button>
                                </td>
                            </tr>
                            <tr>
                                <td><span class="badge bg-warning-subtle text-warning">Supplier</span></td>
                                <td>Steel Solutions Inc</td>
                                <td class="text-muted small">Sep 29, 2025</td>
                                <td>
                                    <button class="btn btn-sm btn-success me-1">Approve</button>
                                    <button class="btn btn-sm btn-danger">Reject</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Top Suppliers -->
    <div class="col-12 col-lg-6">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title mb-4">Top Performing Suppliers</h5>
                <div class="d-flex flex-column gap-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-3">
                            <div class="bg-primary-subtle text-primary rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                <i class="bi bi-building"></i>
                            </div>
                            <div>
                                <div class="fw-semibold">Premium Materials Co</div>
                                <div class="small text-muted">142 orders completed</div>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="fw-semibold text-success">$128,450</div>
                            <div class="small text-muted">Revenue</div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-3">
                            <div class="bg-success-subtle text-success rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                <i class="bi bi-building"></i>
                            </div>
                            <div>
                                <div class="fw-semibold">BuildMart Supplies</div>
                                <div class="small text-muted">98 orders completed</div>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="fw-semibold text-success">$95,320</div>
                            <div class="small text-muted">Revenue</div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center gap-3">
                            <div class="bg-warning-subtle text-warning rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                <i class="bi bi-building"></i>
                            </div>
                            <div>
                                <div class="fw-semibold">Steel Solutions Inc</div>
                                <div class="small text-muted">76 orders completed</div>
                            </div>
                        </div>
                        <div class="text-end">
                            <div class="fw-semibold text-success">$72,890</div>
                            <div class="small text-muted">Revenue</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
@endsection

@push('scripts')
<script>
$(function(){
    console.log('Material Connect Dashboard Loaded');
    
    // You can initialize Chart.js or other visualization libraries here
    // Example: Revenue chart, order trends, etc.
});
</script>
@endpush

------------------------------------------------------------
FILE: resources/views/layout/css.blade.php
------------------------------------------------------------
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
/* CSS Variables */
:root {
  --header-h: 64px;
  --sidebar-w: 260px;
  --primary-color: #0d6efd;
  --sidebar-bg: #ffffff;
  --content-bg: #f8f9fa;
}

/* Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  padding-top: var(--header-h);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background-color: var(--content-bg);
  color: #212529;
}

/* Layout Structure */
.layout-sidebar {
  position: fixed;
  top: var(--header-h);
  left: 0;
  width: var(--sidebar-w);
  height: calc(100vh - var(--header-h));
  overflow-y: auto;
  background: var(--sidebar-bg);
  border-right: 1px solid #e9ecef;
  z-index: 1000;
  transition: transform 0.3s ease;
}

.layout-content {
  margin-left: 0;
  padding: 24px;
  min-height: calc(100vh - var(--header-h));
  transition: margin-left 0.3s ease;
}

/* Desktop: Show sidebar */
@media (min-width: 992px) {
  .layout-content {
    margin-left: var(--sidebar-w);
  }
}

/* Mobile: Hide sidebar by default */
@media (max-width: 991.98px) {
  .layout-sidebar {
    transform: translateX(-100%);
    box-shadow: none;
  }
  
  .layout-sidebar.show {
    transform: translateX(0);
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
  }
  
  /* Overlay when sidebar is open on mobile */
  .layout-sidebar.show::before {
    content: '';
    position: fixed;
    top: 0;
    left: var(--sidebar-w);
    width: calc(100vw - var(--sidebar-w));
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    z-index: -1;
  }
}

/* Sidebar Scrollbar */
.layout-sidebar::-webkit-scrollbar {
  width: 6px;
}

.layout-sidebar::-webkit-scrollbar-track {
  background: transparent;
}

.layout-sidebar::-webkit-scrollbar-thumb {
  background: #dee2e6;
  border-radius: 3px;
}

.layout-sidebar::-webkit-scrollbar-thumb:hover {
  background: #adb5bd;
}

/* Card Enhancements */
.card {
  border: none;
  border-radius: 10px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  transition: box-shadow 0.3s ease;
}

.card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.card-title {
  font-weight: 600;
  color: #212529;
}

/* Table Improvements */
.table {
  font-size: 0.9rem;
}

.table thead th {
  font-weight: 600;
  text-transform: uppercase;
  font-size: 0.75rem;
  letter-spacing: 0.5px;
  color: #6c757d;
  border-bottom: 2px solid #e9ecef;
}

.table-hover tbody tr:hover {
  background-color: #f8f9fa;
  cursor: pointer;
}

/* Badge Enhancements */
.badge {
  font-weight: 500;
  padding: 0.35em 0.65em;
}

/* Button Enhancements */
.btn {
  font-weight: 500;
  transition: all 0.2s ease;
}

.btn-primary {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
}

.btn-primary:hover {
  background-color: #0b5ed7;
  border-color: #0a58ca;
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(13, 110, 253, 0.2);
}

/* Form Control Enhancements */
.form-control:focus,
.form-select:focus {
  border-color: var(--primary-color);
  box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.15);
}

/* Utility Classes */
.text-primary {
  color: var(--primary-color) !important;
}

.bg-primary {
  background-color: var(--primary-color) !important;
}

/* Responsive Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: 600;
  line-height: 1.2;
}

/* Loading States */
.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Print Styles */
@media print {
  .layout-sidebar,
  header,
  .no-print {
    display: none !important;
  }
  
  .layout-content {
    margin-left: 0 !important;
    padding: 0 !important;
  }
}

/* Accessibility Improvements */
.btn:focus,
.form-control:focus,
.form-select:focus {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

/* Dark mode support (optional) */
@media (prefers-color-scheme: dark) {
  /* Add dark mode styles here if needed */
}
</style>



<style>
/* Header Styles */
header {
    backdrop-filter: blur(10px);
}

header .form-control {
    border: 1px solid #e9ecef;
    background-color: #f8f9fa;
    transition: all 0.3s ease;
}

header .form-control:focus {
    background-color: #ffffff;
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.1);
}

/* Dropdown Improvements */
.dropdown-menu {
    border: 1px solid #e9ecef;
    border-radius: 8px;
    margin-top: 0.5rem;
}

.dropdown-item {
    padding: 0.625rem 1rem;
    transition: all 0.2s ease;
}

.dropdown-item:hover {
    background-color: #f8f9fa;
}

.dropdown-item i {
    font-size: 1.1rem;
    width: 20px;
}

/* Notification Badge Animation */
@keyframes pulse {
    0% {
        transform: translate(-50%, -50%) scale(1);
    }
    50% {
        transform: translate(-50%, -50%) scale(1.1);
    }
    100% {
        transform: translate(-50%, -50%) scale(1);
    }
}

.badge.bg-danger {
    animation: pulse 2s infinite;
}
</style>




<style>
    /* Enhanced Sidebar Styles */
.layout-sidebar .nav-link {
    color: #495057;
    padding: 0.625rem 0.75rem;
    font-size: 0.9rem;
    font-weight: 500;
    transition: all 0.2s ease;
    border: none;
}

.layout-sidebar .nav-link:hover {
    background-color: #f8f9fa;
    color: #0d6efd;
}

.layout-sidebar .nav-link.active {
    background-color: #0d6efd;
    color: #ffffff;
}

.layout-sidebar .nav-link.active:hover {
    background-color: #0b5ed7;
}

.layout-sidebar .nav-link i {
    font-size: 1.1rem;
    width: 20px;
}
</style>



@stack('styles')




------------------------------------------------------------
FILE: resources/views/layout/header.blade.php
------------------------------------------------------------
<header class="fixed-top bg-white border-bottom shadow-sm" style="height: var(--header-h); z-index: 1030;">
  <div class="container-fluid h-100">
    <div class="d-flex align-items-center justify-content-between h-100 px-3">
      
      <!-- Left Section: Mobile Toggle + Logo -->
      <div class="d-flex align-items-center gap-3">
        <!-- Mobile Menu Toggle -->
        <button class="btn btn-link text-dark d-lg-none p-0" id="sidebarToggle" type="button">
          <i class="bi bi-list" style="font-size: 1.5rem;"></i>
        </button>
        
        <!-- Logo/Brand (visible on mobile when sidebar hidden) -->
        <div class="d-lg-none">
          <h5 class="mb-0 fw-bold">Material Connect</h5>
        </div>
      </div>

      <!-- Center Section: Search Bar -->
      <div class="flex-grow-1 px-4 d-none d-md-block" style="max-width: 500px;">
        <div class="position-relative">
          <input type="text" 
                 class="form-control form-control-sm rounded-pill ps-4" 
                 placeholder="Search orders, clients, products..."
                 id="globalSearch">
          <i class="bi bi-search position-absolute top-50 translate-middle-y text-muted" 
             style="left: 12px; font-size: 0.9rem;"></i>
        </div>
      </div>

      <!-- Right Section: Actions & User Menu -->
      <div class="d-flex align-items-center gap-2 gap-md-3">
        
        <!-- Search Icon (Mobile) -->
        <button class="btn btn-link text-dark d-md-none p-0" type="button" id="mobileSearchToggle">
          <i class="bi bi-search" style="font-size: 1.25rem;"></i>
        </button>

        <!-- Quick Add Dropdown -->
        <div class="dropdown">
          <button class="btn btn-primary btn-sm rounded-pill d-none d-md-flex align-items-center gap-2 px-3" 
                  type="button" 
                  id="quickAddDropdown" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false">
            <i class="bi bi-plus-lg"></i>
            <span>Quick Add</span>
          </button>
          <button class="btn btn-primary btn-sm rounded-circle d-md-none p-2" 
                  type="button" 
                  id="quickAddDropdownMobile" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false"
                  style="width: 36px; height: 36px;">
            <i class="bi bi-plus-lg"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm" style="min-width: 200px;">
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/orders/create') }}">
                <i class="bi bi-cart-plus text-primary"></i>
                <span>New Order</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/clients/create') }}">
                <i class="bi bi-person-plus text-success"></i>
                <span>New Client</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/projects/create') }}">
                <i class="bi bi-folder-plus text-warning"></i>
                <span>New Project</span>
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/products/create') }}">
                <i class="bi bi-box-seam text-info"></i>
                <span>New Product</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/suppliers/create') }}">
                <i class="bi bi-truck text-secondary"></i>
                <span>New Supplier</span>
              </a>
            </li>
          </ul>
        </div>

        <!-- Notifications -->
        <div class="dropdown">
          <button class="btn btn-link text-dark position-relative p-0" 
                  type="button" 
                  id="notificationsDropdown" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false">
            <i class="bi bi-bell" style="font-size: 1.25rem;"></i>
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" 
                  style="font-size: 0.65rem;">
              5
            </span>
          </button>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm" style="min-width: 320px; max-height: 400px; overflow-y: auto;">
            <li class="px-3 py-2 border-bottom">
              <div class="d-flex justify-content-between align-items-center">
                <h6 class="mb-0">Notifications</h6>
                <a href="#" class="text-decoration-none small">Mark all read</a>
              </div>
            </li>
            <li>
              <a class="dropdown-item py-3 border-bottom" href="#">
                <div class="d-flex gap-2">
                  <div class="flex-shrink-0">
                    <div class="bg-primary-subtle text-primary rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 40px; height: 40px;">
                      <i class="bi bi-cart-check"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <div class="fw-semibold small">New Order Received</div>
                    <div class="text-muted small">Order #1234 from ABC Construction</div>
                    <div class="text-muted small mt-1">
                      <i class="bi bi-clock"></i> 5 minutes ago
                    </div>
                  </div>
                </div>
              </a>
            </li>
            <li>
              <a class="dropdown-item py-3 border-bottom" href="#">
                <div class="d-flex gap-2">
                  <div class="flex-shrink-0">
                    <div class="bg-warning-subtle text-warning rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 40px; height: 40px;">
                      <i class="bi bi-exclamation-triangle"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <div class="fw-semibold small">Pending Approval</div>
                    <div class="text-muted small">Supplier needs approval</div>
                    <div class="text-muted small mt-1">
                      <i class="bi bi-clock"></i> 1 hour ago
                    </div>
                  </div>
                </div>
              </a>
            </li>
            <li>
              <a class="dropdown-item py-3 border-bottom" href="#">
                <div class="d-flex gap-2">
                  <div class="flex-shrink-0">
                    <div class="bg-success-subtle text-success rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 40px; height: 40px;">
                      <i class="bi bi-check-circle"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <div class="fw-semibold small">Payment Received</div>
                    <div class="text-muted small">$5,230 from XYZ Builders</div>
                    <div class="text-muted small mt-1">
                      <i class="bi bi-clock"></i> 2 hours ago
                    </div>
                  </div>
                </div>
              </a>
            </li>
            <li>
              <a class="dropdown-item py-3 border-bottom" href="#">
                <div class="d-flex gap-2">
                  <div class="flex-shrink-0">
                    <div class="bg-info-subtle text-info rounded-circle d-flex align-items-center justify-content-center" 
                         style="width: 40px; height: 40px;">
                      <i class="bi bi-truck"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <div class="fw-semibold small">Delivery Update</div>
                    <div class="text-muted small">Order #1201 out for delivery</div>
                    <div class="text-muted small mt-1">
                      <i class="bi bi-clock"></i> 3 hours ago
                    </div>
                  </div>
                </div>
              </a>
            </li>
            <li class="text-center py-2">
              <a href="{{ url('/notifications') }}" class="text-decoration-none small fw-semibold">View All Notifications</a>
            </li>
          </ul>
        </div>

        <!-- User Menu -->
        <div class="dropdown">
          <button class="btn btn-link text-dark d-flex align-items-center gap-2 p-0 text-decoration-none" 
                  type="button" 
                  id="userMenuDropdown" 
                  data-bs-toggle="dropdown" 
                  aria-expanded="false">
            <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" 
                 style="width: 36px; height: 36px;">
              <i class="bi bi-person"></i>
            </div>
            <div class="d-none d-lg-block text-start">
              <div class="fw-semibold small">Admin User</div>
              <div class="text-muted" style="font-size: 0.7rem;">Administrator</div>
            </div>
            <i class="bi bi-chevron-down d-none d-lg-block small"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end shadow-sm" style="min-width: 220px;">
            <li class="px-3 py-2 border-bottom d-lg-none">
              <div class="fw-semibold">Admin User</div>
              <div class="text-muted small">admin@material.com</div>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/profile') }}">
                <i class="bi bi-person"></i>
                <span>My Profile</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/settings') }}">
                <i class="bi bi-gear"></i>
                <span>Settings</span>
              </a>
            </li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2" href="{{ url('/help') }}">
                <i class="bi bi-question-circle"></i>
                <span>Help Center</span>
              </a>
            </li>
            <li><hr class="dropdown-divider"></li>
            <li>
              <a class="dropdown-item d-flex align-items-center gap-2 text-danger" href="{{ route('logout') }}">
                <i class="bi bi-box-arrow-right"></i>
                <span>Logout</span>
              </a>
            </li>
          </ul>
        </div>

      </div>
    </div>
  </div>

  <!-- Mobile Search Bar (Hidden by default) -->
  <div class="collapse border-top" id="mobileSearchCollapse">
    <div class="container-fluid py-2">
      <div class="position-relative">
        <input type="text" 
               class="form-control form-control-sm rounded-pill ps-4" 
               placeholder="Search orders, clients, products...">
        <i class="bi bi-search position-absolute top-50 translate-middle-y text-muted" 
           style="left: 12px; font-size: 0.9rem;"></i>
      </div>
    </div>
  </div>
</header>




------------------------------------------------------------
FILE: resources/views/layout/main.blade.php
------------------------------------------------------------
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>@yield('title','Dashboard - Material Connect')</title>
  @include('layout.css')
</head>
<body class="bg-body-tertiary">

  @include('layout.header')
  @include('layout.sidebar')

  <main class="layout-content">
    <div class="container-fluid">
      @yield('content')
    </div>
  </main>

  @include('layout.scripts')
</body>
</html>

------------------------------------------------------------
FILE: resources/views/layout/scripts.blade.php
------------------------------------------------------------
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
        crossorigin="anonymous"></script>

<!-- Popper + Bootstrap (your picks) -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
        crossorigin="anonymous"></script>


<!-- Header -->
 <script>
// Mobile Sidebar Toggle
document.addEventListener('DOMContentLoaded', function() {
    const sidebarToggle = document.getElementById('sidebarToggle');
    const sidebar = document.querySelector('.layout-sidebar');
    
    if (sidebarToggle && sidebar) {
        sidebarToggle.addEventListener('click', function() {
            sidebar.classList.toggle('show');
        });
        
        // Close sidebar when clicking outside on mobile
        document.addEventListener('click', function(event) {
            if (window.innerWidth < 992) {
                if (!sidebar.contains(event.target) && !sidebarToggle.contains(event.target)) {
                    sidebar.classList.remove('show');
                }
            }
        });
    }
    
    // Mobile Search Toggle
    const mobileSearchToggle = document.getElementById('mobileSearchToggle');
    const mobileSearchCollapse = document.getElementById('mobileSearchCollapse');
    
    if (mobileSearchToggle && mobileSearchCollapse) {
        mobileSearchToggle.addEventListener('click', function() {
            const bsCollapse = new bootstrap.Collapse(mobileSearchCollapse, {
                toggle: true
            });
        });
    }
});
</script>
<!-- Header -->




@stack('scripts')


------------------------------------------------------------
FILE: resources/views/layout/sidebar.blade.php
------------------------------------------------------------
<aside class="layout-sidebar">
    <nav class="p-3 h-100 d-flex flex-column">
        <!-- Brand Section -->
        <div class="mb-4 pb-3 border-bottom">
            <div class="d-flex align-items-center gap-2">
                <div class="bg-primary text-white rounded d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                    <i class="bi bi-box-seam" style="font-size: 1.25rem;"></i>
                </div>
                <div>
                    <h6 class="mb-0 fw-bold">Material Connect</h6>
                    <small class="text-muted">Admin Panel</small>
                </div>
            </div>
        </div>
        @if(auth()->user() && auth()->user()->role=="admin")
        <!-- Navigation Links -->
        <div class="flex-grow-1 overflow-auto">
            <!-- Dashboard -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Overview</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link active d-flex align-items-center gap-2 rounded-3" href="{{ url('/dashboard') }}">
                            <i class="bi bi-speedometer2"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/analytics') }}">
                            <i class="bi bi-graph-up"></i>
                            <span>Analytics</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Core Business -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Core Business</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ route('clients') }}">
                            <i class="bi bi-people"></i>
                            <span>Clients</span>
                            <span class="ms-auto badge bg-primary-subtle text-primary rounded-pill">84</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/projects') }}">
                            <i class="bi bi-folder"></i>
                            <span>Projects</span>
                            <span class="ms-auto badge bg-warning-subtle text-warning rounded-pill">127</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/orders') }}">
                            <i class="bi bi-cart-check"></i>
                            <span>Orders</span>
                            <span class="ms-auto badge bg-success-subtle text-success rounded-pill">156</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Inventory & Suppliers -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Inventory</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/products') }}">
                            <i class="bi bi-box-seam"></i>
                            <span>Products</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/suppliers') }}">
                            <i class="bi bi-truck"></i>
                            <span>Suppliers</span>
                            <span class="ms-auto badge bg-info-subtle text-info rounded-pill">42</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/supplier-offers') }}">
                            <i class="bi bi-tag"></i>
                            <span>Supplier Offers</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Financial -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Financial</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/payments') }}">
                            <i class="bi bi-credit-card"></i>
                            <span>Payments</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/invoices') }}">
                            <i class="bi bi-receipt"></i>
                            <span>Invoices</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/pricing-rules') }}">
                            <i class="bi bi-percent"></i>
                            <span>Pricing Rules</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- System Configuration -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Configuration</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/delivery-zones') }}">
                            <i class="bi bi-geo-alt"></i>
                            <span>Delivery Zones</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/approvals') }}">
                            <i class="bi bi-check-circle"></i>
                            <span>Approvals</span>
                            <span class="ms-auto badge bg-danger rounded-pill">3</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/settings') }}">
                            <i class="bi bi-gear"></i>
                            <span>Settings</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Reports -->
            <div class="mb-4">
                <h6 class="text-uppercase text-muted mb-2 px-2" style="font-size: 0.7rem; letter-spacing: 0.5px;">Reports</h6>
                <ul class="nav nav-pills flex-column gap-1">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/reports/revenue') }}">
                            <i class="bi bi-bar-chart-line"></i>
                            <span>Revenue Reports</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/reports/suppliers') }}">
                            <i class="bi bi-file-earmark-text"></i>
                            <span>Supplier Performance</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center gap-2 rounded-3" href="{{ url('/reports/clients') }}">
                            <i class="bi bi-person-lines-fill"></i>
                            <span>Client Spending</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Bottom Section - User & Logout -->
        <div class="mt-auto pt-3 border-top">
            <div class="d-flex align-items-center gap-2 p-2 rounded-3 bg-light">
                <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">
                    <i class="bi bi-person"></i>
                </div>
                <div class="flex-grow-1">
                    <div class="fw-semibold small">Admin User</div>
                    <small class="text-muted" style="font-size: 0.7rem;">admin@material.com</small>
                </div>
                <a href="{{ url('/logout') }}" class="text-muted" title="Logout">
                    <i class="bi bi-box-arrow-right"></i>
                </a>
            </div>
        </div>
        @endif
    </nav>
</aside>



------------------------------------------------------------
FILE: resources/views/login.blade.php
------------------------------------------------------------
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Login - Material Connect</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  
  <style>
    /* CSS Variables */
    :root {
      --primary-color: #0d6efd;
      --bg-color: #f8f9fa;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .auth-container {
      width: 100%;
      max-width: 450px;
    }

    .auth-card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .auth-header {
      text-align: center;
      padding: 40px 40px 20px;
    }

    .auth-logo {
      width: 200px;
      height: auto;
      margin-bottom: 20px;
    }

    .auth-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #212529;
      margin-bottom: 8px;
    }

    .auth-subtitle {
      color: #6c757d;
      font-size: 0.95rem;
    }

    .auth-body {
      padding: 20px 40px 40px;
    }

    .form-label {
      font-weight: 600;
      color: #495057;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .form-control {
      padding: 12px 16px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    .form-control:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.15);
    }

    .password-wrapper {
      position: relative;
    }

    .password-toggle {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #6c757d;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s;
    }

    .password-toggle:hover {
      color: var(--primary-color);
    }

    .form-check-input {
      width: 18px;
      height: 18px;
      margin-top: 0;
      cursor: pointer;
    }

    .form-check-label {
      margin-left: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      color: #495057;
    }

    .btn-primary {
      width: 100%;
      padding: 14px;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
      margin-top: 10px;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    .forgot-password {
      text-align: right;
      margin-top: -8px;
      margin-bottom: 20px;
    }

    .forgot-password a {
      color: var(--primary-color);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      transition: color 0.2s;
    }

    .forgot-password a:hover {
      color: #0b5ed7;
      text-decoration: underline;
    }

    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 25px 0;
      color: #6c757d;
      font-size: 0.9rem;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #dee2e6;
    }

    .divider span {
      padding: 0 15px;
    }

    .register-link {
      text-align: center;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e9ecef;
      color: #6c757d;
      font-size: 0.95rem;
    }

    .register-link a {
      color: var(--primary-color);
      font-weight: 600;
      text-decoration: none;
      transition: color 0.2s;
    }

    .register-link a:hover {
      color: #0b5ed7;
      text-decoration: underline;
    }

    .alert {
      border-radius: 10px;
      border: none;
      font-size: 0.9rem;
      padding: 12px 16px;
    }

    /* Responsive */
    @media (max-width: 576px) {
      .auth-header {
        padding: 30px 25px 15px;
      }

      .auth-body {
        padding: 15px 25px 30px;
      }

      .auth-logo {
        width: 160px;
      }

      .auth-title {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <div class="auth-container">
    <div class="auth-card">
      <!-- Header -->
      <div class="auth-header">
        <img src="https://materialconnect.com.au/wp-content/uploads/2025/01/logo-black.png" alt="Material Connect" class="auth-logo">
        <h2 class="auth-title">Welcome Back</h2>
        <p class="auth-subtitle">Sign in to continue to Material Connect</p>
      </div>

      <!-- Body -->
      <div class="auth-body">
        <!-- Error Messages -->
        @if($errors->any())
        <div class="alert alert-danger d-flex align-items-center mb-3" role="alert">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <div>
            @foreach($errors->all() as $error)
              {{ $error }}
            @endforeach
          </div>
        </div>
        @endif

        @if(session('success'))
        <div class="alert alert-success d-flex align-items-center mb-3" role="alert">
          <i class="bi bi-check-circle-fill me-2"></i>
          <div>{{ session('success') }}</div>
        </div>
        @endif

        <!-- Login Form -->
        <form action="{{route('login.submit')}}" method="POST">
          @csrf
          
          <!-- Email -->
          <div class="mb-3">
            <label for="email" class="form-label">Email Address</label>
            <input 
              type="email" 
              class="form-control @error('email') is-invalid @enderror" 
              id="email" 
              name="email" 
              placeholder="Enter your email"
              value="{{ old('email') }}"
              required 
              autofocus>
            @error('email')
              <div class="invalid-feedback">{{ $message }}</div>
            @enderror
          </div>

          <!-- Password -->
          <div class="mb-3">
            <label for="password" class="form-label">Password</label>
            <div class="password-wrapper">
              <input 
                type="password" 
                class="form-control @error('password') is-invalid @enderror" 
                id="password" 
                name="password" 
                placeholder="Enter your password"
                required>
              <button type="button" class="password-toggle" onclick="togglePassword('password', this)">
                <i class="bi bi-eye" style="font-size: 1.2rem;"></i>
              </button>
            </div>
            @error('password')
              <div class="invalid-feedback d-block">{{ $message }}</div>
            @enderror
          </div>

          <!-- Remember Me & Forgot Password -->
          <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="rememberMe" name="remember">
              <label class="form-check-label" for="rememberMe">
                Remember me
              </label>
            </div>
          </div>

          <div class="forgot-password">
            <a href="">Forgot Password?</a>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="btn btn-primary">
            Sign In
          </button>
        </form>

        <!-- Divider -->
        <div class="divider">
          <span>New to Material Connect?</span>
        </div>

        <!-- Register Link -->
        <div class="register-link">
          Don't have an account? <a href="{{route('register')}}">Create Account</a>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
          integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
          crossorigin="anonymous"></script>

  <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
          crossorigin="anonymous"></script>

  <script>
    // Toggle Password Visibility
    function togglePassword(inputId, button) {
      const input = document.getElementById(inputId);
      const icon = button.querySelector('i');
      
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('bi-eye');
        icon.classList.add('bi-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('bi-eye-slash');
        icon.classList.add('bi-eye');
      }
    }
  </script>
</body>
</html>

------------------------------------------------------------
FILE: resources/views/register.blade.php
------------------------------------------------------------
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Register - Material Connect</title>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  
  <style>
    /* CSS Variables */
    :root {
      --primary-color: #0d6efd;
      --bg-color: #f8f9fa;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px 20px;
    }

    .auth-container {
      width: 100%;
      max-width: 900px;
    }

    .auth-card {
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      overflow: hidden;
      animation: slideUp 0.5s ease-out;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .auth-header {
      text-align: center;
      padding: 40px 40px 20px;
    }

    .auth-logo {
      width: 200px;
      height: auto;
      margin-bottom: 20px;
    }

    .auth-title {
      font-size: 1.75rem;
      font-weight: 700;
      color: #212529;
      margin-bottom: 8px;
    }

    .auth-subtitle {
      color: #6c757d;
      font-size: 0.95rem;
    }

    .auth-body {
      padding: 20px 40px 40px;
    }

    .form-label {
      font-weight: 600;
      color: #495057;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .form-label .required {
      color: #dc3545;
      margin-left: 2px;
    }

    .form-control, .form-select {
      padding: 12px 16px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 0.95rem;
      transition: all 0.3s ease;
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.15);
    }

    .password-wrapper {
      position: relative;
    }

    .password-toggle {
      position: absolute;
      right: 16px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #6c757d;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s;
      z-index: 10;
    }

    .password-toggle:hover {
      color: var(--primary-color);
    }

    /* Password Strength Meter */
    .password-strength {
      margin-top: 8px;
    }

    .strength-meter {
      height: 4px;
      background: #e9ecef;
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .strength-meter-fill {
      height: 100%;
      transition: all 0.3s ease;
      border-radius: 2px;
    }

    .strength-weak { width: 33%; background: #dc3545; }
    .strength-medium { width: 66%; background: #ffc107; }
    .strength-strong { width: 100%; background: #28a745; }

    .password-requirements {
      font-size: 0.8rem;
      color: #6c757d;
    }

    .password-requirements .requirement {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-bottom: 4px;
    }

    .requirement.met {
      color: #28a745;
    }

    .requirement i {
      font-size: 0.9rem;
    }

    /* Image Upload */
    .image-upload-wrapper {
      text-align: center;
      padding: 30px;
      border: 2px dashed #dee2e6;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #f8f9fa;
    }

    .image-upload-wrapper:hover {
      border-color: var(--primary-color);
      background: #f0f7ff;
    }

    .image-upload-wrapper.has-image {
      border-color: #28a745;
      background: #f0fff4;
    }

    .image-preview {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      object-fit: cover;
      margin: 0 auto 15px;
      display: none;
      border: 3px solid #28a745;
    }

    .image-preview.show {
      display: block;
    }

    .upload-icon {
      font-size: 3rem;
      color: #6c757d;
      margin-bottom: 10px;
    }

    .upload-text {
      color: #495057;
      font-weight: 500;
      margin-bottom: 5px;
    }

    .upload-hint {
      color: #6c757d;
      font-size: 0.85rem;
    }

    .form-check-input {
      width: 18px;
      height: 18px;
      margin-top: 0;
      cursor: pointer;
    }

    .form-check-label {
      margin-left: 8px;
      cursor: pointer;
      font-size: 0.9rem;
      color: #495057;
    }

    .btn-primary {
      width: 100%;
      padding: 14px;
      font-weight: 600;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      transition: all 0.3s ease;
      margin-top: 10px;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }

    .login-link {
      text-align: center;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #e9ecef;
      color: #6c757d;
      font-size: 0.95rem;
    }

    .login-link a {
      color: var(--primary-color);
      font-weight: 600;
      text-decoration: none;
      transition: color 0.2s;
    }

    .login-link a:hover {
      color: #0b5ed7;
      text-decoration: underline;
    }

    .alert {
      border-radius: 10px;
      border: none;
      font-size: 0.9rem;
      padding: 12px 16px;
    }

    .section-title {
      font-size: 1rem;
      font-weight: 600;
      color: #495057;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e9ecef;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .auth-header {
        padding: 30px 25px 15px;
      }

      .auth-body {
        padding: 15px 25px 30px;
      }

      .auth-logo {
        width: 160px;
      }

      .auth-title {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>

  <div class="auth-container">
    <div class="auth-card">
      <!-- Header -->
      <div class="auth-header">
        <img src="https://materialconnect.com.au/wp-content/uploads/2025/01/logo-black.png" alt="Material Connect" class="auth-logo">
        <h2 class="auth-title">Create Your Account</h2>
        <p class="auth-subtitle">Join Material Connect and start managing your construction materials</p>
      </div>

      <!-- Body -->
      <div class="auth-body">
        <!-- Error Messages -->
        @if($errors->any())
        <div class="alert alert-danger d-flex align-items-start mb-3" role="alert">
          <i class="bi bi-exclamation-triangle-fill me-2 mt-1"></i>
          <div>
            <strong>Please fix the following errors:</strong>
            <ul class="mb-0 mt-2 ps-3">
              @foreach($errors->all() as $error)
                <li>{{ $error }}</li>
              @endforeach
            </ul>
          </div>
        </div>
        @endif

        <!-- Registration Form -->
        <form action="{{route('register.submit')}}" method="POST" enctype="multipart/form-data" id="registerForm">
          @csrf
          
          <!-- Company Information -->
          <div class="section-title">
            <i class="bi bi-building me-2"></i>Company Information
          </div>
          
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="companyName" class="form-label">Company Name <span class="required">*</span></label>
              <input 
                type="text" 
                class="form-control @error('company_name') is-invalid @enderror" 
                id="companyName" 
                name="company_name" 
                placeholder="Enter company name"
                value="{{ old('company_name') }}"
                required>
              @error('company_name')
                <div class="invalid-feedback">{{ $message }}</div>
              @enderror
            </div>

            <div class="col-md-6 mb-3">
              <label for="name" class="form-label">Contact Name <span class="required">*</span></label>
              <input 
                type="text" 
                class="form-control @error('name') is-invalid @enderror" 
                id="name" 
                name="name" 
                placeholder="Enter your full name"
                value="{{ old('name') }}"
                required>
              @error('name')
                <div class="invalid-feedback">{{ $message }}</div>
              @enderror
            </div>
          </div>

          <!-- Contact Information -->
          <div class="section-title mt-4">
            <i class="bi bi-person-lines-fill me-2"></i>Contact Information
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="email" class="form-label">Email Address <span class="required">*</span></label>
              <input 
                type="email" 
                class="form-control @error('email') is-invalid @enderror" 
                id="email" 
                name="email" 
                placeholder="Enter your email"
                value="{{ old('email') }}"
                required>
              @error('email')
                <div class="invalid-feedback">{{ $message }}</div>
              @enderror
            </div>

            <div class="col-md-6 mb-3">
              <label for="phone" class="form-label">Phone Number <span class="required">*</span></label>
              <input 
                type="tel" 
                class="form-control @error('phone') is-invalid @enderror" 
                id="phone" 
                name="phone" 
                placeholder="Enter phone number"
                value="{{ old('phone') }}"
                required>
              @error('phone')
                <div class="invalid-feedback">{{ $message }}</div>
              @enderror
            </div>
          </div>

          <!-- Address Information -->
          <div class="section-title mt-4">
            <i class="bi bi-geo-alt-fill me-2"></i>Address Information
          </div>

          <div class="mb-3">
            <label for="shippingAddress" class="form-label">Shipping Address <span class="required">*</span></label>
            <textarea 
              class="form-control @error('shipping_address') is-invalid @enderror" 
              id="shippingAddress" 
              name="shipping_address" 
              rows="3" 
              placeholder="Enter shipping address"
              required>{{ old('shipping_address') }}</textarea>
            @error('shipping_address')
              <div class="invalid-feedback">{{ $message }}</div>
            @enderror
          </div>

          <div class="form-check mb-3">
            <input 
              class="form-check-input" 
              type="checkbox" 
              id="sameAsBilling" 
              name="same_as_billing"
              onchange="toggleDeliveryAddress()">
            <label class="form-check-label" for="sameAsBilling">
              Delivery address same as billing address
            </label>
          </div>

          <div class="mb-3" id="deliveryAddressGroup">
            <label for="deliveryAddress" class="form-label">Delivery Address <span class="required">*</span></label>
            <textarea 
              class="form-control @error('delivery_address') is-invalid @enderror" 
              id="deliveryAddress" 
              name="delivery_address" 
              rows="3" 
              placeholder="Enter delivery address"
              required>{{ old('delivery_address') }}</textarea>
            @error('delivery_address')
              <div class="invalid-feedback">{{ $message }}</div>
            @enderror
          </div>

          <!-- Profile Image -->
          <div class="section-title mt-4">
            <i class="bi bi-image me-2"></i>Profile Image (Optional)
          </div>

          <div class="mb-3">
            <input type="file" id="profileImage" name="profile_image" accept="image/*" style="display: none;" onchange="previewImage(event)">
            <div class="image-upload-wrapper" onclick="document.getElementById('profileImage').click()">
              <img id="imagePreview" class="image-preview" alt="Preview">
              <div id="uploadPlaceholder">
                <i class="bi bi-cloud-arrow-up upload-icon"></i>
                <div class="upload-text">Click to upload profile image</div>
                <div class="upload-hint">PNG, JPG up to 5MB</div>
              </div>
            </div>
          </div>

          <!-- Security -->
          <div class="section-title mt-4">
            <i class="bi bi-shield-lock me-2"></i>Security
          </div>

          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="password" class="form-label">Password <span class="required">*</span></label>
              <div class="password-wrapper">
                <input 
                  type="password" 
                  class="form-control @error('password') is-invalid @enderror" 
                  id="password" 
                  name="password" 
                  placeholder="Create a password"
                  onkeyup="checkPasswordStrength()"
                  required>
                <button type="button" class="password-toggle" onclick="togglePassword('password', this)">
                  <i class="bi bi-eye" style="font-size: 1.2rem;"></i>
                </button>
              </div>
              @error('password')
                <div class="invalid-feedback d-block">{{ $message }}</div>
              @enderror
              
              <!-- Password Strength Meter -->
              <div class="password-strength">
                <div class="strength-meter">
                  <div class="strength-meter-fill" id="strengthMeter"></div>
                </div>
                <div class="password-requirements">
                  <div class="requirement" id="req-length">
                    <i class="bi bi-x-circle"></i>
                    <span>At least 8 characters</span>
                  </div>
                  <div class="requirement" id="req-uppercase">
                    <i class="bi bi-x-circle"></i>
                    <span>One uppercase letter</span>
                  </div>
                  <div class="requirement" id="req-lowercase">
                    <i class="bi bi-x-circle"></i>
                    <span>One lowercase letter</span>
                  </div>
                  <div class="requirement" id="req-number">
                    <i class="bi bi-x-circle"></i>
                    <span>One number</span>
                  </div>
                  <div class="requirement" id="req-special">
                    <i class="bi bi-x-circle"></i>
                    <span>One special character (!@#$%^&*)</span>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6 mb-3">
              <label for="confirmPassword" class="form-label">Confirm Password <span class="required">*</span></label>
              <div class="password-wrapper">
                <input 
                  type="password" 
                  class="form-control @error('password_confirmation') is-invalid @enderror" 
                  id="confirmPassword" 
                  name="password_confirmation" 
                  placeholder="Confirm your password"
                  required>
                <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword', this)">
                  <i class="bi bi-eye" style="font-size: 1.2rem;"></i>
                </button>
              </div>
              @error('password_confirmation')
                <div class="invalid-feedback d-block">{{ $message }}</div>
              @enderror
            </div>
          </div>

          <!-- Terms and Conditions -->
          <div class="mt-4">
            <div class="form-check">
              <input 
                class="form-check-input @error('terms') is-invalid @enderror" 
                type="checkbox" 
                id="agreeTerms" 
                name="terms"
                required>
              <label class="form-check-label" for="agreeTerms">
                I agree to the <a href="#" target="_blank">Terms and Conditions</a> and <a href="#" target="_blank">Privacy Policy</a>
              </label>
              @error('terms')
                <div class="invalid-feedback d-block">{{ $message }}</div>
              @enderror
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-person-plus me-2"></i>Create Account
          </button>
        </form>

        <!-- Login Link -->
        <div class="login-link">
          Already have an account? <a href="{{ route('login') }}">Sign In</a>
        </div>
      </div>
    </div>
  </div>

  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
          integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
          crossorigin="anonymous"></script>

  <!-- Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
          crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.min.js"
          crossorigin="anonymous"></script>

  <script>
    // Toggle Password Visibility
    function togglePassword(inputId, button) {
      const input = document.getElementById(inputId);
      const icon = button.querySelector('i');
      
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('bi-eye');
        icon.classList.add('bi-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('bi-eye-slash');
        icon.classList.add('bi-eye');
      }
    }

    // Toggle Delivery Address
    function toggleDeliveryAddress() {
      const checkbox = document.getElementById('sameAsBilling');
      const deliveryGroup = document.getElementById('deliveryAddressGroup');
      const deliveryAddress = document.getElementById('deliveryAddress');
      const billingAddress = document.getElementById('billingAddress');
      
      if (checkbox.checked) {
        deliveryAddress.value = billingAddress.value;
        deliveryAddress.readOnly = true;
        deliveryGroup.style.opacity = '0.6';
      } else {
        deliveryAddress.readOnly = false;
        deliveryGroup.style.opacity = '1';
      }
    }

    // Copy billing address when changed if checkbox is checked
    document.getElementById('billingAddress').addEventListener('input', function() {
      const checkbox = document.getElementById('sameAsBilling');
      if (checkbox.checked) {
        document.getElementById('deliveryAddress').value = this.value;
      }
    });

    // Preview Image
    function previewImage(event) {
      const file = event.target.files[0];
      const preview = document.getElementById('imagePreview');
      const placeholder = document.getElementById('uploadPlaceholder');
      const wrapper = document.querySelector('.image-upload-wrapper');
      
      if (file) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          preview.src = e.target.result;
          preview.classList.add('show');
          placeholder.style.display = 'none';
          wrapper.classList.add('has-image');
        }
        
        reader.readAsDataURL(file);
      }
    }

    // Password Strength Checker
    function checkPasswordStrength() {
      const password = document.getElementById('password').value;
      const meter = document.getElementById('strengthMeter');
      
      // Requirements
      const requirements = {
        length: password.length >= 8,
        uppercase: /[A-Z]/.test(password),
        lowercase: /[a-z]/.test(password),
        number: /[0-9]/.test(password),
        special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
      };

      // Update requirement indicators
      updateRequirement('req-length', requirements.length);
      updateRequirement('req-uppercase', requirements.uppercase);
      updateRequirement('req-lowercase', requirements.lowercase);
      updateRequirement('req-number', requirements.number);
      updateRequirement('req-special', requirements.special);

      // Calculate strength score
      const score = Object.values(requirements).filter(Boolean).length;
      
      // Update strength meter
      meter.className = 'strength-meter-fill';
      if (score <= 2) {
        meter.classList.add('strength-weak');
      } else if (score <= 4) {
        meter.classList.add('strength-medium');
      } else {
        meter.classList.add('strength-strong');
      }
    }

    function updateRequirement(id, met) {
      const element = document.getElementById(id);
      const icon = element.querySelector('i');
      
      if (met) {
        element.classList.add('met');
        icon.classList.remove('bi-x-circle');
        icon.classList.add('bi-check-circle-fill');
      } else {
        element.classList.remove('met');
        icon.classList.remove('bi-check-circle-fill');
        icon.classList.add('bi-x-circle');
      }
    }

    // Form Validation
    document.getElementById('registerForm').addEventListener('submit', function(e) {
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (password !== confirmPassword) {
        e.preventDefault();
        alert('Passwords do not match!');
        return false;
      }

      // Check password strength
      const requirements = {
        length: password.length >= 8,
        uppercase: /[A-Z]/.test(password),
        lowercase: /[a-z]/.test(password),
        number: /[0-9]/.test(password),
        special: /[!@#$%^&*(),.?":{}|<>]/.test(password)
      };

      const allMet = Object.values(requirements).every(Boolean);
      
      if (!allMet) {
        e.preventDefault();
        alert('Please ensure your password meets all requirements!');
        return false;
      }

      // Check terms acceptance
      const termsChecked = document.getElementById('agreeTerms').checked;
      if (!termsChecked) {
        e.preventDefault();
        alert('Please accept the Terms and Conditions to continue!');
        return false;
      }
    });
  </script>
</body>
</html>

------------------------------------------------------------
FILE: resources/views/welcome.blade.php
------------------------------------------------------------
<!DOCTYPE html>
<html lang="{{ str_replace('_', '-', app()->getLocale()) }}">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{{ config('app.name', 'Laravel') }}</title>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.bunny.net">
        <link href="https://fonts.bunny.net/css?family=instrument-sans:400,500,600" rel="stylesheet" />

        <!-- Styles / Scripts -->
        @if (file_exists(public_path('build/manifest.json')) || file_exists(public_path('hot')))
            @vite(['resources/css/app.css', 'resources/js/app.js'])
        @else
            <style>
                /*! tailwindcss v4.0.7 | MIT License | https://tailwindcss.com */@layer theme{:root,:host{--font-sans:'Instrument Sans',ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-serif:ui-serif,Georgia,Cambria,"Times New Roman",Times,serif;--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-red-50:oklch(.971 .013 17.38);--color-red-100:oklch(.936 .032 17.717);--color-red-200:oklch(.885 .062 18.334);--color-red-300:oklch(.808 .114 19.571);--color-red-400:oklch(.704 .191 22.216);--color-red-500:oklch(.637 .237 25.331);--color-red-600:oklch(.577 .245 27.325);--color-red-700:oklch(.505 .213 27.518);--color-red-800:oklch(.444 .177 26.899);--color-red-900:oklch(.396 .141 25.723);--color-red-950:oklch(.258 .092 26.042);--color-orange-50:oklch(.98 .016 73.684);--color-orange-100:oklch(.954 .038 75.164);--color-orange-200:oklch(.901 .076 70.697);--color-orange-300:oklch(.837 .128 66.29);--color-orange-400:oklch(.75 .183 55.934);--color-orange-500:oklch(.705 .213 47.604);--color-orange-600:oklch(.646 .222 41.116);--color-orange-700:oklch(.553 .195 38.402);--color-orange-800:oklch(.47 .157 37.304);--color-orange-900:oklch(.408 .123 38.172);--color-orange-950:oklch(.266 .079 36.259);--color-amber-50:oklch(.987 .022 95.277);--color-amber-100:oklch(.962 .059 95.617);--color-amber-200:oklch(.924 .12 95.746);--color-amber-300:oklch(.879 .169 91.605);--color-amber-400:oklch(.828 .189 84.429);--color-amber-500:oklch(.769 .188 70.08);--color-amber-600:oklch(.666 .179 58.318);--color-amber-700:oklch(.555 .163 48.998);--color-amber-800:oklch(.473 .137 46.201);--color-amber-900:oklch(.414 .112 45.904);--color-amber-950:oklch(.279 .077 45.635);--color-yellow-50:oklch(.987 .026 102.212);--color-yellow-100:oklch(.973 .071 103.193);--color-yellow-200:oklch(.945 .129 101.54);--color-yellow-300:oklch(.905 .182 98.111);--color-yellow-400:oklch(.852 .199 91.936);--color-yellow-500:oklch(.795 .184 86.047);--color-yellow-600:oklch(.681 .162 75.834);--color-yellow-700:oklch(.554 .135 66.442);--color-yellow-800:oklch(.476 .114 61.907);--color-yellow-900:oklch(.421 .095 57.708);--color-yellow-950:oklch(.286 .066 53.813);--color-lime-50:oklch(.986 .031 120.757);--color-lime-100:oklch(.967 .067 122.328);--color-lime-200:oklch(.938 .127 124.321);--color-lime-300:oklch(.897 .196 126.665);--color-lime-400:oklch(.841 .238 128.85);--color-lime-500:oklch(.768 .233 130.85);--color-lime-600:oklch(.648 .2 131.684);--color-lime-700:oklch(.532 .157 131.589);--color-lime-800:oklch(.453 .124 130.933);--color-lime-900:oklch(.405 .101 131.063);--color-lime-950:oklch(.274 .072 132.109);--color-green-50:oklch(.982 .018 155.826);--color-green-100:oklch(.962 .044 156.743);--color-green-200:oklch(.925 .084 155.995);--color-green-300:oklch(.871 .15 154.449);--color-green-400:oklch(.792 .209 151.711);--color-green-500:oklch(.723 .219 149.579);--color-green-600:oklch(.627 .194 149.214);--color-green-700:oklch(.527 .154 150.069);--color-green-800:oklch(.448 .119 151.328);--color-green-900:oklch(.393 .095 152.535);--color-green-950:oklch(.266 .065 152.934);--color-emerald-50:oklch(.979 .021 166.113);--color-emerald-100:oklch(.95 .052 163.051);--color-emerald-200:oklch(.905 .093 164.15);--color-emerald-300:oklch(.845 .143 164.978);--color-emerald-400:oklch(.765 .177 163.223);--color-emerald-500:oklch(.696 .17 162.48);--color-emerald-600:oklch(.596 .145 163.225);--color-emerald-700:oklch(.508 .118 165.612);--color-emerald-800:oklch(.432 .095 166.913);--color-emerald-900:oklch(.378 .077 168.94);--color-emerald-950:oklch(.262 .051 172.552);--color-teal-50:oklch(.984 .014 180.72);--color-teal-100:oklch(.953 .051 180.801);--color-teal-200:oklch(.91 .096 180.426);--color-teal-300:oklch(.855 .138 181.071);--color-teal-400:oklch(.777 .152 181.912);--color-teal-500:oklch(.704 .14 182.503);--color-teal-600:oklch(.6 .118 184.704);--color-teal-700:oklch(.511 .096 186.391);--color-teal-800:oklch(.437 .078 188.216);--color-teal-900:oklch(.386 .063 188.416);--color-teal-950:oklch(.277 .046 192.524);--color-cyan-50:oklch(.984 .019 200.873);--color-cyan-100:oklch(.956 .045 203.388);--color-cyan-200:oklch(.917 .08 205.041);--color-cyan-300:oklch(.865 .127 207.078);--color-cyan-400:oklch(.789 .154 211.53);--color-cyan-500:oklch(.715 .143 215.221);--color-cyan-600:oklch(.609 .126 221.723);--color-cyan-700:oklch(.52 .105 223.128);--color-cyan-800:oklch(.45 .085 224.283);--color-cyan-900:oklch(.398 .07 227.392);--color-cyan-950:oklch(.302 .056 229.695);--color-sky-50:oklch(.977 .013 236.62);--color-sky-100:oklch(.951 .026 236.824);--color-sky-200:oklch(.901 .058 230.902);--color-sky-300:oklch(.828 .111 230.318);--color-sky-400:oklch(.746 .16 232.661);--color-sky-500:oklch(.685 .169 237.323);--color-sky-600:oklch(.588 .158 241.966);--color-sky-700:oklch(.5 .134 242.749);--color-sky-800:oklch(.443 .11 240.79);--color-sky-900:oklch(.391 .09 240.876);--color-sky-950:oklch(.293 .066 243.157);--color-blue-50:oklch(.97 .014 254.604);--color-blue-100:oklch(.932 .032 255.585);--color-blue-200:oklch(.882 .059 254.128);--color-blue-300:oklch(.809 .105 251.813);--color-blue-400:oklch(.707 .165 254.624);--color-blue-500:oklch(.623 .214 259.815);--color-blue-600:oklch(.546 .245 262.881);--color-blue-700:oklch(.488 .243 264.376);--color-blue-800:oklch(.424 .199 265.638);--color-blue-900:oklch(.379 .146 265.522);--color-blue-950:oklch(.282 .091 267.935);--color-indigo-50:oklch(.962 .018 272.314);--color-indigo-100:oklch(.93 .034 272.788);--color-indigo-200:oklch(.87 .065 274.039);--color-indigo-300:oklch(.785 .115 274.713);--color-indigo-400:oklch(.673 .182 276.935);--color-indigo-500:oklch(.585 .233 277.117);--color-indigo-600:oklch(.511 .262 276.966);--color-indigo-700:oklch(.457 .24 277.023);--color-indigo-800:oklch(.398 .195 277.366);--color-indigo-900:oklch(.359 .144 278.697);--color-indigo-950:oklch(.257 .09 281.288);--color-violet-50:oklch(.969 .016 293.756);--color-violet-100:oklch(.943 .029 294.588);--color-violet-200:oklch(.894 .057 293.283);--color-violet-300:oklch(.811 .111 293.571);--color-violet-400:oklch(.702 .183 293.541);--color-violet-500:oklch(.606 .25 292.717);--color-violet-600:oklch(.541 .281 293.009);--color-violet-700:oklch(.491 .27 292.581);--color-violet-800:oklch(.432 .232 292.759);--color-violet-900:oklch(.38 .189 293.745);--color-violet-950:oklch(.283 .141 291.089);--color-purple-50:oklch(.977 .014 308.299);--color-purple-100:oklch(.946 .033 307.174);--color-purple-200:oklch(.902 .063 306.703);--color-purple-300:oklch(.827 .119 306.383);--color-purple-400:oklch(.714 .203 305.504);--color-purple-500:oklch(.627 .265 303.9);--color-purple-600:oklch(.558 .288 302.321);--color-purple-700:oklch(.496 .265 301.924);--color-purple-800:oklch(.438 .218 303.724);--color-purple-900:oklch(.381 .176 304.987);--color-purple-950:oklch(.291 .149 302.717);--color-fuchsia-50:oklch(.977 .017 320.058);--color-fuchsia-100:oklch(.952 .037 318.852);--color-fuchsia-200:oklch(.903 .076 319.62);--color-fuchsia-300:oklch(.833 .145 321.434);--color-fuchsia-400:oklch(.74 .238 322.16);--color-fuchsia-500:oklch(.667 .295 322.15);--color-fuchsia-600:oklch(.591 .293 322.896);--color-fuchsia-700:oklch(.518 .253 323.949);--color-fuchsia-800:oklch(.452 .211 324.591);--color-fuchsia-900:oklch(.401 .17 325.612);--color-fuchsia-950:oklch(.293 .136 325.661);--color-pink-50:oklch(.971 .014 343.198);--color-pink-100:oklch(.948 .028 342.258);--color-pink-200:oklch(.899 .061 343.231);--color-pink-300:oklch(.823 .12 346.018);--color-pink-400:oklch(.718 .202 349.761);--color-pink-500:oklch(.656 .241 354.308);--color-pink-600:oklch(.592 .249 .584);--color-pink-700:oklch(.525 .223 3.958);--color-pink-800:oklch(.459 .187 3.815);--color-pink-900:oklch(.408 .153 2.432);--color-pink-950:oklch(.284 .109 3.907);--color-rose-50:oklch(.969 .015 12.422);--color-rose-100:oklch(.941 .03 12.58);--color-rose-200:oklch(.892 .058 10.001);--color-rose-300:oklch(.81 .117 11.638);--color-rose-400:oklch(.712 .194 13.428);--color-rose-500:oklch(.645 .246 16.439);--color-rose-600:oklch(.586 .253 17.585);--color-rose-700:oklch(.514 .222 16.935);--color-rose-800:oklch(.455 .188 13.697);--color-rose-900:oklch(.41 .159 10.272);--color-rose-950:oklch(.271 .105 12.094);--color-slate-50:oklch(.984 .003 247.858);--color-slate-100:oklch(.968 .007 247.896);--color-slate-200:oklch(.929 .013 255.508);--color-slate-300:oklch(.869 .022 252.894);--color-slate-400:oklch(.704 .04 256.788);--color-slate-500:oklch(.554 .046 257.417);--color-slate-600:oklch(.446 .043 257.281);--color-slate-700:oklch(.372 .044 257.287);--color-slate-800:oklch(.279 .041 260.031);--color-slate-900:oklch(.208 .042 265.755);--color-slate-950:oklch(.129 .042 264.695);--color-gray-50:oklch(.985 .002 247.839);--color-gray-100:oklch(.967 .003 264.542);--color-gray-200:oklch(.928 .006 264.531);--color-gray-300:oklch(.872 .01 258.338);--color-gray-400:oklch(.707 .022 261.325);--color-gray-500:oklch(.551 .027 264.364);--color-gray-600:oklch(.446 .03 256.802);--color-gray-700:oklch(.373 .034 259.733);--color-gray-800:oklch(.278 .033 256.848);--color-gray-900:oklch(.21 .034 264.665);--color-gray-950:oklch(.13 .028 261.692);--color-zinc-50:oklch(.985 0 0);--color-zinc-100:oklch(.967 .001 286.375);--color-zinc-200:oklch(.92 .004 286.32);--color-zinc-300:oklch(.871 .006 286.286);--color-zinc-400:oklch(.705 .015 286.067);--color-zinc-500:oklch(.552 .016 285.938);--color-zinc-600:oklch(.442 .017 285.786);--color-zinc-700:oklch(.37 .013 285.805);--color-zinc-800:oklch(.274 .006 286.033);--color-zinc-900:oklch(.21 .006 285.885);--color-zinc-950:oklch(.141 .005 285.823);--color-neutral-50:oklch(.985 0 0);--color-neutral-100:oklch(.97 0 0);--color-neutral-200:oklch(.922 0 0);--color-neutral-300:oklch(.87 0 0);--color-neutral-400:oklch(.708 0 0);--color-neutral-500:oklch(.556 0 0);--color-neutral-600:oklch(.439 0 0);--color-neutral-700:oklch(.371 0 0);--color-neutral-800:oklch(.269 0 0);--color-neutral-900:oklch(.205 0 0);--color-neutral-950:oklch(.145 0 0);--color-stone-50:oklch(.985 .001 106.423);--color-stone-100:oklch(.97 .001 106.424);--color-stone-200:oklch(.923 .003 48.717);--color-stone-300:oklch(.869 .005 56.366);--color-stone-400:oklch(.709 .01 56.259);--color-stone-500:oklch(.553 .013 58.071);--color-stone-600:oklch(.444 .011 73.639);--color-stone-700:oklch(.374 .01 67.558);--color-stone-800:oklch(.268 .007 34.298);--color-stone-900:oklch(.216 .006 56.043);--color-stone-950:oklch(.147 .004 49.25);--color-black:#000;--color-white:#fff;--spacing:.25rem;--breakpoint-sm:40rem;--breakpoint-md:48rem;--breakpoint-lg:64rem;--breakpoint-xl:80rem;--breakpoint-2xl:96rem;--container-3xs:16rem;--container-2xs:18rem;--container-xs:20rem;--container-sm:24rem;--container-md:28rem;--container-lg:32rem;--container-xl:36rem;--container-2xl:42rem;--container-3xl:48rem;--container-4xl:56rem;--container-5xl:64rem;--container-6xl:72rem;--container-7xl:80rem;--text-xs:.75rem;--text-xs--line-height:calc(1/.75);--text-sm:.875rem;--text-sm--line-height:calc(1.25/.875);--text-base:1rem;--text-base--line-height: 1.5 ;--text-lg:1.125rem;--text-lg--line-height:calc(1.75/1.125);--text-xl:1.25rem;--text-xl--line-height:calc(1.75/1.25);--text-2xl:1.5rem;--text-2xl--line-height:calc(2/1.5);--text-3xl:1.875rem;--text-3xl--line-height: 1.2 ;--text-4xl:2.25rem;--text-4xl--line-height:calc(2.5/2.25);--text-5xl:3rem;--text-5xl--line-height:1;--text-6xl:3.75rem;--text-6xl--line-height:1;--text-7xl:4.5rem;--text-7xl--line-height:1;--text-8xl:6rem;--text-8xl--line-height:1;--text-9xl:8rem;--text-9xl--line-height:1;--font-weight-thin:100;--font-weight-extralight:200;--font-weight-light:300;--font-weight-normal:400;--font-weight-medium:500;--font-weight-semibold:600;--font-weight-bold:700;--font-weight-extrabold:800;--font-weight-black:900;--tracking-tighter:-.05em;--tracking-tight:-.025em;--tracking-normal:0em;--tracking-wide:.025em;--tracking-wider:.05em;--tracking-widest:.1em;--leading-tight:1.25;--leading-snug:1.375;--leading-normal:1.5;--leading-relaxed:1.625;--leading-loose:2;--radius-xs:.125rem;--radius-sm:.25rem;--radius-md:.375rem;--radius-lg:.5rem;--radius-xl:.75rem;--radius-2xl:1rem;--radius-3xl:1.5rem;--radius-4xl:2rem;--shadow-2xs:0 1px #0000000d;--shadow-xs:0 1px 2px 0 #0000000d;--shadow-sm:0 1px 3px 0 #0000001a,0 1px 2px -1px #0000001a;--shadow-md:0 4px 6px -1px #0000001a,0 2px 4px -2px #0000001a;--shadow-lg:0 10px 15px -3px #0000001a,0 4px 6px -4px #0000001a;--shadow-xl:0 20px 25px -5px #0000001a,0 8px 10px -6px #0000001a;--shadow-2xl:0 25px 50px -12px #00000040;--inset-shadow-2xs:inset 0 1px #0000000d;--inset-shadow-xs:inset 0 1px 1px #0000000d;--inset-shadow-sm:inset 0 2px 4px #0000000d;--drop-shadow-xs:0 1px 1px #0000000d;--drop-shadow-sm:0 1px 2px #00000026;--drop-shadow-md:0 3px 3px #0000001f;--drop-shadow-lg:0 4px 4px #00000026;--drop-shadow-xl:0 9px 7px #0000001a;--drop-shadow-2xl:0 25px 25px #00000026;--ease-in:cubic-bezier(.4,0,1,1);--ease-out:cubic-bezier(0,0,.2,1);--ease-in-out:cubic-bezier(.4,0,.2,1);--animate-spin:spin 1s linear infinite;--animate-ping:ping 1s cubic-bezier(0,0,.2,1)infinite;--animate-pulse:pulse 2s cubic-bezier(.4,0,.6,1)infinite;--animate-bounce:bounce 1s infinite;--blur-xs:4px;--blur-sm:8px;--blur-md:12px;--blur-lg:16px;--blur-xl:24px;--blur-2xl:40px;--blur-3xl:64px;--perspective-dramatic:100px;--perspective-near:300px;--perspective-normal:500px;--perspective-midrange:800px;--perspective-distant:1200px;--aspect-video:16/9;--default-transition-duration:.15s;--default-transition-timing-function:cubic-bezier(.4,0,.2,1);--default-font-family:var(--font-sans);--default-font-feature-settings:var(--font-sans--font-feature-settings);--default-font-variation-settings:var(--font-sans--font-variation-settings);--default-mono-font-family:var(--font-mono);--default-mono-font-feature-settings:var(--font-mono--font-feature-settings);--default-mono-font-variation-settings:var(--font-mono--font-variation-settings)}}@layer base{*,:after,:before,::backdrop{box-sizing:border-box;border:0 solid;margin:0;padding:0}::file-selector-button{box-sizing:border-box;border:0 solid;margin:0;padding:0}html,:host{-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;line-height:1.5;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-feature-settings:var(--default-font-feature-settings,normal);font-variation-settings:var(--default-font-variation-settings,normal);-webkit-tap-highlight-color:transparent}body{line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,samp,pre{font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-feature-settings:var(--default-mono-font-feature-settings,normal);font-variation-settings:var(--default-mono-font-variation-settings,normal);font-size:1em}small{font-size:80%}sub,sup{vertical-align:baseline;font-size:75%;line-height:0;position:relative}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}ol,ul,menu{list-style:none}img,svg,video,canvas,audio,iframe,embed,object{vertical-align:middle;display:block}img,video{max-width:100%;height:auto}button,input,select,optgroup,textarea{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}::file-selector-button{font:inherit;font-feature-settings:inherit;font-variation-settings:inherit;letter-spacing:inherit;color:inherit;opacity:1;background-color:#0000;border-radius:0}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::placeholder{opacity:1;color:color-mix(in oklab,currentColor 50%,transparent)}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit{padding-block:0}::-webkit-datetime-edit-year-field{padding-block:0}::-webkit-datetime-edit-month-field{padding-block:0}::-webkit-datetime-edit-day-field{padding-block:0}::-webkit-datetime-edit-hour-field{padding-block:0}::-webkit-datetime-edit-minute-field{padding-block:0}::-webkit-datetime-edit-second-field{padding-block:0}::-webkit-datetime-edit-millisecond-field{padding-block:0}::-webkit-datetime-edit-meridiem-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::file-selector-button{-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button{height:auto}::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer components;@layer utilities{.absolute{position:absolute}.relative{position:relative}.static{position:static}.inset-0{inset:calc(var(--spacing)*0)}.-mt-\[4\.9rem\]{margin-top:-4.9rem}.-mb-px{margin-bottom:-1px}.mb-1{margin-bottom:calc(var(--spacing)*1)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.mb-6{margin-bottom:calc(var(--spacing)*6)}.-ml-8{margin-left:calc(var(--spacing)*-8)}.flex{display:flex}.hidden{display:none}.inline-block{display:inline-block}.inline-flex{display:inline-flex}.table{display:table}.aspect-\[335\/376\]{aspect-ratio:335/376}.h-1{height:calc(var(--spacing)*1)}.h-1\.5{height:calc(var(--spacing)*1.5)}.h-2{height:calc(var(--spacing)*2)}.h-2\.5{height:calc(var(--spacing)*2.5)}.h-3{height:calc(var(--spacing)*3)}.h-3\.5{height:calc(var(--spacing)*3.5)}.h-14{height:calc(var(--spacing)*14)}.h-14\.5{height:calc(var(--spacing)*14.5)}.min-h-screen{min-height:100vh}.w-1{width:calc(var(--spacing)*1)}.w-1\.5{width:calc(var(--spacing)*1.5)}.w-2{width:calc(var(--spacing)*2)}.w-2\.5{width:calc(var(--spacing)*2.5)}.w-3{width:calc(var(--spacing)*3)}.w-3\.5{width:calc(var(--spacing)*3.5)}.w-\[448px\]{width:448px}.w-full{width:100%}.max-w-\[335px\]{max-width:335px}.max-w-none{max-width:none}.flex-1{flex:1}.shrink-0{flex-shrink:0}.translate-y-0{--tw-translate-y:calc(var(--spacing)*0);translate:var(--tw-translate-x)var(--tw-translate-y)}.transform{transform:var(--tw-rotate-x)var(--tw-rotate-y)var(--tw-rotate-z)var(--tw-skew-x)var(--tw-skew-y)}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.items-center{align-items:center}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}:where(.space-x-1>:not(:last-child)){--tw-space-x-reverse:0;margin-inline-start:calc(calc(var(--spacing)*1)*var(--tw-space-x-reverse));margin-inline-end:calc(calc(var(--spacing)*1)*calc(1 - var(--tw-space-x-reverse)))}.overflow-hidden{overflow:hidden}.rounded-full{border-radius:3.40282e38px}.rounded-sm{border-radius:var(--radius-sm)}.rounded-t-lg{border-top-left-radius:var(--radius-lg);border-top-right-radius:var(--radius-lg)}.rounded-br-lg{border-bottom-right-radius:var(--radius-lg)}.rounded-bl-lg{border-bottom-left-radius:var(--radius-lg)}.border{border-style:var(--tw-border-style);border-width:1px}.border-\[\#19140035\]{border-color:#19140035}.border-\[\#e3e3e0\]{border-color:#e3e3e0}.border-black{border-color:var(--color-black)}.border-transparent{border-color:#0000}.bg-\[\#1b1b18\]{background-color:#1b1b18}.bg-\[\#FDFDFC\]{background-color:#fdfdfc}.bg-\[\#dbdbd7\]{background-color:#dbdbd7}.bg-\[\#fff2f2\]{background-color:#fff2f2}.bg-white{background-color:var(--color-white)}.p-6{padding:calc(var(--spacing)*6)}.px-5{padding-inline:calc(var(--spacing)*5)}.py-1{padding-block:calc(var(--spacing)*1)}.py-1\.5{padding-block:calc(var(--spacing)*1.5)}.py-2{padding-block:calc(var(--spacing)*2)}.pb-12{padding-bottom:calc(var(--spacing)*12)}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-\[13px\]{font-size:13px}.leading-\[20px\]{--tw-leading:20px;line-height:20px}.leading-normal{--tw-leading:var(--leading-normal);line-height:var(--leading-normal)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.text-\[\#1b1b18\]{color:#1b1b18}.text-\[\#706f6c\]{color:#706f6c}.text-\[\#F53003\],.text-\[\#f53003\]{color:#f53003}.text-white{color:var(--color-white)}.underline{text-decoration-line:underline}.underline-offset-4{text-underline-offset:4px}.opacity-100{opacity:1}.shadow-\[0px_0px_1px_0px_rgba\(0\,0\,0\,0\.03\)\,0px_1px_2px_0px_rgba\(0\,0\,0\,0\.06\)\]{--tw-shadow:0px 0px 1px 0px var(--tw-shadow-color,#00000008),0px 1px 2px 0px var(--tw-shadow-color,#0000000f);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-\[inset_0px_0px_0px_1px_rgba\(26\,26\,0\,0\.16\)\]{--tw-shadow:inset 0px 0px 0px 1px var(--tw-shadow-color,#1a1a0029);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.\!filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)!important}.filter{filter:var(--tw-blur,)var(--tw-brightness,)var(--tw-contrast,)var(--tw-grayscale,)var(--tw-hue-rotate,)var(--tw-invert,)var(--tw-saturate,)var(--tw-sepia,)var(--tw-drop-shadow,)}.transition-all{transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.transition-opacity{transition-property:opacity;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function));transition-duration:var(--tw-duration,var(--default-transition-duration))}.delay-300{transition-delay:.3s}.duration-750{--tw-duration:.75s;transition-duration:.75s}.not-has-\[nav\]\:hidden:not(:has(:is(nav))){display:none}.before\:absolute:before{content:var(--tw-content);position:absolute}.before\:top-0:before{content:var(--tw-content);top:calc(var(--spacing)*0)}.before\:top-1\/2:before{content:var(--tw-content);top:50%}.before\:bottom-0:before{content:var(--tw-content);bottom:calc(var(--spacing)*0)}.before\:bottom-1\/2:before{content:var(--tw-content);bottom:50%}.before\:left-\[0\.4rem\]:before{content:var(--tw-content);left:.4rem}.before\:border-l:before{content:var(--tw-content);border-left-style:var(--tw-border-style);border-left-width:1px}.before\:border-\[\#e3e3e0\]:before{content:var(--tw-content);border-color:#e3e3e0}@media (hover:hover){.hover\:border-\[\#1915014a\]:hover{border-color:#1915014a}.hover\:border-\[\#19140035\]:hover{border-color:#19140035}.hover\:border-black:hover{border-color:var(--color-black)}.hover\:bg-black:hover{background-color:var(--color-black)}}@media (width>=64rem){.lg\:-mt-\[6\.6rem\]{margin-top:-6.6rem}.lg\:mb-0{margin-bottom:calc(var(--spacing)*0)}.lg\:mb-6{margin-bottom:calc(var(--spacing)*6)}.lg\:-ml-px{margin-left:-1px}.lg\:ml-0{margin-left:calc(var(--spacing)*0)}.lg\:block{display:block}.lg\:aspect-auto{aspect-ratio:auto}.lg\:w-\[438px\]{width:438px}.lg\:max-w-4xl{max-width:var(--container-4xl)}.lg\:grow{flex-grow:1}.lg\:flex-row{flex-direction:row}.lg\:justify-center{justify-content:center}.lg\:rounded-t-none{border-top-left-radius:0;border-top-right-radius:0}.lg\:rounded-tl-lg{border-top-left-radius:var(--radius-lg)}.lg\:rounded-r-lg{border-top-right-radius:var(--radius-lg);border-bottom-right-radius:var(--radius-lg)}.lg\:rounded-br-none{border-bottom-right-radius:0}.lg\:p-8{padding:calc(var(--spacing)*8)}.lg\:p-20{padding:calc(var(--spacing)*20)}}@media (prefers-color-scheme:dark){.dark\:block{display:block}.dark\:hidden{display:none}.dark\:border-\[\#3E3E3A\]{border-color:#3e3e3a}.dark\:border-\[\#eeeeec\]{border-color:#eeeeec}.dark\:bg-\[\#0a0a0a\]{background-color:#0a0a0a}.dark\:bg-\[\#1D0002\]{background-color:#1d0002}.dark\:bg-\[\#3E3E3A\]{background-color:#3e3e3a}.dark\:bg-\[\#161615\]{background-color:#161615}.dark\:bg-\[\#eeeeec\]{background-color:#eeeeec}.dark\:text-\[\#1C1C1A\]{color:#1c1c1a}.dark\:text-\[\#A1A09A\]{color:#a1a09a}.dark\:text-\[\#EDEDEC\]{color:#ededec}.dark\:text-\[\#F61500\]{color:#f61500}.dark\:text-\[\#FF4433\]{color:#f43}.dark\:shadow-\[inset_0px_0px_0px_1px_\#fffaed2d\]{--tw-shadow:inset 0px 0px 0px 1px var(--tw-shadow-color,#fffaed2d);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.dark\:before\:border-\[\#3E3E3A\]:before{content:var(--tw-content);border-color:#3e3e3a}@media (hover:hover){.dark\:hover\:border-\[\#3E3E3A\]:hover{border-color:#3e3e3a}.dark\:hover\:border-\[\#62605b\]:hover{border-color:#62605b}.dark\:hover\:border-white:hover{border-color:var(--color-white)}.dark\:hover\:bg-white:hover{background-color:var(--color-white)}}}@starting-style{.starting\:translate-y-4{--tw-translate-y:calc(var(--spacing)*4);translate:var(--tw-translate-x)var(--tw-translate-y)}}@starting-style{.starting\:translate-y-6{--tw-translate-y:calc(var(--spacing)*6);translate:var(--tw-translate-x)var(--tw-translate-y)}}@starting-style{.starting\:opacity-0{opacity:0}}}@keyframes spin{to{transform:rotate(360deg)}}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes pulse{50%{opacity:.5}}@keyframes bounce{0%,to{animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-rotate-x{syntax:"*";inherits:false;initial-value:rotateX(0)}@property --tw-rotate-y{syntax:"*";inherits:false;initial-value:rotateY(0)}@property --tw-rotate-z{syntax:"*";inherits:false;initial-value:rotateZ(0)}@property --tw-skew-x{syntax:"*";inherits:false;initial-value:skewX(0)}@property --tw-skew-y{syntax:"*";inherits:false;initial-value:skewY(0)}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-leading{syntax:"*";inherits:false}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-content{syntax:"*";inherits:false;initial-value:""}
            </style>
        @endif
    </head>
    <body class="bg-[#FDFDFC] dark:bg-[#0a0a0a] text-[#1b1b18] flex p-6 lg:p-8 items-center lg:justify-center min-h-screen flex-col">
        <header class="w-full lg:max-w-4xl max-w-[335px] text-sm mb-6 not-has-[nav]:hidden">
            @if (Route::has('login'))
                <nav class="flex items-center justify-end gap-4">
                    @auth
                        <a
                            href="{{ url('/dashboard') }}"
                            class="inline-block px-5 py-1.5 dark:text-[#EDEDEC] border-[#19140035] hover:border-[#1915014a] border text-[#1b1b18] dark:border-[#3E3E3A] dark:hover:border-[#62605b] rounded-sm text-sm leading-normal"
                        >
                            Dashboard
                        </a>
                    @else
                        <a
                            href="{{ route('login') }}"
                            class="inline-block px-5 py-1.5 dark:text-[#EDEDEC] text-[#1b1b18] border border-transparent hover:border-[#19140035] dark:hover:border-[#3E3E3A] rounded-sm text-sm leading-normal"
                        >
                            Log in
                        </a>

                        @if (Route::has('register'))
                            <a
                                href="{{ route('register') }}"
                                class="inline-block px-5 py-1.5 dark:text-[#EDEDEC] border-[#19140035] hover:border-[#1915014a] border text-[#1b1b18] dark:border-[#3E3E3A] dark:hover:border-[#62605b] rounded-sm text-sm leading-normal">
                                Register
                            </a>
                        @endif
                    @endauth
                </nav>
            @endif
        </header>
        <div class="flex items-center justify-center w-full transition-opacity opacity-100 duration-750 lg:grow starting:opacity-0">
            <main class="flex max-w-[335px] w-full flex-col-reverse lg:max-w-4xl lg:flex-row">
                <div class="text-[13px] leading-[20px] flex-1 p-6 pb-12 lg:p-20 bg-white dark:bg-[#161615] dark:text-[#EDEDEC] shadow-[inset_0px_0px_0px_1px_rgba(26,26,0,0.16)] dark:shadow-[inset_0px_0px_0px_1px_#fffaed2d] rounded-bl-lg rounded-br-lg lg:rounded-tl-lg lg:rounded-br-none">
                    <h1 class="mb-1 font-medium">Let's get started</h1>
                    <p class="mb-2 text-[#706f6c] dark:text-[#A1A09A]">Laravel has an incredibly rich ecosystem. <br>We suggest starting with the following.</p>
                    <ul class="flex flex-col mb-4 lg:mb-6">
                        <li class="flex items-center gap-4 py-2 relative before:border-l before:border-[#e3e3e0] dark:before:border-[#3E3E3A] before:top-1/2 before:bottom-0 before:left-[0.4rem] before:absolute">
                            <span class="relative py-1 bg-white dark:bg-[#161615]">
                                <span class="flex items-center justify-center rounded-full bg-[#FDFDFC] dark:bg-[#161615] shadow-[0px_0px_1px_0px_rgba(0,0,0,0.03),0px_1px_2px_0px_rgba(0,0,0,0.06)] w-3.5 h-3.5 border dark:border-[#3E3E3A] border-[#e3e3e0]">
                                    <span class="rounded-full bg-[#dbdbd7] dark:bg-[#3E3E3A] w-1.5 h-1.5"></span>
                                </span>
                            </span>
                            <span>
                                Read the
                                <a href="https://laravel.com/docs" target="_blank" class="inline-flex items-center space-x-1 font-medium underline underline-offset-4 text-[#f53003] dark:text-[#FF4433] ml-1">
                                    <span>Documentation</span>
                                    <svg
                                        width="10"
                                        height="11"
                                        viewBox="0 0 10 11"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="w-2.5 h-2.5"
                                    >
                                        <path
                                            d="M7.70833 6.95834V2.79167H3.54167M2.5 8L7.5 3.00001"
                                            stroke="currentColor"
                                            stroke-linecap="square"
                                        />
                                    </svg>
                                </a>
                            </span>
                        </li>
                        <li class="flex items-center gap-4 py-2 relative before:border-l before:border-[#e3e3e0] dark:before:border-[#3E3E3A] before:bottom-1/2 before:top-0 before:left-[0.4rem] before:absolute">
                            <span class="relative py-1 bg-white dark:bg-[#161615]">
                                <span class="flex items-center justify-center rounded-full bg-[#FDFDFC] dark:bg-[#161615] shadow-[0px_0px_1px_0px_rgba(0,0,0,0.03),0px_1px_2px_0px_rgba(0,0,0,0.06)] w-3.5 h-3.5 border dark:border-[#3E3E3A] border-[#e3e3e0]">
                                    <span class="rounded-full bg-[#dbdbd7] dark:bg-[#3E3E3A] w-1.5 h-1.5"></span>
                                </span>
                            </span>
                            <span>
                                Watch video tutorials at
                                <a href="https://laracasts.com" target="_blank" class="inline-flex items-center space-x-1 font-medium underline underline-offset-4 text-[#f53003] dark:text-[#FF4433] ml-1">
                                    <span>Laracasts</span>
                                    <svg
                                        width="10"
                                        height="11"
                                        viewBox="0 0 10 11"
                                        fill="none"
                                        xmlns="http://www.w3.org/2000/svg"
                                        class="w-2.5 h-2.5"
                                    >
                                        <path
                                            d="M7.70833 6.95834V2.79167H3.54167M2.5 8L7.5 3.00001"
                                            stroke="currentColor"
                                            stroke-linecap="square"
                                        />
                                    </svg>
                                </a>
                            </span>
                        </li>
                    </ul>
                    <ul class="flex gap-3 text-sm leading-normal">
                        <li>
                            <a href="https://cloud.laravel.com" target="_blank" class="inline-block dark:bg-[#eeeeec] dark:border-[#eeeeec] dark:text-[#1C1C1A] dark:hover:bg-white dark:hover:border-white hover:bg-black hover:border-black px-5 py-1.5 bg-[#1b1b18] rounded-sm border border-black text-white text-sm leading-normal">
                                Deploy now
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="bg-[#fff2f2] dark:bg-[#1D0002] relative lg:-ml-px -mb-px lg:mb-0 rounded-t-lg lg:rounded-t-none lg:rounded-r-lg aspect-[335/376] lg:aspect-auto w-full lg:w-[438px] shrink-0 overflow-hidden">
                    {{-- Laravel Logo --}}
                    <svg class="w-full text-[#F53003] dark:text-[#F61500] transition-all translate-y-0 opacity-100 max-w-none duration-750 starting:opacity-0 starting:translate-y-6" viewBox="0 0 438 104" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17.2036 -3H0V102.197H49.5189V86.7187H17.2036V-3Z" fill="currentColor" />
                        <path d="M110.256 41.6337C108.061 38.1275 104.945 35.3731 100.905 33.3681C96.8667 31.3647 92.8016 30.3618 88.7131 30.3618C83.4247 30.3618 78.5885 31.3389 74.201 33.2923C69.8111 35.2456 66.0474 37.928 62.9059 41.3333C59.7643 44.7401 57.3198 48.6726 55.5754 53.1293C53.8287 57.589 52.9572 62.274 52.9572 67.1813C52.9572 72.1925 53.8287 76.8995 55.5754 81.3069C57.3191 85.7173 59.7636 89.6241 62.9059 93.0293C66.0474 96.4361 69.8119 99.1155 74.201 101.069C78.5885 103.022 83.4247 103.999 88.7131 103.999C92.8016 103.999 96.8667 102.997 100.905 100.994C104.945 98.9911 108.061 96.2359 110.256 92.7282V102.195H126.563V32.1642H110.256V41.6337ZM108.76 75.7472C107.762 78.4531 106.366 80.8078 104.572 82.8112C102.776 84.8161 100.606 86.4183 98.0637 87.6206C95.5202 88.823 92.7004 89.4238 89.6103 89.4238C86.5178 89.4238 83.7252 88.823 81.2324 87.6206C78.7388 86.4183 76.5949 84.8161 74.7998 82.8112C73.004 80.8078 71.6319 78.4531 70.6856 75.7472C69.7356 73.0421 69.2644 70.1868 69.2644 67.1821C69.2644 64.1758 69.7356 61.3205 70.6856 58.6154C71.6319 55.9102 73.004 53.5571 74.7998 51.5522C76.5949 49.5495 78.738 47.9451 81.2324 46.7427C83.7252 45.5404 86.5178 44.9396 89.6103 44.9396C92.7012 44.9396 95.5202 45.5404 98.0637 46.7427C100.606 47.9451 102.776 49.5487 104.572 51.5522C106.367 53.5571 107.762 55.9102 108.76 58.6154C109.756 61.3205 110.256 64.1758 110.256 67.1821C110.256 70.1868 109.756 73.0421 108.76 75.7472Z" fill="currentColor" />
                        <path d="M242.805 41.6337C240.611 38.1275 237.494 35.3731 233.455 33.3681C229.416 31.3647 225.351 30.3618 221.262 30.3618C215.974 30.3618 211.138 31.3389 206.75 33.2923C202.36 35.2456 198.597 37.928 195.455 41.3333C192.314 44.7401 189.869 48.6726 188.125 53.1293C186.378 57.589 185.507 62.274 185.507 67.1813C185.507 72.1925 186.378 76.8995 188.125 81.3069C189.868 85.7173 192.313 89.6241 195.455 93.0293C198.597 96.4361 202.361 99.1155 206.75 101.069C211.138 103.022 215.974 103.999 221.262 103.999C225.351 103.999 229.416 102.997 233.455 100.994C237.494 98.9911 240.611 96.2359 242.805 92.7282V102.195H259.112V32.1642H242.805V41.6337ZM241.31 75.7472C240.312 78.4531 238.916 80.8078 237.122 82.8112C235.326 84.8161 233.156 86.4183 230.614 87.6206C228.07 88.823 225.251 89.4238 222.16 89.4238C219.068 89.4238 216.275 88.823 213.782 87.6206C211.289 86.4183 209.145 84.8161 207.35 82.8112C205.554 80.8078 204.182 78.4531 203.236 75.7472C202.286 73.0421 201.814 70.1868 201.814 67.1821C201.814 64.1758 202.286 61.3205 203.236 58.6154C204.182 55.9102 205.554 53.5571 207.35 51.5522C209.145 49.5495 211.288 47.9451 213.782 46.7427C216.275 45.5404 219.068 44.9396 222.16 44.9396C225.251 44.9396 228.07 45.5404 230.614 46.7427C233.156 47.9451 235.326 49.5487 237.122 51.5522C238.917 53.5571 240.312 55.9102 241.31 58.6154C242.306 61.3205 242.806 64.1758 242.806 67.1821C242.805 70.1868 242.305 73.0421 241.31 75.7472Z" fill="currentColor" />
                        <path d="M438 -3H421.694V102.197H438V-3Z" fill="currentColor" />
                        <path d="M139.43 102.197H155.735V48.2834H183.712V32.1665H139.43V102.197Z" fill="currentColor" />
                        <path d="M324.49 32.1665L303.995 85.794L283.498 32.1665H266.983L293.748 102.197H314.242L341.006 32.1665H324.49Z" fill="currentColor" />
                        <path d="M376.571 30.3656C356.603 30.3656 340.797 46.8497 340.797 67.1828C340.797 89.6597 356.094 104 378.661 104C391.29 104 399.354 99.1488 409.206 88.5848L398.189 80.0226C398.183 80.031 389.874 90.9895 377.468 90.9895C363.048 90.9895 356.977 79.3111 356.977 73.269H411.075C413.917 50.1328 398.775 30.3656 376.571 30.3656ZM357.02 61.0967C357.145 59.7487 359.023 43.3761 376.442 43.3761C393.861 43.3761 395.978 59.7464 396.099 61.0967H357.02Z" fill="currentColor" />
                    </svg>

                    {{-- Light Mode 12 SVG --}}
                    <svg class="w-[448px] max-w-none relative -mt-[4.9rem] -ml-8 lg:ml-0 lg:-mt-[6.6rem] dark:hidden" viewBox="0 0 440 376" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M188.263 355.73L188.595 355.73C195.441 348.845 205.766 339.761 219.569 328.477C232.93 317.193 242.978 308.205 249.714 301.511C256.34 294.626 260.867 287.358 263.296 279.708C265.725 272.058 264.565 264.121 259.816 255.896C254.516 246.716 247.062 239.352 237.454 233.805C227.957 228.067 217.908 225.198 207.307 225.198C196.927 225.197 190.136 227.97 186.934 233.516C183.621 238.872 184.726 246.331 190.247 255.894L125.647 255.891C116.371 239.825 112.395 225.481 113.72 212.858C115.265 200.235 121.559 190.481 132.602 183.596C143.754 176.52 158.607 172.982 177.159 172.983C196.594 172.984 215.863 176.523 234.968 183.6C253.961 190.486 271.299 200.241 286.98 212.864C302.661 225.488 315.14 239.833 324.416 255.899C333.03 270.817 336.841 283.918 335.847 295.203C335.075 306.487 331.376 316.336 324.75 324.751C318.346 333.167 308.408 343.494 294.936 355.734L377.094 355.737L405.917 405.656L217.087 405.649L188.263 355.73Z" fill="black" />
                            <path d="M9.11884 226.339L-13.7396 226.338L-42.7286 176.132L43.0733 176.135L175.595 405.649L112.651 405.647L9.11884 226.339Z" fill="black" />
                            <path d="M188.263 355.73L188.595 355.73C195.441 348.845 205.766 339.761 219.569 328.477C232.93 317.193 242.978 308.205 249.714 301.511C256.34 294.626 260.867 287.358 263.296 279.708C265.725 272.058 264.565 264.121 259.816 255.896C254.516 246.716 247.062 239.352 237.454 233.805C227.957 228.067 217.908 225.198 207.307 225.198C196.927 225.197 190.136 227.97 186.934 233.516C183.621 238.872 184.726 246.331 190.247 255.894L125.647 255.891C116.371 239.825 112.395 225.481 113.72 212.858C115.265 200.235 121.559 190.481 132.602 183.596C143.754 176.52 158.607 172.982 177.159 172.983C196.594 172.984 215.863 176.523 234.968 183.6C253.961 190.486 271.299 200.241 286.98 212.864C302.661 225.488 315.14 239.833 324.416 255.899C333.03 270.817 336.841 283.918 335.847 295.203C335.075 306.487 331.376 316.336 324.75 324.751C318.346 333.167 308.408 343.494 294.936 355.734L377.094 355.737L405.917 405.656L217.087 405.649L188.263 355.73Z" stroke="#1B1B18" stroke-width="1" />
                            <path d="M9.11884 226.339L-13.7396 226.338L-42.7286 176.132L43.0733 176.135L175.595 405.649L112.651 405.647L9.11884 226.339Z" stroke="#1B1B18" stroke-width="1" />
                            <path d="M204.592 327.449L204.923 327.449C211.769 320.564 222.094 311.479 235.897 300.196C249.258 288.912 259.306 279.923 266.042 273.23C272.668 266.345 277.195 259.077 279.624 251.427C282.053 243.777 280.893 235.839 276.145 227.615C270.844 218.435 263.39 211.071 253.782 205.524C244.285 199.786 234.236 196.917 223.635 196.916C213.255 196.916 206.464 199.689 203.262 205.235C199.949 210.59 201.054 218.049 206.575 227.612L141.975 227.61C132.699 211.544 128.723 197.2 130.048 184.577C131.593 171.954 137.887 162.2 148.93 155.315C160.083 148.239 174.935 144.701 193.487 144.702C212.922 144.703 232.192 148.242 251.296 155.319C270.289 162.205 287.627 171.96 303.308 184.583C318.989 197.207 331.468 211.552 340.745 227.618C349.358 242.536 353.169 255.637 352.175 266.921C351.403 278.205 347.704 288.055 341.078 296.47C334.674 304.885 324.736 315.213 311.264 327.453L393.422 327.456L422.246 377.375L233.415 377.368L204.592 327.449Z" fill="#F8B803" />
                            <path d="M25.447 198.058L2.58852 198.057L-26.4005 147.851L59.4015 147.854L191.923 377.368L128.979 377.365L25.447 198.058Z" fill="#F8B803" />
                            <path d="M204.592 327.449L204.923 327.449C211.769 320.564 222.094 311.479 235.897 300.196C249.258 288.912 259.306 279.923 266.042 273.23C272.668 266.345 277.195 259.077 279.624 251.427C282.053 243.777 280.893 235.839 276.145 227.615C270.844 218.435 263.39 211.071 253.782 205.524C244.285 199.786 234.236 196.917 223.635 196.916C213.255 196.916 206.464 199.689 203.262 205.235C199.949 210.59 201.054 218.049 206.575 227.612L141.975 227.61C132.699 211.544 128.723 197.2 130.048 184.577C131.593 171.954 137.887 162.2 148.93 155.315C160.083 148.239 174.935 144.701 193.487 144.702C212.922 144.703 232.192 148.242 251.296 155.319C270.289 162.205 287.627 171.96 303.308 184.583C318.989 197.207 331.468 211.552 340.745 227.618C349.358 242.536 353.169 255.637 352.175 266.921C351.403 278.205 347.704 288.055 341.078 296.47C334.674 304.885 324.736 315.213 311.264 327.453L393.422 327.456L422.246 377.375L233.415 377.368L204.592 327.449Z" stroke="#1B1B18" stroke-width="1" />
                            <path d="M25.447 198.058L2.58852 198.057L-26.4005 147.851L59.4015 147.854L191.923 377.368L128.979 377.365L25.447 198.058Z" stroke="#1B1B18" stroke-width="1" />
                        </g>
                        <g style="mix-blend-mode: hard-light" class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M217.342 305.363L217.673 305.363C224.519 298.478 234.844 289.393 248.647 278.11C262.008 266.826 272.056 257.837 278.792 251.144C285.418 244.259 289.945 236.991 292.374 229.341C294.803 221.691 293.643 213.753 288.895 205.529C283.594 196.349 276.14 188.985 266.532 183.438C257.035 177.7 246.986 174.831 236.385 174.83C226.005 174.83 219.214 177.603 216.012 183.149C212.699 188.504 213.804 195.963 219.325 205.527L154.725 205.524C145.449 189.458 141.473 175.114 142.798 162.491C144.343 149.868 150.637 140.114 161.68 133.229C172.833 126.153 187.685 122.615 206.237 122.616C225.672 122.617 244.942 126.156 264.046 133.233C283.039 140.119 300.377 149.874 316.058 162.497C331.739 175.121 344.218 189.466 353.495 205.532C362.108 220.45 365.919 233.551 364.925 244.835C364.153 256.12 360.454 265.969 353.828 274.384C347.424 282.799 337.486 293.127 324.014 305.367L406.172 305.37L434.996 355.289L246.165 355.282L217.342 305.363Z" fill="#F0ACB8" />
                            <path d="M38.197 175.972L15.3385 175.971L-13.6505 125.765L72.1515 125.768L204.673 355.282L141.729 355.279L38.197 175.972Z" fill="#F0ACB8" />
                            <path d="M217.342 305.363L217.673 305.363C224.519 298.478 234.844 289.393 248.647 278.11C262.008 266.826 272.056 257.837 278.792 251.144C285.418 244.259 289.945 236.991 292.374 229.341C294.803 221.691 293.643 213.753 288.895 205.529C283.594 196.349 276.14 188.985 266.532 183.438C257.035 177.7 246.986 174.831 236.385 174.83C226.005 174.83 219.214 177.603 216.012 183.149C212.699 188.504 213.804 195.963 219.325 205.527L154.725 205.524C145.449 189.458 141.473 175.114 142.798 162.491C144.343 149.868 150.637 140.114 161.68 133.229C172.833 126.153 187.685 122.615 206.237 122.616C225.672 122.617 244.942 126.156 264.046 133.233C283.039 140.119 300.377 149.874 316.058 162.497C331.739 175.121 344.218 189.466 353.495 205.532C362.108 220.45 365.919 233.551 364.925 244.835C364.153 256.12 360.454 265.969 353.828 274.384C347.424 282.799 337.486 293.127 324.014 305.367L406.172 305.37L434.996 355.289L246.165 355.282L217.342 305.363Z" stroke="#1B1B18" stroke-width="1" />
                            <path d="M38.197 175.972L15.3385 175.971L-13.6505 125.765L72.1515 125.768L204.673 355.282L141.729 355.279L38.197 175.972Z" stroke="#1B1B18" stroke-width="1" />
                        </g>
                        <g style="mix-blend-mode: plus-darker" class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M230.951 281.792L231.282 281.793C238.128 274.907 248.453 265.823 262.256 254.539C275.617 243.256 285.666 234.267 292.402 227.573C299.027 220.688 303.554 213.421 305.983 205.771C308.412 198.12 307.253 190.183 302.504 181.959C297.203 172.778 289.749 165.415 280.142 159.868C270.645 154.13 260.596 151.26 249.995 151.26C239.615 151.26 232.823 154.033 229.621 159.579C226.309 164.934 227.413 172.393 232.935 181.956L168.335 181.954C159.058 165.888 155.082 151.543 156.407 138.92C157.953 126.298 164.247 116.544 175.289 109.659C186.442 102.583 201.294 99.045 219.846 99.0457C239.281 99.0464 258.551 102.585 277.655 109.663C296.649 116.549 313.986 126.303 329.667 138.927C345.349 151.551 357.827 165.895 367.104 181.961C375.718 196.88 379.528 209.981 378.535 221.265C377.762 232.549 374.063 242.399 367.438 250.814C361.033 259.229 351.095 269.557 337.624 281.796L419.782 281.8L448.605 331.719L259.774 331.712L230.951 281.792Z" fill="#F3BEC7" />
                            <path d="M51.8063 152.402L28.9479 152.401L-0.0411453 102.195L85.7608 102.198L218.282 331.711L155.339 331.709L51.8063 152.402Z" fill="#F3BEC7" />
                            <path d="M230.951 281.792L231.282 281.793C238.128 274.907 248.453 265.823 262.256 254.539C275.617 243.256 285.666 234.267 292.402 227.573C299.027 220.688 303.554 213.421 305.983 205.771C308.412 198.12 307.253 190.183 302.504 181.959C297.203 172.778 289.749 165.415 280.142 159.868C270.645 154.13 260.596 151.26 249.995 151.26C239.615 151.26 232.823 154.033 229.621 159.579C226.309 164.934 227.413 172.393 232.935 181.956L168.335 181.954C159.058 165.888 155.082 151.543 156.407 138.92C157.953 126.298 164.247 116.544 175.289 109.659C186.442 102.583 201.294 99.045 219.846 99.0457C239.281 99.0464 258.551 102.585 277.655 109.663C296.649 116.549 313.986 126.303 329.667 138.927C345.349 151.551 357.827 165.895 367.104 181.961C375.718 196.88 379.528 209.981 378.535 221.265C377.762 232.549 374.063 242.399 367.438 250.814C361.033 259.229 351.095 269.557 337.624 281.796L419.782 281.8L448.605 331.719L259.774 331.712L230.951 281.792Z" stroke="#1B1B18" stroke-width="1" />
                            <path d="M51.8063 152.402L28.9479 152.401L-0.0411453 102.195L85.7608 102.198L218.282 331.711L155.339 331.709L51.8063 152.402Z" stroke="#1B1B18" stroke-width="1" />
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M188.467 355.363L188.798 355.363C195.644 348.478 205.969 339.393 219.772 328.11C233.133 316.826 243.181 307.837 249.917 301.144C253.696 297.217 256.792 293.166 259.205 288.991C261.024 285.845 262.455 282.628 263.499 279.341C265.928 271.691 264.768 263.753 260.02 255.529C254.719 246.349 247.265 238.985 237.657 233.438C228.16 227.7 218.111 224.831 207.51 224.83C197.13 224.83 190.339 227.603 187.137 233.149C183.824 238.504 184.929 245.963 190.45 255.527L125.851 255.524C116.574 239.458 112.598 225.114 113.923 212.491C114.615 206.836 116.261 201.756 118.859 197.253C122.061 191.704 126.709 187.03 132.805 183.229C143.958 176.153 158.81 172.615 177.362 172.616C196.797 172.617 216.067 176.156 235.171 183.233C254.164 190.119 271.502 199.874 287.183 212.497C302.864 225.121 315.343 239.466 324.62 255.532C333.233 270.45 337.044 283.551 336.05 294.835C335.46 303.459 333.16 311.245 329.151 318.194C327.915 320.337 326.515 322.4 324.953 324.384C318.549 332.799 308.611 343.127 295.139 355.367L377.297 355.37L406.121 405.289L217.29 405.282L188.467 355.363Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M9.32197 225.972L-13.5365 225.971L-42.5255 175.765L43.2765 175.768L175.798 405.282L112.854 405.279L9.32197 225.972Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M345.247 111.915C329.566 99.2919 312.229 89.5371 293.235 82.6512L235.167 183.228C254.161 190.114 271.498 199.869 287.179 212.492L345.247 111.915Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M382.686 154.964C373.41 138.898 360.931 124.553 345.25 111.93L287.182 212.506C302.863 225.13 315.342 239.475 324.618 255.541L382.686 154.964Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M293.243 82.6472C274.139 75.57 254.869 72.031 235.434 72.0303L177.366 172.607C196.801 172.608 216.071 176.147 235.175 183.224L293.243 82.6472Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M394.118 194.257C395.112 182.973 391.301 169.872 382.688 154.953L324.619 255.53C333.233 270.448 337.044 283.55 336.05 294.834L394.118 194.257Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M235.432 72.0311C216.88 72.0304 202.027 75.5681 190.875 82.6442L132.806 183.221C143.959 176.145 158.812 172.607 177.363 172.608L235.432 72.0311Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M265.59 124.25C276.191 124.251 286.24 127.12 295.737 132.858L237.669 233.435C228.172 227.697 218.123 224.828 207.522 224.827L265.59 124.25Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M295.719 132.859C305.326 138.406 312.78 145.77 318.081 154.95L260.013 255.527C254.712 246.347 247.258 238.983 237.651 233.436L295.719 132.859Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M387.218 217.608C391.227 210.66 393.527 202.874 394.117 194.25L336.049 294.827C335.459 303.451 333.159 311.237 329.15 318.185L387.218 217.608Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M245.211 132.577C248.413 127.03 255.204 124.257 265.584 124.258L207.516 224.835C197.136 224.834 190.345 227.607 187.143 233.154L245.211 132.577Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M318.094 154.945C322.842 163.17 324.002 171.107 321.573 178.757L263.505 279.334C265.934 271.684 264.774 263.746 260.026 255.522L318.094 154.945Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M176.925 96.6737C180.127 91.1249 184.776 86.4503 190.871 82.6499L132.803 183.227C126.708 187.027 122.059 191.702 118.857 197.25L176.925 96.6737Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M387.226 217.606C385.989 219.749 384.59 221.813 383.028 223.797L324.96 324.373C326.522 322.39 327.921 320.326 329.157 318.183L387.226 217.606Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M317.269 188.408C319.087 185.262 320.519 182.045 321.562 178.758L263.494 279.335C262.451 282.622 261.019 285.839 259.201 288.985L317.269 188.408Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M245.208 132.573C241.895 137.928 243 145.387 248.522 154.95L190.454 255.527C184.932 245.964 183.827 238.505 187.14 233.15L245.208 132.573Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M176.93 96.6719C174.331 101.175 172.686 106.255 171.993 111.91L113.925 212.487C114.618 206.831 116.263 201.752 118.862 197.249L176.93 96.6719Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M317.266 188.413C314.853 192.589 311.757 196.64 307.978 200.566L249.91 301.143C253.689 297.216 256.785 293.166 259.198 288.99L317.266 188.413Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M464.198 304.708L435.375 254.789L377.307 355.366L406.13 405.285L464.198 304.708Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M353.209 254.787C366.68 242.548 376.618 232.22 383.023 223.805L324.955 324.382C318.55 332.797 308.612 343.124 295.141 355.364L353.209 254.787Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M435.37 254.787L353.212 254.784L295.144 355.361L377.302 355.364L435.37 254.787Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M183.921 154.947L248.521 154.95L190.453 255.527L125.853 255.524L183.921 154.947Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M171.992 111.914C170.668 124.537 174.643 138.881 183.92 154.947L125.852 255.524C116.575 239.458 112.599 225.114 113.924 212.491L171.992 111.914Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M307.987 200.562C301.251 207.256 291.203 216.244 277.842 227.528L219.774 328.105C233.135 316.821 243.183 307.832 249.919 301.139L307.987 200.562Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M15.5469 75.1797L44.5359 125.386L-13.5321 225.963L-42.5212 175.756L15.5469 75.1797Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M277.836 227.536C264.033 238.82 253.708 247.904 246.862 254.789L188.794 355.366C195.64 348.481 205.965 339.397 219.768 328.113L277.836 227.536Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M275.358 304.706L464.189 304.713L406.12 405.29L217.29 405.283L275.358 304.706Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M44.5279 125.39L67.3864 125.39L9.31834 225.967L-13.5401 225.966L44.5279 125.39Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M101.341 75.1911L233.863 304.705L175.795 405.282L43.2733 175.768L101.341 75.1911ZM15.5431 75.19L-42.525 175.767L43.277 175.77L101.345 75.1932L15.5431 75.19Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M246.866 254.784L246.534 254.784L188.466 355.361L188.798 355.361L246.866 254.784Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M246.539 254.781L275.362 304.701L217.294 405.277L188.471 355.358L246.539 254.781Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M67.3906 125.391L170.923 304.698L112.855 405.275L9.32257 225.967L67.3906 125.391Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                            <path d="M170.921 304.699L233.865 304.701L175.797 405.278L112.853 405.276L170.921 304.699Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="bevel" />
                        </g>
                        <g style="mix-blend-mode: hard-light" class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M246.544 254.79L246.875 254.79C253.722 247.905 264.046 238.82 277.849 227.537C291.21 216.253 301.259 207.264 307.995 200.57C314.62 193.685 319.147 186.418 321.577 178.768C324.006 171.117 322.846 163.18 318.097 154.956C312.796 145.775 305.342 138.412 295.735 132.865C286.238 127.127 276.189 124.258 265.588 124.257C255.208 124.257 248.416 127.03 245.214 132.576C241.902 137.931 243.006 145.39 248.528 154.953L183.928 154.951C174.652 138.885 170.676 124.541 172 111.918C173.546 99.2946 179.84 89.5408 190.882 82.6559C202.035 75.5798 216.887 72.0421 235.439 72.0428C254.874 72.0435 274.144 75.5825 293.248 82.6598C312.242 89.5457 329.579 99.3005 345.261 111.924C360.942 124.548 373.421 138.892 382.697 154.958C391.311 169.877 395.121 182.978 394.128 194.262C393.355 205.546 389.656 215.396 383.031 223.811C376.627 232.226 366.688 242.554 353.217 254.794L435.375 254.797L464.198 304.716L275.367 304.709L246.544 254.79Z" fill="#F0ACB8" />
                            <path d="M246.544 254.79L246.875 254.79C253.722 247.905 264.046 238.82 277.849 227.537C291.21 216.253 301.259 207.264 307.995 200.57C314.62 193.685 319.147 186.418 321.577 178.768C324.006 171.117 322.846 163.18 318.097 154.956C312.796 145.775 305.342 138.412 295.735 132.865C286.238 127.127 276.189 124.258 265.588 124.257C255.208 124.257 248.416 127.03 245.214 132.576C241.902 137.931 243.006 145.39 248.528 154.953L183.928 154.951C174.652 138.885 170.676 124.541 172 111.918C173.546 99.2946 179.84 89.5408 190.882 82.6559C202.035 75.5798 216.887 72.0421 235.439 72.0428C254.874 72.0435 274.144 75.5825 293.248 82.6598C312.242 89.5457 329.579 99.3005 345.261 111.924C360.942 124.548 373.421 138.892 382.697 154.958C391.311 169.877 395.121 182.978 394.128 194.262C393.355 205.546 389.656 215.396 383.031 223.811C376.627 232.226 366.688 242.554 353.217 254.794L435.375 254.797L464.198 304.716L275.367 304.709L246.544 254.79Z" stroke="#1B1B18" stroke-width="1" stroke-linejoin="round" />
                        </g>
                        <g style="mix-blend-mode: hard-light" class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M67.41 125.402L44.5515 125.401L15.5625 75.1953L101.364 75.1985L233.886 304.712L170.942 304.71L67.41 125.402Z" fill="#F0ACB8" />
                            <path d="M67.41 125.402L44.5515 125.401L15.5625 75.1953L101.364 75.1985L233.886 304.712L170.942 304.71L67.41 125.402Z" stroke="#1B1B18" stroke-width="1" />
                        </g>
                    </svg>

                    {{-- Dark Mode 12 SVG --}}
                    <svg class="w-[448px] max-w-none relative -mt-[4.9rem] -ml-8 lg:ml-0 lg:-mt-[6.6rem] hidden dark:block" viewBox="0 0 440 376" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M188.263 355.73L188.595 355.73C195.441 348.845 205.766 339.761 219.569 328.477C232.93 317.193 242.978 308.205 249.714 301.511C256.34 294.626 260.867 287.358 263.296 279.708C265.725 272.058 264.565 264.121 259.816 255.896C254.516 246.716 247.062 239.352 237.454 233.805C227.957 228.067 217.908 225.198 207.307 225.198C196.927 225.197 190.136 227.97 186.934 233.516C183.621 238.872 184.726 246.331 190.247 255.894L125.647 255.891C116.371 239.825 112.395 225.481 113.72 212.858C115.265 200.235 121.559 190.481 132.602 183.596C143.754 176.52 158.607 172.982 177.159 172.983C196.594 172.984 215.863 176.523 234.968 183.6C253.961 190.486 271.299 200.241 286.98 212.864C302.661 225.488 315.14 239.833 324.416 255.899C333.03 270.817 336.841 283.918 335.847 295.203C335.075 306.487 331.376 316.336 324.75 324.751C318.346 333.167 308.408 343.494 294.936 355.734L377.094 355.737L405.917 405.656L217.087 405.649L188.263 355.73Z" fill="black"/>
                            <path d="M9.11884 226.339L-13.7396 226.338L-42.7286 176.132L43.0733 176.135L175.595 405.649L112.651 405.647L9.11884 226.339Z" fill="black"/>
                            <path d="M188.263 355.73L188.595 355.73C195.441 348.845 205.766 339.761 219.569 328.477C232.93 317.193 242.978 308.205 249.714 301.511C256.34 294.626 260.867 287.358 263.296 279.708C265.725 272.058 264.565 264.121 259.816 255.896C254.516 246.716 247.062 239.352 237.454 233.805C227.957 228.067 217.908 225.198 207.307 225.198C196.927 225.197 190.136 227.97 186.934 233.516C183.621 238.872 184.726 246.331 190.247 255.894L125.647 255.891C116.371 239.825 112.395 225.481 113.72 212.858C115.265 200.235 121.559 190.481 132.602 183.596C143.754 176.52 158.607 172.982 177.159 172.983C196.594 172.984 215.863 176.523 234.968 183.6C253.961 190.486 271.299 200.241 286.98 212.864C302.661 225.488 315.14 239.833 324.416 255.899C333.03 270.817 336.841 283.918 335.847 295.203C335.075 306.487 331.376 316.336 324.75 324.751C318.346 333.167 308.408 343.494 294.936 355.734L377.094 355.737L405.917 405.656L217.087 405.649L188.263 355.73Z" stroke="#FF750F" stroke-width="1"/>
                            <path d="M9.11884 226.339L-13.7396 226.338L-42.7286 176.132L43.0733 176.135L175.595 405.649L112.651 405.647L9.11884 226.339Z" stroke="#FF750F" stroke-width="1"/>
                            <path d="M204.592 327.449L204.923 327.449C211.769 320.564 222.094 311.479 235.897 300.196C249.258 288.912 259.306 279.923 266.042 273.23C272.668 266.345 277.195 259.077 279.624 251.427C282.053 243.777 280.893 235.839 276.145 227.615C270.844 218.435 263.39 211.071 253.782 205.524C244.285 199.786 234.236 196.917 223.635 196.916C213.255 196.916 206.464 199.689 203.262 205.235C199.949 210.59 201.054 218.049 206.575 227.612L141.975 227.61C132.699 211.544 128.723 197.2 130.048 184.577C131.593 171.954 137.887 162.2 148.93 155.315C160.083 148.239 174.935 144.701 193.487 144.702C212.922 144.703 232.192 148.242 251.296 155.319C270.289 162.205 287.627 171.96 303.308 184.583C318.989 197.207 331.468 211.552 340.745 227.618C349.358 242.536 353.169 255.637 352.175 266.921C351.403 278.205 347.704 288.055 341.078 296.47C334.674 304.885 324.736 315.213 311.264 327.453L393.422 327.456L422.246 377.375L233.415 377.368L204.592 327.449Z" fill="#391800"/>
                            <path d="M25.447 198.058L2.58852 198.057L-26.4005 147.851L59.4015 147.854L191.923 377.368L128.979 377.365L25.447 198.058Z" fill="#391800"/>
                            <path d="M204.592 327.449L204.923 327.449C211.769 320.564 222.094 311.479 235.897 300.196C249.258 288.912 259.306 279.923 266.042 273.23C272.668 266.345 277.195 259.077 279.624 251.427C282.053 243.777 280.893 235.839 276.145 227.615C270.844 218.435 263.39 211.071 253.782 205.524C244.285 199.786 234.236 196.917 223.635 196.916C213.255 196.916 206.464 199.689 203.262 205.235C199.949 210.59 201.054 218.049 206.575 227.612L141.975 227.61C132.699 211.544 128.723 197.2 130.048 184.577C131.593 171.954 137.887 162.2 148.93 155.315C160.083 148.239 174.935 144.701 193.487 144.702C212.922 144.703 232.192 148.242 251.296 155.319C270.289 162.205 287.627 171.96 303.308 184.583C318.989 197.207 331.468 211.552 340.745 227.618C349.358 242.536 353.169 255.637 352.175 266.921C351.403 278.205 347.704 288.055 341.078 296.47C334.674 304.885 324.736 315.213 311.264 327.453L393.422 327.456L422.246 377.375L233.415 377.368L204.592 327.449Z" stroke="#FF750F" stroke-width="1"/>
                            <path d="M25.447 198.058L2.58852 198.057L-26.4005 147.851L59.4015 147.854L191.923 377.368L128.979 377.365L25.447 198.058Z" stroke="#FF750F" stroke-width="1"/>
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4" style="mix-blend-mode:hard-light">
                            <path d="M217.342 305.363L217.673 305.363C224.519 298.478 234.844 289.393 248.647 278.11C262.008 266.826 272.056 257.837 278.792 251.144C285.418 244.259 289.945 236.991 292.374 229.341C294.803 221.691 293.643 213.753 288.895 205.529C283.594 196.349 276.14 188.985 266.532 183.438C257.035 177.7 246.986 174.831 236.385 174.83C226.005 174.83 219.214 177.603 216.012 183.149C212.699 188.504 213.804 195.963 219.325 205.527L154.725 205.524C145.449 189.458 141.473 175.114 142.798 162.491C144.343 149.868 150.637 140.114 161.68 133.229C172.833 126.153 187.685 122.615 206.237 122.616C225.672 122.617 244.942 126.156 264.046 133.233C283.039 140.119 300.377 149.874 316.058 162.497C331.739 175.121 344.218 189.466 353.495 205.532C362.108 220.45 365.919 233.551 364.925 244.835C364.153 256.12 360.454 265.969 353.828 274.384C347.424 282.799 337.486 293.127 324.014 305.367L406.172 305.37L434.996 355.289L246.165 355.282L217.342 305.363Z" fill="#733000"/>
                            <path d="M38.197 175.972L15.3385 175.971L-13.6505 125.765L72.1515 125.768L204.673 355.282L141.729 355.279L38.197 175.972Z" fill="#733000"/>
                            <path d="M217.342 305.363L217.673 305.363C224.519 298.478 234.844 289.393 248.647 278.11C262.008 266.826 272.056 257.837 278.792 251.144C285.418 244.259 289.945 236.991 292.374 229.341C294.803 221.691 293.643 213.753 288.895 205.529C283.594 196.349 276.14 188.985 266.532 183.438C257.035 177.7 246.986 174.831 236.385 174.83C226.005 174.83 219.214 177.603 216.012 183.149C212.699 188.504 213.804 195.963 219.325 205.527L154.725 205.524C145.449 189.458 141.473 175.114 142.798 162.491C144.343 149.868 150.637 140.114 161.68 133.229C172.833 126.153 187.685 122.615 206.237 122.616C225.672 122.617 244.942 126.156 264.046 133.233C283.039 140.119 300.377 149.874 316.058 162.497C331.739 175.121 344.218 189.466 353.495 205.532C362.108 220.45 365.919 233.551 364.925 244.835C364.153 256.12 360.454 265.969 353.828 274.384C347.424 282.799 337.486 293.127 324.014 305.367L406.172 305.37L434.996 355.289L246.165 355.282L217.342 305.363Z" stroke="#FF750F" stroke-width="1"/>
                            <path d="M38.197 175.972L15.3385 175.971L-13.6505 125.765L72.1515 125.768L204.673 355.282L141.729 355.279L38.197 175.972Z" stroke="#FF750F" stroke-width="1"/>
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M217.342 305.363L217.673 305.363C224.519 298.478 234.844 289.393 248.647 278.11C262.008 266.826 272.056 257.837 278.792 251.144C285.418 244.259 289.945 236.991 292.374 229.341C294.803 221.691 293.643 213.753 288.895 205.529C283.594 196.349 276.14 188.985 266.532 183.438C257.035 177.7 246.986 174.831 236.385 174.83C226.005 174.83 219.214 177.603 216.012 183.149C212.699 188.504 213.804 195.963 219.325 205.527L154.726 205.524C145.449 189.458 141.473 175.114 142.798 162.491C144.343 149.868 150.637 140.114 161.68 133.229C172.833 126.153 187.685 122.615 206.237 122.616C225.672 122.617 244.942 126.156 264.046 133.233C283.039 140.119 300.377 149.874 316.058 162.497C331.739 175.121 344.218 189.466 353.495 205.532C362.108 220.45 365.919 233.551 364.925 244.835C364.153 256.12 360.454 265.969 353.828 274.384C347.424 282.799 337.486 293.127 324.014 305.367L406.172 305.37L434.996 355.289L246.165 355.282L217.342 305.363Z" stroke="#FF750F" stroke-width="1"/>
                            <path d="M38.197 175.972L15.3385 175.971L-13.6505 125.765L72.1515 125.768L204.673 355.282L141.729 355.279L38.197 175.972Z" stroke="#FF750F" stroke-width="1"/>
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4">
                            <path d="M188.467 355.363L188.798 355.363C195.644 348.478 205.969 339.393 219.772 328.11C233.133 316.826 243.181 307.837 249.917 301.144C253.696 297.217 256.792 293.166 259.205 288.991C261.024 285.845 262.455 282.628 263.499 279.341C265.928 271.691 264.768 263.753 260.02 255.529C254.719 246.349 247.265 238.985 237.657 233.438C228.16 227.7 218.111 224.831 207.51 224.83C197.13 224.83 190.339 227.603 187.137 233.149C183.824 238.504 184.929 245.963 190.45 255.527L125.851 255.524C116.574 239.458 112.598 225.114 113.923 212.491C114.615 206.836 116.261 201.756 118.859 197.253C122.061 191.704 126.709 187.03 132.805 183.229C143.958 176.153 158.81 172.615 177.362 172.616C196.797 172.617 216.067 176.156 235.171 183.233C254.164 190.119 271.502 199.874 287.183 212.497C302.864 225.121 315.343 239.466 324.62 255.532C333.233 270.45 337.044 283.551 336.05 294.835C335.46 303.459 333.16 311.245 329.151 318.194C327.915 320.337 326.515 322.4 324.953 324.384C318.549 332.799 308.611 343.127 295.139 355.367L377.297 355.37L406.121 405.289L217.29 405.282L188.467 355.363Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M9.32197 225.972L-13.5365 225.971L-42.5255 175.765L43.2765 175.768L175.798 405.282L112.854 405.279L9.32197 225.972Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M345.247 111.915C329.566 99.2919 312.229 89.5371 293.235 82.6512L235.167 183.228C254.161 190.114 271.498 199.869 287.179 212.492L345.247 111.915Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M382.686 154.964C373.41 138.898 360.931 124.553 345.25 111.93L287.182 212.506C302.863 225.13 315.342 239.475 324.618 255.541L382.686 154.964Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M293.243 82.6472C274.139 75.57 254.869 72.031 235.434 72.0303L177.366 172.607C196.801 172.608 216.071 176.147 235.175 183.224L293.243 82.6472Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M394.118 194.257C395.112 182.973 391.301 169.872 382.688 154.953L324.619 255.53C333.233 270.448 337.044 283.55 336.05 294.834L394.118 194.257Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M235.432 72.0311C216.88 72.0304 202.027 75.5681 190.875 82.6442L132.806 183.221C143.959 176.145 158.812 172.607 177.363 172.608L235.432 72.0311Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M265.59 124.25C276.191 124.251 286.24 127.12 295.737 132.858L237.669 233.435C228.172 227.697 218.123 224.828 207.522 224.827L265.59 124.25Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M295.719 132.859C305.326 138.406 312.78 145.77 318.081 154.95L260.013 255.527C254.712 246.347 247.258 238.983 237.651 233.436L295.719 132.859Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M387.218 217.608C391.227 210.66 393.527 202.874 394.117 194.25L336.049 294.827C335.459 303.451 333.159 311.237 329.15 318.185L387.218 217.608Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M245.211 132.577C248.413 127.03 255.204 124.257 265.584 124.258L207.516 224.835C197.136 224.834 190.345 227.607 187.143 233.154L245.211 132.577Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M318.094 154.945C322.842 163.17 324.002 171.107 321.573 178.757L263.505 279.334C265.934 271.684 264.774 263.746 260.026 255.522L318.094 154.945Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M176.925 96.6737C180.127 91.1249 184.776 86.4503 190.871 82.6499L132.803 183.227C126.708 187.027 122.059 191.702 118.857 197.25L176.925 96.6737Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M387.226 217.606C385.989 219.749 384.59 221.813 383.028 223.797L324.96 324.373C326.522 322.39 327.921 320.326 329.157 318.183L387.226 217.606Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M317.269 188.408C319.087 185.262 320.519 182.045 321.562 178.758L263.494 279.335C262.451 282.622 261.019 285.839 259.201 288.985L317.269 188.408Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M245.208 132.573C241.895 137.928 243 145.387 248.522 154.95L190.454 255.527C184.932 245.964 183.827 238.505 187.14 233.15L245.208 132.573Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M176.93 96.6719C174.331 101.175 172.686 106.255 171.993 111.91L113.925 212.487C114.618 206.831 116.263 201.752 118.862 197.249L176.93 96.6719Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M317.266 188.413C314.853 192.589 311.757 196.64 307.978 200.566L249.91 301.143C253.689 297.216 256.785 293.166 259.198 288.99L317.266 188.413Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M464.198 304.708L435.375 254.789L377.307 355.366L406.13 405.285L464.198 304.708Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M353.209 254.787C366.68 242.548 376.618 232.22 383.023 223.805L324.955 324.382C318.55 332.797 308.612 343.124 295.141 355.364L353.209 254.787Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M435.37 254.787L353.212 254.784L295.144 355.361L377.302 355.364L435.37 254.787Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M183.921 154.947L248.521 154.95L190.453 255.527L125.853 255.524L183.921 154.947Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M171.992 111.914C170.668 124.537 174.643 138.881 183.92 154.947L125.852 255.524C116.575 239.458 112.599 225.114 113.924 212.491L171.992 111.914Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M307.987 200.562C301.251 207.256 291.203 216.244 277.842 227.528L219.774 328.105C233.135 316.821 243.183 307.832 249.919 301.139L307.987 200.562Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M15.5469 75.1797L44.5359 125.386L-13.5321 225.963L-42.5212 175.756L15.5469 75.1797Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M277.836 227.536C264.033 238.82 253.708 247.904 246.862 254.789L188.794 355.366C195.64 348.481 205.965 339.397 219.768 328.113L277.836 227.536Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M275.358 304.706L464.189 304.713L406.12 405.29L217.29 405.283L275.358 304.706Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M44.5279 125.39L67.3864 125.39L9.31834 225.967L-13.5401 225.966L44.5279 125.39Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M101.341 75.1911L233.863 304.705L175.795 405.282L43.2733 175.768L101.341 75.1911ZM15.5431 75.19L-42.525 175.767L43.277 175.77L101.345 75.1932L15.5431 75.19Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M246.866 254.784L246.534 254.784L188.466 355.361L188.798 355.361L246.866 254.784Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M246.539 254.781L275.362 304.701L217.294 405.277L188.471 355.358L246.539 254.781Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M67.3906 125.391L170.923 304.698L112.855 405.275L9.32257 225.967L67.3906 125.391Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                            <path d="M170.921 304.699L233.865 304.701L175.797 405.278L112.853 405.276L170.921 304.699Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="bevel"/>
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4" style="mix-blend-mode:hard-light">
                            <path d="M246.544 254.79L246.875 254.79C253.722 247.905 264.046 238.82 277.849 227.537C291.21 216.253 301.259 207.264 307.995 200.57C314.62 193.685 319.147 186.418 321.577 178.768C324.006 171.117 322.846 163.18 318.097 154.956C312.796 145.775 305.342 138.412 295.735 132.865C286.238 127.127 276.189 124.258 265.588 124.257C255.208 124.257 248.416 127.03 245.214 132.576C241.902 137.931 243.006 145.39 248.528 154.953L183.928 154.951C174.652 138.885 170.676 124.541 172 111.918C173.546 99.2946 179.84 89.5408 190.882 82.6559C202.035 75.5798 216.887 72.0421 235.439 72.0428C254.874 72.0435 274.144 75.5825 293.248 82.6598C312.242 89.5457 329.579 99.3005 345.261 111.924C360.942 124.548 373.421 138.892 382.697 154.958C391.311 169.877 395.121 182.978 394.128 194.262C393.355 205.546 389.656 215.396 383.031 223.811C376.627 232.226 366.688 242.554 353.217 254.794L435.375 254.797L464.198 304.716L275.367 304.709L246.544 254.79Z" fill="#4B0600"/>
                            <path d="M246.544 254.79L246.875 254.79C253.722 247.905 264.046 238.82 277.849 227.537C291.21 216.253 301.259 207.264 307.995 200.57C314.62 193.685 319.147 186.418 321.577 178.768C324.006 171.117 322.846 163.18 318.097 154.956C312.796 145.775 305.342 138.412 295.735 132.865C286.238 127.127 276.189 124.258 265.588 124.257C255.208 124.257 248.416 127.03 245.214 132.576C241.902 137.931 243.006 145.39 248.528 154.953L183.928 154.951C174.652 138.885 170.676 124.541 172 111.918C173.546 99.2946 179.84 89.5408 190.882 82.6559C202.035 75.5798 216.887 72.0421 235.439 72.0428C254.874 72.0435 274.144 75.5825 293.248 82.6598C312.242 89.5457 329.579 99.3005 345.261 111.924C360.942 124.548 373.421 138.892 382.697 154.958C391.311 169.877 395.121 182.978 394.128 194.262C393.355 205.546 389.656 215.396 383.031 223.811C376.627 232.226 366.688 242.554 353.217 254.794L435.375 254.797L464.198 304.716L275.367 304.709L246.544 254.79Z" stroke="#FF750F" stroke-width="1" stroke-linejoin="round"/>
                        </g>
                        <g class="transition-all delay-300 translate-y-0 opacity-100 duration-750 starting:opacity-0 starting:translate-y-4" style="mix-blend-mode:hard-light">
                            <path d="M67.41 125.402L44.5515 125.401L15.5625 75.1953L101.364 75.1985L233.886 304.712L170.942 304.71L67.41 125.402Z" fill="#4B0600"/>
                            <path d="M67.41 125.402L44.5515 125.401L15.5625 75.1953L101.364 75.1985L233.886 304.712L170.942 304.71L67.41 125.402Z" stroke="#FF750F" stroke-width="1"/>
                        </g>
                    </svg>
                    <div class="absolute inset-0 rounded-t-lg lg:rounded-t-none lg:rounded-r-lg shadow-[inset_0px_0px_0px_1px_rgba(26,26,0,0.16)] dark:shadow-[inset_0px_0px_0px_1px_#fffaed2d]"></div>
                </div>
            </main>
        </div>

        @if (Route::has('login'))
            <div class="h-14.5 hidden lg:block"></div>
        @endif
    </body>
</html>


------------------------------------------------------------
FILE: routes/api.php
------------------------------------------------------------
<?php

// API Routes
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Route;
//Controller Imports
use App\Http\Controllers\AuthController;
use App\Http\Controllers\UserManagement;
use App\Http\Controllers\ApiAuthController;
use App\Http\Controllers\ProjectController;
use App\Http\Controllers\Admin\MasterProductsController;
use App\Http\Controllers\SupplierController;
use App\Http\Controllers\OrderController;
use App\Http\Controllers\SupplierOrderController;
use App\Http\Controllers\Admin\OrderAdminController;
use App\Http\Controllers\Admin\DashboardController;
use App\Http\Controllers\PaymentController;
//Middleware Imports
use App\Http\Middleware\IsAdmin;
use App\Http\Middleware\IsSupplier;
use App\Http\Middleware\IsClient;



// Auth Routes - No middleware on login routes
Route::post('register/client', [ApiAuthController::class, 'registerClient']);
Route::post('register/supplier', [ApiAuthController::class, 'registerSupplier']);
Route::post('login', [ApiAuthController::class, 'login']);
Route::get('xero/callback', [ApiAuthController::class, 'xeroCallback']);


//General Authenticated Routes
Route::middleware('auth:sanctum')->group(function () {
    Route::post('logout', [ApiAuthController::class, 'logout']);
    Route::get('user', [ApiAuthController::class, 'checkAuth']);

    // profile + password
    Route::post('profile', [ApiAuthController::class, 'updateProfile']);
    Route::post('change-password', [ApiAuthController::class, 'changePassword']);
    Route::get('categories', [UserManagement::class, 'listCategories']);
});


// Admin Routes - Only apply `isAdmin` middleware to these routes
Route::middleware(['auth:sanctum', IsAdmin::class])->group(function () {

    //Dashboard Api
    Route::get('/admin/dashboard/summary', [DashboardController::class, 'summary']);

    // User Management CRUD Operations
    Route::get('users', [UserManagement::class, 'index']);
    Route::post('users', [UserManagement::class, 'store']);
    Route::get('users/{id}', [UserManagement::class, 'show']);
    Route::post('users/{id}', [UserManagement::class, 'update']);
    Route::get('user-delete-restore/{id}', [UserManagement::class, 'destroy']);
    
    // Company Check
    Route::post('check-company', [UserManagement::class, 'checkCompany']);
    Route::get('companies', [UserManagement::class, 'getCompanies']);

    //MasterProduct CRUD Operations
    Route::get('master-products', [MasterProductsController::class, 'index']);
    Route::get('master-products/{id}', [MasterProductsController::class, 'show']);
    Route::post('master-products', [MasterProductsController::class, 'store']);
    Route::post('master-products/{id}', [MasterProductsController::class, 'update']);
    Route::delete('master-products/{id}', [MasterProductsController::class, 'destroy']);
    Route::get('approve-reject-master-product/{id}', [MasterProductsController::class, 'approveRejectMasterProduct']);
    Route::post('approve-reject-supplier-offer/{id}', [MasterProductsController::class, 'approveRejectSupplierOffer']);

    //category routes
    // Route::get('categories', [UserManagement::class, 'listCategories']);
    Route::post('categories', [UserManagement::class, 'addCategory']);
    Route::post('categories/{id}', [UserManagement::class, 'updateCategory']);
    Route::delete('categories/{id}', [UserManagement::class, 'deleteCategory']);
    Route::get('categories/{id}', [UserManagement::class, 'getCategory']);

    //SupplierWithZones
    Route::get('suppliers-with-zones', [UserManagement::class, 'getSuppliersWithDeliveryZones']);


    //order routes
    Route::get('admin/orders', [OrderAdminController::class, 'index']);
    Route::get('admin/orders/{order}', [OrderAdminController::class, 'show']);
    Route::post('admin/orders/{order}/items/{item}/quoted-price', [OrderAdminController::class, 'setItemQuotedPrice']);
    Route::post('admin/orders/{order}/admin-update', [OrderAdminController::class, 'adminUpdate']);
    Route::post('admin/orders/assign-supplier', [OrderAdminController::class, 'assignSupplier']);
    Route::post('admin/update-item-pricing/{orderItem}', [OrderAdminController::class, 'updateOrderPricingAdmin']);
    Route::post('admin/orders/{order}/items/{orderItem}/mark-paid', [OrderAdminController::class, 'supplierPaidStatus']);
    Route::post('admin/orders/update-order-status/{order}', [OrderAdminController::class, 'updateOrderStatus']);

});

//Supplier Routes - Only apply `isSupplier` middleware to these routes
Route::middleware(['auth:sanctum', IsSupplier::class])->group(function () {
    // Supplier Product Management
    Route::post('supplier-offers', [SupplierController::class, 'addProductToInventory']);
    Route::post('request-master-product', [SupplierController::class, 'requestNewProduct']);
    Route::get('supplier-products', [SupplierController::class, 'getSupplierProducts']);
    Route::post('update-pricing/{offerId}', [SupplierController::class, 'updateProductPricing']);
    Route::get('master-product-inventory', [SupplierController::class, 'getMasterProductInventory']);
    Route::delete('supplier-offers/{offerId}', [SupplierController::class, 'deleteProductFromInventory']);
    Route::get('supplier-offer-status', [SupplierController::class, 'getSupplierOfferStatus']);

    //Delivery Zones
    Route::post('delivery-zones', [SupplierController::class, 'deliveryZonesManagement']);
    Route::get('delivery-zones', [SupplierController::class, 'getDeliveryZones']);

    //Supplier Order Management
    Route::get('supplier-orders', [SupplierOrderController::class, 'getSupplierOrders']);
    Route::post('supplier-orders/update-pricing/{orderItem}', [SupplierOrderController::class, 'updateOrderPricing']);
    Route::get('supplier-orders/{order}', [SupplierOrderController::class, 'viewOrderDetails']);
});


//Client Routes - Only apply `isClient` middleware to these routes
Route::middleware(['auth:sanctum', IsClient::class])->group(function () {

    //payment routes
    Route::post('/payment-intent/{orderId}', [PaymentController::class, 'createPaymentIntent']);
    Route::post('/payment-intent/{orderId}', [PaymentController::class, 'createPaymentIntent']);
    Route::post('/process-payment', [PaymentController::class, 'processPayment']);

    // Project Management CRUD Operations
    Route::get('projects', [ProjectController::class, 'index']);
    Route::get('projects/{id}', [ProjectController::class, 'show']);
    Route::get('project-details/{id}', [ProjectController::class, 'projectDetails']);
    Route::post('projects', [ProjectController::class, 'store']);
    Route::post('projects/{project}', [ProjectController::class, 'update']);
    Route::delete('projects/{id}', [ProjectController::class, 'destroy']);


    // Order Management
    Route::post('orders', [OrderController::class, 'createOrder']);
    Route::get('my-orders', [OrderController::class, 'getMyOrders']);
    Route::get('orders/{order}', [OrderController::class, 'viewMyOrder']);
    Route::get('/mark-repeat-order/{order}', [OrderController::class, 'markRepeatOrder']);
    Route::post('reorder-from-project', [OrderController::class, 'reorderFromProject']);

    //Product listing and searching
    Route::get('client/products', [OrderController::class, 'getClientProducts']);
    Route::get('client/products/{id}', [OrderController::class, 'getClientProductDetails']);
});



Route::post('/register-admin', [AuthController::class, 'registerAdmin']);



// Route::middleware('auth:sanctum')->post('/payments/intents', [PaymentController::class,'createIntent']);
// Route::get('/payments/return', [PaymentController::class,'handleReturn']);

------------------------------------------------------------
FILE: routes/console.php
------------------------------------------------------------
<?php

use Illuminate\Foundation\Inspiring;
use Illuminate\Support\Facades\Artisan;

Artisan::command('inspire', function () {
    $this->comment(Inspiring::quote());
})->purpose('Display an inspiring quote');


------------------------------------------------------------
FILE: routes/web.php
------------------------------------------------------------
<?php
// routes/web.php

use App\Http\Controllers\AuthController;
use App\Http\Controllers\AdminController;
use Illuminate\Support\Facades\Route;
use App\Http\Controllers\Admin\MasterProductsController;
use Illuminate\Http\Request;

Route::get('/', function () {
    return view('welcome');
});

// Public routes - NO middleware
Route::middleware('guest')->group(function () {
    Route::get('/login', fn() => view('login'))->name('login');
    Route::get('/register', fn() => view('register'))->name('register');
    Route::post('/login-submit', [AuthController::class, 'login'])->name('login.submit');
    Route::post('/register-submit', [AuthController::class, 'register'])->name('register.submit');
});

// Protected routes - auth middleware only
Route::middleware('auth')->group(function () {
    Route::get('/dashboard', [AuthController::class, 'dashboard'])->name('dashboard');
    Route::get('/clients', [AdminController::class, 'clients'])->name('clients');
    Route::get('/clients/create', fn() => view('clients.create'))->name('client.create');
    Route::post('/client-add', [AdminController::class, 'addClient'])->name('client.add');
});

// Logout - no middleware
Route::get('/logout', [AuthController::class, 'logout'])->name('logout');

Route::get('/import-products', [MasterProductsController::class, 'importMasterProducts']);
Route::get('/import-offers', [MasterProductsController::class, 'importOffers']);
Route::get('/import-users', [MasterProductsController::class, 'importUsers']);
Route::get('/geocode-suppliers', [MasterProductsController::class, 'updateDeliveryZonesFromCSV']);
Route::get('/import-offers-with-products', [MasterProductsController::class, 'importOffersWithProducts']);

------------------------------------------------------------
FILE: tests/Feature/ExampleTest.php
------------------------------------------------------------
<?php

test('the application returns a successful response', function () {
    $response = $this->get('/');

    $response->assertStatus(200);
});


------------------------------------------------------------
FILE: tests/Pest.php
------------------------------------------------------------
<?php

/*
|--------------------------------------------------------------------------
| Test Case
|--------------------------------------------------------------------------
|
| The closure you provide to your test functions is always bound to a specific PHPUnit test
| case class. By default, that class is "PHPUnit\Framework\TestCase". Of course, you may
| need to change it using the "pest()" function to bind a different classes or traits.
|
*/

pest()->extend(Tests\TestCase::class)
 // ->use(Illuminate\Foundation\Testing\RefreshDatabase::class)
    ->in('Feature');

/*
|--------------------------------------------------------------------------
| Expectations
|--------------------------------------------------------------------------
|
| When you're writing tests, you often need to check that values meet certain conditions. The
| "expect()" function gives you access to a set of "expectations" methods that you can use
| to assert different things. Of course, you may extend the Expectation API at any time.
|
*/

expect()->extend('toBeOne', function () {
    return $this->toBe(1);
});

/*
|--------------------------------------------------------------------------
| Functions
|--------------------------------------------------------------------------
|
| While Pest is very powerful out-of-the-box, you may have some testing code specific to your
| project that you don't want to repeat in every file. Here you can also expose helpers as
| global functions to help you to reduce the number of lines of code in your test files.
|
*/

function something()
{
    // ..
}


------------------------------------------------------------
FILE: tests/TestCase.php
------------------------------------------------------------
<?php

namespace Tests;

use Illuminate\Foundation\Testing\TestCase as BaseTestCase;

abstract class TestCase extends BaseTestCase
{
    //
}


------------------------------------------------------------
FILE: tests/Unit/ExampleTest.php
------------------------------------------------------------
<?php

test('that true is true', function () {
    expect(true)->toBeTrue();
});


------------------------------------------------------------
FILE: vite.config.js
------------------------------------------------------------
import { defineConfig } from 'vite';
import laravel from 'laravel-vite-plugin';
import tailwindcss from '@tailwindcss/vite';

export default defineConfig({
    plugins: [
        laravel({
            input: ['resources/css/app.css', 'resources/js/app.js'],
            refresh: true,
        }),
        tailwindcss(),
    ],
});

